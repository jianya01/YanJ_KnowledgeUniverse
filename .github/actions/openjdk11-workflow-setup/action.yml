name: 'OpenJDK 11 Workflow Setup'
description: 'Setup for an OpenJDK 11 and Maven Workflow'
author: Brenton Pahl

# -----------------------------------------------------------------------------
#  Standard Java Workflow Setup:
#  1. Check out repository
#  2. Setup Maven
#  3. Setup Java (with ~/.m2 maven folder caching)
# -----------------------------------------------------------------------------

runs:
  using: "composite"
  steps:
    # Step 1.) Check out repository
    - name: Checkout Repository - Main
      # If we are not running inside a pull request, pull the main branch with a depth of 1
      if: ${{ github.event_name != 'pull_request' }}
      uses: actions/checkout@v3
      with:
        ref: main
        fetch-depth: 1
    - name: Checkout Reposiry - Pull Request
      # If we are running inside a pull request workflow, grab the pull request and set the proper head reference so that any commit+push actions go back to the pull request
      if: ${{ github.event_name == 'pull_request' }}
      uses: actions/checkout@v3
      with:
        repository: ${{ github.event.pull_request.head.repo.full_name }}
        ref: ${{ github.event.pull_request.head.ref }}
        lfs: 'false' # Before setting to true we need to figure out how to get git-lfs working on the runners
    # Step 2.) Setup Maven
    - name: Setup Maven
      uses: stCarolas/setup-maven@v4.3
      with:
        maven-version: 3.8.2
    #Step 3.) Setup Java
    - name: Setup OpenJDK 11
      uses: actions/setup-java@v3.5.0
      with:
        distribution: 'microsoft'
        java-version: '11'
        cache: 'maven'

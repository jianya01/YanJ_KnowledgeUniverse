// KEL Compiler Options and Configurations
#OPTION(persist, 2) //Change 0 to 2 for persisting. 0 is only for debugging
#OPTION(persistexpire, 30)
#OPTION(codegen, 'nosmartjoins') // Hidden option that disables SMART joins in favor of more traditional HASH joins
 
// Defining the ERA to allow for ASOF functionality
ERA reportedby BEFORE(DateFirstSeen=NULL(MIN));
ERA reportedbetween BETWEEN(DateFirstSeen=NULL(MIN), DateLastSeen=NULL(MAX));

// Defining the Permissions for USE
PERMITS FCRA, NonFCRA;

ClaimsProperty := ENTITY(FLAT(UID=RecordIdentifier,
		STRING ReportRequestIdRecordCode,
		INTEGER Quoteback,
		INTEGER ReportCode,
		STRING ReportType,
		INTEGER AccountNumber,
		STRING AccountSuffix,
		STRING SpecialBillID,
		DATE DateOfOrder,
		DATE DateOfReceipt,
		DATE DateOfCompletion,
		INTEGER ProcessingCompletionStatus,
		STRING ReportUsage,
		INTEGER ReferenceNumber,
		INTEGER TimeOfReport,
		INTEGER Attach1ProcessStatus,
		INTEGER RecordVersion,
		STRING ReportIdSupplementARecordCode,
		STRING AccountName,
		INTEGER SpecialField1,
		INTEGER SpecialField2),
	MODEL(UID,
		ReportRequestIdRecordCode, Quoteback, ReportCode, ReportType, AccountNumber, AccountSuffix, SpecialBillID, DateOfOrder, DateOfReceipt, 
		DateOfCompletion, ProcessingCompletionStatus, ReportUsage, ReferenceNumber, TimeOfReport, Attach1ProcessStatus, RecordVersion,
		ReportIdSupplementA{ReportIdSupplementARecordCode, AccountName, SpecialField1, SpecialField2}));

ClaimsPropertySearchInformation := ENTITY(FLAT(ClaimsProperty rClaimsProperty=RecordIdentifier,
		INTEGER UnitNumber,
		STRING RecordCode,
		STRING Classification,
		STRING GroupUsage,
		STRING HouseNumber,
		STRING StreetName,
		STRING AptNumber,
		STRING City,
		STRING State,
		INTEGER Zip,
		INTEGER Zip4,
		INTEGER SubjectIdRecordCounter,
		INTEGER SubjectIdUnitNumber,
		INTEGER SubjectIdGroupSequenceNumber,
		STRING SubjectIdRecordCode,
		STRING SubjectIdClassification,
		STRING Last,
		STRING First,
		STRING Middle,
		STRING Suffix,
		DATE DateOfBirth,
		STRING Sex,
		INTEGER Ssn),
	MODEL(rClaimsProperty, 
		RiskAddress{UnitNumber, RecordCode, Classification, GroupUsage, HouseNumber, StreetName, AptNumber, City, State, Zip, Zip4},
		SubjectIdSet{SubjectIdRecordCounter, SubjectIdUnitNumber, SubjectIdGroupSequenceNumber, SubjectIdRecordCode, SubjectIdClassification, 
			Last, First, Middle, Suffix, DateOfBirth, Sex, Ssn}));

ClaimsPropertyClaim := ENTITY(FLAT(UID(RecordIdentifier, ClaimIdRecordCounter, SectionIdentifier),
		ClaimsProperty rClaimsProperty=RecordIdentifier,
		STRING SectionIdentifier=NULL(''),
		INTEGER ClaimInfoUnitNumber=NULL(0),
		INTEGER ClaimInfoGroupSequenceNumber=NULL(0),
		STRING ClaimInfoRecordCode=NULL(''),
		DATE ClaimDate,
		INTEGER ClaimAgeYears=NULL(0),
		INTEGER ClaimAgeMonths=NULL(0),
		STRING ClaimType=NULL(''),
		STRING ClaimDisposition=NULL(''),
		STRING ContributorClaimNumber=NULL(''),
		INTEGER ClaimFileNumber=NULL(0),
		STRING ScopeOfClaim=NULL(''),
		STRING AtFaultIndicator=NULL(''),
		STRING LocationOfLoss=NULL(''),
		INTEGER ContributorAMBestNumber=NULL(0),
		STRING PrcClaimMatchIndicator=NULL(''),
		INTEGER PolicyUnitNumber=NULL(0),
		INTEGER PolicyGroupSequenceNumber=NULL(0),
		STRING PolicyRecordCode=NULL(''),
		STRING PolicyClassification=NULL(''),
		STRING GroupUsage=NULL(''),
		STRING Type=NULL(''),
		STRING PolicyNumber=NULL(''),
		STRING IssuerName=NULL(''),
		STRING FsiType=NULL(''),
		STRING PolicyFsiNumber=NULL(''),
		STRING FsiIssuerName=NULL(''),
		INTEGER RiskPersonUnitNumber=NULL(0),
		INTEGER RiskPersonGroupSequenceNumber=NULL(0),
		STRING RiskPersonRecordCode=NULL(''),
		STRING RiskPersonClassification=NULL(''),
		STRING RiskPersonLast=NULL(''),
		STRING RiskPersonFirst=NULL(''),
		STRING RiskPersonMiddle=NULL(''),
		STRING RiskPersonSuffix=NULL(''),
		INTEGER RiskPersonDateOfBirth=NULL(0),
		STRING RiskPersonSex=NULL(''),
		STRING RiskPersonSSN=NULL(''),
		STRING RiskPersonRelationship=NULL(''),
		STRING RiskPersonRelationshipDesc=NULL(''),
		STRING RiskPersonIndividualAddressAssociationInd=NULL(''),
		STRING RiskPersonFsiLast=NULL(''),
		STRING RiskPersonFsiFirst=NULL(''),
		STRING RiskPersonFsiMiddle=NULL(''),
		STRING RiskPersonFsiSuffix=NULL(''),
		STRING RiskPersonFsiDateOfBirth=NULL(''),
		STRING RiskPersonFsiSex=NULL(''),
		STRING RiskPersonFsiSSN=NULL(''),
		INTEGER ClaimantUnitNumber=NULL(0),
		INTEGER ClaimantGroupSequenceNumber=NULL(0),
		STRING ClaimantRecordCode=NULL(''),
		STRING ClaimantClassification=NULL(''),
		STRING ClaimantLast=NULL(''),
		STRING ClaimantFirst=NULL(''),
		STRING ClaimantMiddle=NULL(''),
		STRING ClaimantSuffix=NULL(''),
		INTEGER ClaimantDateOfBirth=NULL(0),
		STRING ClaimantSex=NULL(''),
		STRING ClaimantSSN=NULL(''),
		STRING ClaimantRelationship=NULL(''),
		STRING ClaimantRelationshipDesc=NULL(''),
		STRING ClaimantIndividualAddressAssociationInd=NULL(''),
		STRING ClaimantFsiLast=NULL(''),
		STRING ClaimantFsiFirst=NULL(''),
		STRING ClaimantFsiMiddle=NULL(''),
		STRING ClaimantFsiSuffix=NULL(''),
		STRING ClaimantFsiDateOfBirth=NULL(''),
		STRING ClaimantFsiSex=NULL(''),
		STRING ClaimantFsiSSN=NULL(''),
		INTEGER AdditionalName1UnitNumber=NULL(0),
		INTEGER AdditionalName1GroupSequenceNumber=NULL(0),
		STRING AdditionalName1RecordCode=NULL(''),
		STRING AdditionalName1Classification=NULL(''),
		STRING AdditionalName1Last=NULL(''),
		STRING AdditionalName1First=NULL(''),
		STRING AdditionalName1Middle=NULL(''),
		STRING AdditionalName1Suffix=NULL(''),
		STRING AdditionalName1Relationship=NULL(''),
		STRING AdditionalName1RelationshipDesc,
		STRING AdditionalName1IndividualAddressAssociationInd=NULL(''),
		STRING AdditionalName1FsiLast=NULL(''),
		STRING AdditionalName1FsiFirst=NULL(''),
		STRING AdditionalName1FsiMiddle=NULL(''),
		STRING AdditionalName1FsiSuffix=NULL(''),
		INTEGER AdditionalName2UnitNumber=NULL(0),
		INTEGER AdditionalName2GroupSequenceNumber=NULL(0),
		STRING AdditionalName2RecordCode=NULL(''),
		STRING AdditionalName2Classification=NULL(''),
		STRING AdditionalName2Last=NULL(''),
		STRING AdditionalName2First=NULL(''),
		STRING AdditionalName2Middle=NULL(''),
		STRING AdditionalName2Suffix=NULL(''),
		STRING AdditionalName2Relationship=NULL(''),
		STRING AdditionalName2RelationshipDesc,
		STRING AdditionalName2IndividualAddressAssociationInd=NULL(''),
		STRING AdditionalName2FsiLast=NULL(''),
		STRING AdditionalName2FsiFirst=NULL(''),
		STRING AdditionalName2FsiMiddle=NULL(''),
		STRING AdditionalName2FsiSuffix=NULL(''),
		INTEGER AdditionalName3UnitNumber=NULL(0),
		INTEGER AdditionalName3GroupSequenceNumber=NULL(0),
		STRING AdditionalName3RecordCode=NULL(''),
		STRING AdditionalName3Classification=NULL(''),
		STRING AdditionalName3Last=NULL(''),
		STRING AdditionalName3First=NULL(''),
		STRING AdditionalName3Middle=NULL(''),
		STRING AdditionalName3Relationship=NULL(''),
		STRING AdditionalName3RelationshipDesc,
		STRING AdditionalName3IndividualAddressAssociationInd=NULL(''),
		STRING AdditionalName3FsiLast=NULL(''),
		STRING AdditionalName3FsiFirst=NULL(''),
		STRING AdditionalName3FsiMiddle=NULL(''),
		STRING AdditionalName3FsiSuffix=NULL(''),
		INTEGER AddressUnitNumber=NULL(0),
		INTEGER AddressGroupSequenceNumber=NULL(0),
		STRING AddressRecordCode=NULL(''),
		STRING AddressClassification=NULL(''),
		STRING AddressGroupUsage=NULL(''),
		STRING HouseNumber=NULL(''),
		STRING StreetName=NULL(''),
		STRING AptNumber=NULL(''),
		STRING City=NULL(''),
		STRING State=NULL(''),
		INTEGER ZIP=NULL(0),
		INTEGER ZIP4=NULL(0),
		STRING FsiHouseNumber=NULL(''),
		STRING FsiStreetName=NULL(''),
		STRING FsiAptNumber=NULL(''),
		STRING FsiCity=NULL(''),
		STRING FsiState=NULL(''),
		STRING FsiZIP=NULL(''),
		STRING FsiZIP4=NULL(''),
		INTEGER TelephoneUnitNumber=NULL(0),
		INTEGER TelephoneGroupSequenceNumber=NULL(0),
		STRING TelephoneRecordCode=NULL(''),
		STRING TelephoneClassification=NULL(''),
		STRING TelephoneGroupUsage=NULL(''),
		INTEGER AreaCode=NULL(0),
		STRING Exchange=NULL(''),
		STRING TelephoneNumber=NULL(''),
		STRING FsiAreaCode=NULL(''),
		STRING FsiExchange=NULL(''),
		STRING FsiNumber=NULL(''),
		INTEGER MortgageUnitNumber=NULL(0),
		INTEGER MortgageGroupSequenceNumber=NULL(0),
		STRING MortgageRecordCode=NULL(''),
		STRING LoanNumber=NULL(''),
		STRING CompanyName=NULL(''),
		STRING FsiLoanNumber=NULL(''),
		STRING FsiCompanyName=NULL(''),
		INTEGER ClaimLossRecordOccurance,
		STRING ClaimCatType=NULL(''),
		INTEGER ClaimCatAmount=NULL(0),
		STRING ClaimCatDisp=NULL('')),
	MODEL(UID,
		rClaimsProperty, SectionIdentifier,
		ClaimInfoUnitNumber, ClaimInfoGroupSequenceNumber, ClaimInfoRecordCode, ClaimDate, ClaimAgeYears, ClaimAgeMonths, ClaimType, ClaimDisposition, 
		ContributorClaimNumber, ClaimFileNumber, ScopeOfClaim, AtFaultIndicator, LocationOfLoss, ContributorAMBestNumber, PolicyUnitNumber, PolicyGroupSequenceNumber, 
		PolicyRecordCode, PolicyClassification, GroupUsage, Type, PolicyNumber, IssuerName, FsiType, PolicyFsiNumber, FsiIssuerName, RiskPersonUnitNumber, 
		RiskPersonGroupSequenceNumber, RiskPersonRecordCode, RiskPersonClassification, RiskPersonLast, RiskPersonFirst, RiskPersonMiddle, RiskPersonSuffix, 
		RiskPersonDateOfBirth, RiskPersonSex, RiskPersonSSN, RiskPersonRelationship, RiskPersonRelationshipDesc, RiskPersonIndividualAddressAssociationInd, 
		RiskPersonFsiLast, RiskPersonFsiFirst, RiskPersonFsiMiddle, RiskPersonFsiSuffix, RiskPersonFsiDateOfBirth, RiskPersonFsiSex, RiskPersonFsiSSN, 
		ClaimantUnitNumber, ClaimantGroupSequenceNumber, ClaimantRecordCode, ClaimantClassification, ClaimantLast, ClaimantFirst, ClaimantMiddle, ClaimantSuffix, 
		ClaimantRelationship, ClaimantRelationshipDesc, ClaimantFsiLast, ClaimantFsiFirst, ClaimantFsiMiddle, ClaimantFsiSuffix, PrcClaimMatchIndicator, ClaimantDateOfBirth,
		ClaimantSex, ClaimantSSN, ClaimantIndividualAddressAssociationInd, ClaimantFsiDateOfBirth, ClaimantFsiSex, ClaimantFsiSSN,
		AdditionalName1UnitNumber, AdditionalName1GroupSequenceNumber, AdditionalName1RecordCode, AdditionalName1Classification, AdditionalName1Last, AdditionalName1First, 
		AdditionalName1Middle, AdditionalName1Suffix, AdditionalName1Relationship, AdditionalName1RelationshipDesc, AdditionalName1IndividualAddressAssociationInd, AdditionalName1FsiLast, 
		AdditionalName1FsiFirst, AdditionalName1FsiMiddle, AdditionalName1FsiSuffix, AdditionalName2UnitNumber, AdditionalName2GroupSequenceNumber, AdditionalName2RecordCode, AdditionalName2Classification, AdditionalName2Last, AdditionalName2First, 
		AdditionalName2Middle, AdditionalName2Suffix, AdditionalName2Relationship, AdditionalName2RelationshipDesc, AdditionalName2IndividualAddressAssociationInd, AdditionalName2FsiLast, 
		AdditionalName2FsiFirst, AdditionalName2FsiMiddle, AdditionalName2FsiSuffix, AdditionalName3UnitNumber, AdditionalName3GroupSequenceNumber, AdditionalName3RecordCode, AdditionalName3Classification, AdditionalName3Last, AdditionalName3First, 
		AdditionalName3Middle, AdditionalName3Relationship, AdditionalName3RelationshipDesc, AdditionalName3IndividualAddressAssociationInd, AdditionalName3FsiLast, AdditionalName3FsiFirst, 
		AdditionalName3FsiMiddle, AdditionalName3FsiSuffix, AddressUnitNumber, AddressGroupSequenceNumber, AddressRecordCode, AddressClassification, AddressGroupUsage, 
		HouseNumber, StreetName, AptNumber, City, State, ZIP, ZIP4, FsiHouseNumber, FsiStreetName, FsiAptNumber, FsiCity, FsiState, FsiZIP, FsiZIP4, TelephoneUnitNumber, TelephoneGroupSequenceNumber, TelephoneRecordCode, 
		TelephoneClassification, TelephoneGroupUsage, AreaCode, Exchange, TelephoneNumber, FsiAreaCode, FsiExchange, FsiNumber, MortgageUnitNumber, 
		MortgageGroupSequenceNumber, MortgageRecordCode, LoanNumber, CompanyName, FsiLoanNumber, FsiCompanyName, 
		Payments{ClaimLossRecordOccurance, ClaimCatType, ClaimCatAmount, ClaimCatDisp}));
		
// Maps the CLUE Property Data
USE KELBlackBox.FileCLUECleaned.FileCLUEPropertyCleaned(FLAT,
	ClaimsProperty(
		DateFirstSeen = reportidsection.reportrequestid.dateoforder, // Contains information for ASOF
		DateLastSeen = reportidsection.reportrequestid.dateofcompletion, // Contains information for ASOF
		ReportRequestIdRecordCode = reportidsection.reportrequestid.recordcode,
		Quoteback = reportidsection.reportrequestid.quoteback,
		ReportCode = reportidsection.reportrequestid.reportcode,
		ReportType = reportidsection.reportrequestid.reporttype,
		AccountNumber = reportidsection.reportrequestid.accountnumber,
		AccountSuffix = reportidsection.reportrequestid.accountsuffix,
		SpecialBillID = reportidsection.reportrequestid.SpecialBillID,
		DateOfOrder = reportidsection.reportrequestid.dateoforder,
		DateOfReceipt = reportidsection.reportrequestid.dateofreceipt,
		DateOfCompletion = reportidsection.reportrequestid.dateofcompletion,
		ProcessingCompletionStatus = reportidsection.reportrequestid.processingcompletionstatus,
		ReportUsage = reportidsection.reportrequestid.reportusage,
		ReferenceNumber = reportidsection.reportrequestid.referencenumber,
		TimeOfReport = reportidsection.reportrequestid.timeofreport,
		Attach1ProcessStatus = reportidsection.reportrequestid.attach1processstatus,
		RecordVersion = reportidsection.reportrequestid.recordversion,
		ReportIdSupplementARecordCode = reportidsection.reportidsupplementa.recordcode,
		AccountName = reportidsection.reportidsupplementa.accountname,
		SpecialField1 = reportidsection.reportidsupplementa.specialfield1,
		SpecialField2 = reportidsection.reportidsupplementa.specialfield2),
	ClaimsPropertySearchInformation(
		UnitNumber = searchinformationsection.riskaddress.unitnumber,
		RecordCode = searchinformationsection.riskaddress.recordcode,
		Classification = searchinformationsection.riskaddress.classification,
		HouseNumber = searchinformationsection.riskaddress.housenumber,
		StreetName = searchinformationsection.riskaddress.streetname,
		AptNumber = riskaddress.aptnumber,
		City = searchinformationsection.riskaddress.city,
		State = searchinformationsection.riskaddress.state,
		Zip = searchinformationsection.riskaddress.zip,
		Zip4 = searchinformationsection.riskaddress.zip4),
	PERMITS([FCRA]));

USE KELBlackBox.FileCLUECleaned.FileCLUEPropertySubjectID(FLAT,
	ClaimsPropertySearchInformation(
		SubjectIdRecordCounter = SubjectIDRecordCounter,
		SubjectIdUnitNumber = subject.unitnumber,
		SubjectIdGroupSequenceNumber = subject.groupsequencenumber,
		SubjectIdRecordCode = subject.recordcode,
		SubjectIdClassification = subject.classification,
		Last = subject.last,
		First = subject.first,
		Middle = subject.middle,
		Suffix = subject.suffix,
		DateOfBirth = subject.dateofbirth,
		Sex = subject.sex,
		Ssn = subject.ssn),
	PERMITS([FCRA]));

USE KELBlackBox.FileCLUECleaned.FileCLUEPropertyRiskClaim(FLAT,
	ClaimsPropertyClaim(
		SectionIdentifier = SectionIdentifier,
		ClaimInfoUnitNumber = ClaimInfo.UnitNumber,
		ClaimInfoGroupSequenceNumber = ClaimInfo.GroupSequenceNumber,
		ClaimInfoRecordCode = ClaimInfo.RecordCode,
		ClaimDate = ClaimInfo.ClaimDate,
		ClaimAgeYears = ClaimInfo.ClaimAgeYears,
		ClaimAgeMonths = ClaimInfo.ClaimAgeMonths,
		ClaimType = ClaimInfo.ClaimType,
		ClaimDisposition = ClaimInfo.ClaimDisposition,
		ContributorClaimNumber = ClaimInfo.ContributorClaimNumber,
		ClaimFileNumber = ClaimInfo.ClaimFileNumber,
		ScopeOfClaim = ClaimInfo.ScopeOfClaim,
		AtFaultIndicator = ClaimInfo.AtFaultIndicator,
		LocationOfLoss = ClaimInfo.LocationOfLoss,
		ContributorAMBestNumber = ClaimInfo.ContributorAMBestNumber,
		PolicyUnitNumber = policy.UnitNumber,
		PolicyGroupSequenceNumber = policy.GroupSequenceNumber,
		PolicyRecordCode = policy.RecordCode,
		PolicyClassification = policy.classification,
		GroupUsage = policy.GroupUsage,
		Type = policy.type,
		PolicyNumber = policy.number,
		IssuerName = policy.IssuerName,
		FsiType = policy.FsiType,
		PolicyFsiNumber = policy.FsiNumber,
		FsiIssuerName = policy.fsiIssuerName,
		RiskPersonUnitNumber = RiskPerson.UnitNumber,
		RiskPersonGroupSequenceNumber = RiskPerson.GroupSequenceNumber,
		RiskPersonRecordCode = RiskPerson.RecordCode,
		RiskPersonClassification = RiskPerson.classification,
		RiskPersonLast = RiskPerson.last,
		RiskPersonFirst = RiskPerson.first,
		RiskPersonMiddle = RiskPerson.middle,
		RiskPersonSuffix = RiskPerson.suffix,
		RiskPersonDateOfBirth = RiskPerson.DateOfBirth,
		RiskPersonSex = RiskPerson.sex,
		RiskPersonSSN = RiskPerson.SSN,
		RiskPersonRelationship = RiskPerson.relationship,
		RiskPersonRelationshipDesc = RiskPerson.RelationshipDesc,
		RiskPersonIndividualAddressAssociationInd = RiskPerson.individualAddressAssociationInd,
		RiskPersonFsiLast = RiskPerson.FsiLast,
		RiskPersonFsiFirst = RiskPerson.FsiFirst,
		RiskPersonFsiMiddle = RiskPerson.FsiMiddle,
		RiskPersonFsiSuffix = RiskPerson.FsiSuffix,
		RiskPersonFsiDateOfBirth = RiskPerson.fsiDateOfBirth,
		RiskPersonFsiSex = RiskPerson.FsiSex,
		RiskPersonFsiSSN = RiskPerson.fsiSSN,
		ClaimantUnitNumber = claimant.UnitNumber,
		ClaimantGroupSequenceNumber = claimant.GroupSequenceNumber,
		ClaimantRecordCode = claimant.RecordCode,
		ClaimantClassification = claimant.classification,
		ClaimantLast = claimant.last,
		ClaimantFirst = claimant.first,
		ClaimantMiddle = claimant.middle,
		ClaimantSuffix = claimant.suffix,
		ClaimantRelationship = claimant.relationship,
		ClaimantRelationshipDesc = claimant.RelationshipDesc,
		ClaimantFsiLast = claimant.FsiLast,
		ClaimantFsiFirst = claimant.FsiFirst,
		ClaimantFsiMiddle = claimant.FsiMiddle,
		ClaimantFsiSuffix = claimant.FsiSuffix,
		AddressUnitNumber = address.UnitNumber,
		AddressGroupSequenceNumber = address.GroupSequenceNumber,
		AddressRecordCode = address.RecordCode,
		AddressClassification = address.classification,
		AddressGroupUsage = address.GroupUsage,
		HouseNumber = address.HouseNumber,
		StreetName = address.StreetName,
		AptNumber = address.AptNumber,
		City = address.City,
		State = address.State,
		ZIP = address.ZIP,
		ZIP4 = address.ZIP4,
		FsiHouseNumber = address.fsiHouseNumber,
		FsiStreetName = address.fsiStreetName,
		FsiAptNumber = address.fsiAptNumber,
		FsiCity = address.fsiCity,
		FsiState = address.fsiState,
		FsiZIP = address.fsiZIP,
		FsiZIP4 = address.fsiZIP4,
		TelephoneUnitNumber = telephone.UnitNumber,
		TelephoneGroupSequenceNumber = telephone.GroupSequenceNumber,
		TelephoneRecordCode = telephone.RecordCode,
		TelephoneClassification = telephone.classification,
		TelephoneGroupUsage = telephone.GroupUsage,
		AreaCode = telephone.AreaCode,
		Exchange = telephone.exchange,
		TelephoneNumber = telephone.number,
		FsiAreaCode = telephone.fsiAreaCode,
		FsiExchange = telephone.FsiExchange,
		FsiNumber = telephone.FsiNumber,
		MortgageUnitNumber = mortgage.UnitNumber,
		MortgageGroupSequenceNumber = mortgage.GroupSequenceNumber,
		MortgageRecordCode = mortgage.RecordCode,
		LoanNumber = mortgage.LoanNumber,
		CompanyName = mortgage.CompanyName,
		FsiLoanNumber = mortgage.fsiLoanNumber,
		FsiCompanyName = mortgage.fsiCompanyName),
	PERMITS([FCRA]));

USE KELBlackBox.FileCLUECleaned.FileCLUEPropertyRiskClaimPaymentsFlat(FLAT,
	ClaimsPropertyClaim(
		SectionIdentifier = SectionIdentifier,
		ClaimLossRecordOccurance = RecordOccurrA,
		ClaimCatType = ClaimCatType,
		ClaimCatAmount = ClaimCatAmount,
		ClaimCatDisp = ClaimCatDisp),
	PERMITS([FCRA]));

USE KELBlackBox.FileCLUECleaned.FileCLUEPropertyInsuredClaim(FLAT,
	ClaimsPropertyClaim(
		SectionIdentifier = SectionIdentifier,
		ClaimInfoUnitNumber = ClaimInfo.UnitNumber,
		ClaimInfoGroupSequenceNumber = ClaimInfo.GroupSequenceNumber,
		ClaimInfoRecordCode = ClaimInfo.RecordCode,
		ClaimDate = ClaimInfo.ClaimDate,
		ClaimAgeYears = ClaimInfo.ClaimAgeYears,
		ClaimAgeMonths = ClaimInfo.ClaimAgeMonths,
		ClaimType = ClaimInfo.ClaimType,
		ClaimDisposition = ClaimInfo.ClaimDisposition,
		ContributorClaimNumber = ClaimInfo.ContributorClaimNumber,
		ClaimFileNumber = ClaimInfo.ClaimFileNumber,
		ScopeOfClaim = ClaimInfo.ScopeOfClaim,
		AtFaultIndicator = ClaimInfo.AtFaultIndicator,
		LocationOfLoss = ClaimInfo.LocationOfLoss,
		ContributorAMBestNumber = ClaimInfo.ContributorAMBestNumber,
		PrcClaimMatchIndicator = claiminfo.prcclaimmatchindicator,
		PolicyUnitNumber = policy.UnitNumber,
		PolicyGroupSequenceNumber = policy.GroupSequenceNumber,
		PolicyRecordCode = policy.RecordCode,
		PolicyClassification = policy.classification,
		GroupUsage = policy.GroupUsage,
		Type = policy.type,
		PolicyNumber = policy.number,
		IssuerName = policy.IssuerName,
		FsiType = policy.FsiType,
		PolicyFsiNumber = policy.FsiNumber,
		FsiIssuerName = policy.fsiIssuerName,
		RiskPersonUnitNumber = RiskPerson.UnitNumber,
		RiskPersonGroupSequenceNumber = RiskPerson.GroupSequenceNumber,
		RiskPersonRecordCode = RiskPerson.RecordCode,
		RiskPersonClassification = RiskPerson.classification,
		RiskPersonLast = RiskPerson.last,
		RiskPersonFirst = RiskPerson.first,
		RiskPersonMiddle = RiskPerson.middle,
		RiskPersonSuffix = RiskPerson.suffix,
		RiskPersonDateOfBirth = RiskPerson.DateOfBirth,
		RiskPersonSex = RiskPerson.sex,
		RiskPersonSSN = RiskPerson.SSN,
		RiskPersonRelationship = RiskPerson.relationship,
		RiskPersonRelationshipDesc = RiskPerson.RelationshipDesc,
		RiskPersonIndividualAddressAssociationInd = RiskPerson.individualAddressAssociationInd,
		RiskPersonFsiLast = RiskPerson.FsiLast,
		RiskPersonFsiFirst = RiskPerson.FsiFirst,
		RiskPersonFsiMiddle = RiskPerson.FsiMiddle,
		RiskPersonFsiSuffix = RiskPerson.FsiSuffix,
		RiskPersonFsiDateOfBirth = RiskPerson.fsiDateOfBirth,
		RiskPersonFsiSex = RiskPerson.FsiSex,
		RiskPersonFsiSSN = RiskPerson.fsiSSN,
		ClaimantUnitNumber = claimant.UnitNumber,
		ClaimantGroupSequenceNumber = claimant.GroupSequenceNumber,
		ClaimantRecordCode = claimant.RecordCode,
		ClaimantClassification = claimant.classification,
		ClaimantLast = claimant.last,
		ClaimantFirst = claimant.first,
		ClaimantMiddle = claimant.middle,
		ClaimantSuffix = claimant.suffix,
		ClaimantDateOfBirth = claimant.dateofbirth,
		ClaimantSex = claimant.sex,
		ClaimantSSN = claimant.ssn,
		ClaimantRelationship = claimant.relationship,
		ClaimantRelationshipDesc = claimant.RelationshipDesc,
		ClaimantIndividualAddressAssociationInd = claimant.individualaddressassociationind,
		ClaimantFsiLast = claimant.FsiLast,
		ClaimantFsiFirst = claimant.FsiFirst,
		ClaimantFsiMiddle = claimant.FsiMiddle,
		ClaimantFsiSuffix = claimant.FsiSuffix,
		ClaimantFsiDateOfBirth = claimant.fsidateofbirth,
		ClaimantFsiSex = claimant.fsisex,
		ClaimantFsiSSN = claimant.fsissn,
		AddressUnitNumber = address.UnitNumber,
		AddressGroupSequenceNumber = address.GroupSequenceNumber,
		AddressRecordCode = address.RecordCode,
		AddressClassification = address.classification,
		AddressGroupUsage = address.GroupUsage,
		HouseNumber = address.HouseNumber,
		StreetName = address.StreetName,
		AptNumber = address.AptNumber,
		City = address.City,
		State = address.State,
		ZIP = address.ZIP,
		ZIP4 = address.ZIP4,
		FsiHouseNumber = address.fsiHouseNumber,
		FsiStreetName = address.fsiStreetName,
		FsiAptNumber = address.fsiAptNumber,
		FsiCity = address.fsiCity,
		FsiState = address.fsiState,
		FsiZIP = address.fsiZIP,
		FsiZIP4 = address.fsiZIP4,
		TelephoneUnitNumber = telephone.UnitNumber,
		TelephoneGroupSequenceNumber = telephone.GroupSequenceNumber,
		TelephoneRecordCode = telephone.RecordCode,
		TelephoneClassification = telephone.classification,
		TelephoneGroupUsage = telephone.GroupUsage,
		AreaCode = telephone.AreaCode,
		Exchange = telephone.exchange,
		TelephoneNumber = telephone.number,
		FsiAreaCode = telephone.fsiAreaCode,
		FsiExchange = telephone.FsiExchange,
		FsiNumber = telephone.FsiNumber,
		MortgageUnitNumber = mortgage.UnitNumber,
		MortgageGroupSequenceNumber = mortgage.GroupSequenceNumber,
		MortgageRecordCode = mortgage.RecordCode,
		LoanNumber = mortgage.LoanNumber,
		CompanyName = mortgage.CompanyName,
		FsiLoanNumber = mortgage.fsiLoanNumber,
		FsiCompanyName = mortgage.fsiCompanyName),
	PERMITS([FCRA]));

USE KELBlackBox.FileCLUECleaned.FileCLUEPropertyInsuredClaimPaymentsFlat(FLAT,
	ClaimsPropertyClaim(
		SectionIdentifier = SectionIdentifier,
		ClaimCatType = ClaimCatType,
		ClaimCatAmount = ClaimCatAmount,
		ClaimCatDisp = ClaimCatDisp),
	PERMITS([FCRA]));

// Maps the Claims Discovery Property data
USE KELBlackBox.FileCLDPCleaned.FileCDPropertyCleaned(FLAT,
	ClaimsProperty(
		DateFirstSeen = reportidsection.reportrequestid.dateoforder, // Contains information for ASOF
		DateLastSeen = reportidsection.reportrequestid.dateofcompletion, // Contains information for ASOF
		ReportRequestIdRecordCode = reportidsection.reportrequestid.recordcode,
		Quoteback = reportidsection.reportrequestid.quoteback,
		ReportCode = reportidsection.reportrequestid.reportcode,
		ReportType = reportidsection.reportrequestid.reporttype,
		AccountNumber = reportidsection.reportrequestid.accountnumber,
		AccountSuffix = reportidsection.reportrequestid.accountsuffix,
		SpecialBillID = reportidsection.reportrequestid.SpecialBillID,
		DateOfOrder = reportidsection.reportrequestid.dateoforder,
		DateOfReceipt = reportidsection.reportrequestid.dateofreceipt,
		DateOfCompletion = reportidsection.reportrequestid.dateofcompletion,
		ProcessingCompletionStatus = reportidsection.reportrequestid.processingcompletionstatus,
		ReportUsage = reportidsection.reportrequestid.reportusage,
		ReferenceNumber = reportidsection.reportrequestid.referencenumber,
		TimeOfReport = reportidsection.reportrequestid.timeofreport,
		Attach1ProcessStatus = reportidsection.reportrequestid.attach1processstatus,
		RecordVersion = reportidsection.reportrequestid.recordversion,
		ReportIdSupplementARecordCode = reportidsection.reportidsupplementa.recordcode,
		AccountName = reportidsection.reportidsupplementa.accountname,
		SpecialField1 = reportidsection.reportidsupplementa.specialfield1,
		SpecialField2 = reportidsection.reportidsupplementa.specialfield2),
	ClaimsPropertySearchInformation(
		UnitNumber = searchinformationsection.riskaddress.unitnumber,
		RecordCode = searchinformationsection.riskaddress.recordcode,
		Classification = searchinformationsection.riskaddress.classification,
		GroupUsage = searchinformationsection.riskaddress.groupusage,
		HouseNumber = searchinformationsection.riskaddress.housenumber,
		StreetName = searchinformationsection.riskaddress.streetname,
		AptNumber = searchinformationsection.riskaddress.aptnumber,
		City = searchinformationsection.riskaddress.city,
		State = searchinformationsection.riskaddress.state,
		Zip = searchinformationsection.riskaddress.zip,
		Zip4 = searchinformationsection.riskaddress.zip4),
	PERMITS([NonFCRA]));

USE KELBlackBox.FileCLDPCleaned.FileCDPropertySubjectID(FLAT,
	ClaimsPropertySearchInformation(
		SubjectIdRecordCounter = SubjectIDRecordCounter,
		SubjectIdUnitNumber = subject.unitnumber,
		SubjectIdGroupSequenceNumber = subject.groupsequencenumber,
		SubjectIdRecordCode = subject.recordcode,
		SubjectIdClassification = subject.classification,
		Last = subject.last,
		First = subject.first,
		Middle = subject.middle,
		Suffix = subject.suffix,
		DateOfBirth = subject.dateofbirth,
		Sex = subject.sex, 
		Ssn = subject.ssn),
	PERMITS([NonFCRA]));

USE KELBlackBox.FileCLDPCleaned.FileCDPropertyRiskClaim(FLAT,
	ClaimsPropertyClaim(
		SectionIdentifier = SectionIdentifier,
		ClaimInfoUnitNumber = ClaimInfo.UnitNumber,
		ClaimInfoGroupSequenceNumber = ClaimInfo.GroupSequenceNumber,
		ClaimInfoRecordCode = ClaimInfo.RecordCode,
		ClaimDate = ClaimInfo.ClaimDate,
		ClaimAgeYears = ClaimInfo.ClaimAgeYears,
		ClaimAgeMonths = ClaimInfo.ClaimAgeMonths,
		ClaimType = ClaimInfo.ClaimType,
		ClaimDisposition = ClaimInfo.ClaimDisposition,
		ContributorClaimNumber = ClaimInfo.ContributorClaimNumber,
		ClaimFileNumber = ClaimInfo.ClaimFileNumber,
		ScopeOfClaim = ClaimInfo.ScopeOfClaim,
		AtFaultIndicator = ClaimInfo.AtFaultIndicator,
		LocationOfLoss = ClaimInfo.LocationOfLoss,
		ContributorAMBestNumber = ClaimInfo.ContributorAMBestNumber,
		PolicyUnitNumber = policy.UnitNumber,
		PolicyGroupSequenceNumber = policy.GroupSequenceNumber,
		PolicyRecordCode = policy.RecordCode,
		PolicyClassification = policy.classification,
		GroupUsage = policy.GroupUsage,
		Type = policy.type,
		PolicyNumber = policy.number,
		IssuerName = policy.IssuerName,
		FsiType = policy.FsiType,
		PolicyFsiNumber = policy.FsiNumber,
		FsiIssuerName = policy.fsiIssuerName,
		RiskPersonUnitNumber = RiskPerson.UnitNumber,
		RiskPersonGroupSequenceNumber = RiskPerson.GroupSequenceNumber,
		RiskPersonRecordCode = RiskPerson.RecordCode,
		RiskPersonClassification = RiskPerson.classification,
		RiskPersonLast = RiskPerson.last,
		RiskPersonFirst = RiskPerson.first,
		RiskPersonMiddle = RiskPerson.middle,
		RiskPersonSuffix = RiskPerson.suffix,
		RiskPersonDateOfBirth = RiskPerson.DateOfBirth,
		RiskPersonSex = RiskPerson.sex,
		RiskPersonSSN = RiskPerson.SSN,
		RiskPersonRelationship = RiskPerson.relationship,
		RiskPersonRelationshipDesc = RiskPerson.RelationshipDesc,
		RiskPersonIndividualAddressAssociationInd = RiskPerson.individualAddressAssociationInd,
		RiskPersonFsiLast = RiskPerson.FsiLast,
		RiskPersonFsiFirst = RiskPerson.FsiFirst,
		RiskPersonFsiMiddle = RiskPerson.FsiMiddle,
		RiskPersonFsiSuffix = RiskPerson.FsiSuffix,
		RiskPersonFsiDateOfBirth = RiskPerson.fsiDateOfBirth,
		RiskPersonFsiSex = RiskPerson.FsiSex,
		RiskPersonFsiSSN = RiskPerson.fsiSSN,
		ClaimantUnitNumber = claimant.UnitNumber,
		ClaimantGroupSequenceNumber = claimant.GroupSequenceNumber,
		ClaimantRecordCode = claimant.RecordCode,
		ClaimantClassification = claimant.classification,
		ClaimantLast = claimant.last,
		ClaimantFirst = claimant.first,
		ClaimantMiddle = claimant.middle,
		ClaimantSuffix = claimant.suffix,
		ClaimantRelationship = claimant.relationship,
		ClaimantRelationshipDesc = claimant.RelationshipDesc,
		ClaimantFsiLast = claimant.FsiLast,
		ClaimantFsiFirst = claimant.FsiFirst,
		ClaimantFsiMiddle = claimant.FsiMiddle,
		ClaimantFsiSuffix = claimant.FsiSuffix,
		AdditionalName1UnitNumber = additionalname1.unitnumber,
		AdditionalName1GroupSequenceNumber = additionalname1.groupsequencenumber,
		AdditionalName1RecordCode = additionalname1.recordcode,
		AdditionalName1Classification = additionalname1.classification,
		AdditionalName1Last = additionalname1.last,
		AdditionalName1First = additionalname1.first,
		AdditionalName1Middle = additionalname1.middle,
		AdditionalName1Suffix = additionalname1.suffix,
		AdditionalName1Relationship = additionalname1.relationship,
		AdditionalName1RelationshipDesc = additionalname1.relationshipdesc,
		AdditionalName1IndividualAddressAssociationInd = additionalname1.individualaddressassociationind,
		AdditionalName1FsiLast = additionalname1.fsilast,
		AdditionalName1FsiFirst = additionalname1.fsifirst,
		AdditionalName1FsiMiddle = additionalname1.fsimiddle,
		AdditionalName1FsiSuffix = additionalname1.fsisuffix,
		AdditionalName2UnitNumber = additionalname2.unitnumber,
		AdditionalName2GroupSequenceNumber = additionalname2.groupsequencenumber,
		AdditionalName2RecordCode = additionalname2.recordcode,
		AdditionalName2Classification = additionalname2.classification,
		AdditionalName2Last = additionalname2.last,
		AdditionalName2First = additionalname2.first,
		AdditionalName2Middle = additionalname2.middle,
		AdditionalName2Suffix = additionalname2.suffix,
		AdditionalName2Relationship = additionalname2.relationship,
		AdditionalName2RelationshipDesc = additionalname2.relationshipdesc,
		AdditionalName2IndividualAddressAssociationInd = additionalname2.individualaddressassociationind,
		AdditionalName2FsiLast = additionalname2.fsilast,
		AdditionalName2FsiFirst = additionalname2.fsifirst,
		AdditionalName2FsiMiddle = additionalname2.fsimiddle,
		AdditionalName2FsiSuffix = additionalname2.fsisuffix,
		AdditionalName3UnitNumber = additionalname3.unitnumber,
		AdditionalName3GroupSequenceNumber = additionalname3.groupsequencenumber,
		AdditionalName3RecordCode = additionalname3.recordcode,
		AdditionalName3Classification = additionalname3.classification,
		AdditionalName3Last = additionalname3.last,
		AdditionalName3First = additionalname3.first,
		AdditionalName3Middle = additionalname3.middle,
		AdditionalName3Relationship = additionalname3.relationship,
		AdditionalName3RelationshipDesc = additionalname3.relationshipdesc,
		AdditionalName3IndividualAddressAssociationInd = additionalname3.individualaddressassociationind,
		AdditionalName3FsiLast = additionalname3.fsilast,
		AdditionalName3FsiFirst = additionalname3.fsifirst,
		AdditionalName3FsiMiddle = additionalname3.fsimiddle,
		AdditionalName3FsiSuffix = additionalname3.fsisuffix,
		AddressUnitNumber = address.UnitNumber,
		AddressGroupSequenceNumber = address.GroupSequenceNumber,
		AddressRecordCode = address.RecordCode,
		AddressClassification = address.classification,
		AddressGroupUsage = address.GroupUsage,
		HouseNumber = address.HouseNumber,
		StreetName = address.StreetName,
		AptNumber = address.AptNumber,
		City = address.City,
		State = address.State,
		ZIP = address.ZIP,
		ZIP4 = address.ZIP4,
		FsiHouseNumber = address.fsiHouseNumber,
		FsiStreetName = address.fsiStreetName,
		FsiAptNumber = address.fsiAptNumber,
		FsiCity = address.fsiCity,
		FsiState = address.fsiState,
		FsiZIP = address.fsiZIP,
		FsiZIP4 = address.fsiZIP4,
		TelephoneUnitNumber = telephone.UnitNumber,
		TelephoneGroupSequenceNumber = telephone.GroupSequenceNumber,
		TelephoneRecordCode = telephone.RecordCode,
		TelephoneClassification = telephone.classification,
		TelephoneGroupUsage = telephone.GroupUsage,
		AreaCode = telephone.AreaCode,
		Exchange = telephone.exchange,
		TelephoneNumber = telephone.number,
		FsiAreaCode = telephone.fsiAreaCode,
		FsiExchange = telephone.FsiExchange,
		FsiNumber = telephone.FsiNumber,
		MortgageUnitNumber = mortgage.UnitNumber,
		MortgageGroupSequenceNumber = mortgage.GroupSequenceNumber,
		MortgageRecordCode = mortgage.RecordCode,
		LoanNumber = mortgage.LoanNumber,
		CompanyName = mortgage.CompanyName,
		FsiLoanNumber = mortgage.fsiLoanNumber,
		FsiCompanyName = mortgage.fsiCompanyName),
	PERMITS([NonFCRA]));

USE KELBlackBox.FileCLDPCleaned.FileCDPropertyRiskClaimPaymentsFlat(FLAT,
	ClaimsPropertyClaim(
		SectionIdentifier = SectionIdentifier,
		ClaimLossRecordOccurance = RecordOccurrA,
		ClaimCatType = ClaimCatType,
		ClaimCatAmount = ClaimCatAmount,
		ClaimCatDisp = ClaimCatDisp),
	PERMITS([NonFCRA]));

USE KELBlackBox.FileCLDPCleaned.FileCDPropertyInsuredClaim(FLAT,
	ClaimsPropertyClaim(
		SectionIdentifier = SectionIdentifier,
		ClaimInfoUnitNumber = ClaimInfo.UnitNumber,
		ClaimInfoGroupSequenceNumber = ClaimInfo.GroupSequenceNumber,
		ClaimInfoRecordCode = ClaimInfo.RecordCode,
		ClaimDate = ClaimInfo.ClaimDate,
		ClaimAgeYears = ClaimInfo.ClaimAgeYears,
		ClaimAgeMonths = ClaimInfo.ClaimAgeMonths,
		ClaimType = ClaimInfo.ClaimType,
		ClaimDisposition = ClaimInfo.ClaimDisposition,
		ContributorClaimNumber = ClaimInfo.ContributorClaimNumber,
		ClaimFileNumber = ClaimInfo.ClaimFileNumber,
		ScopeOfClaim = ClaimInfo.ScopeOfClaim,
		AtFaultIndicator = ClaimInfo.AtFaultIndicator,
		LocationOfLoss = ClaimInfo.LocationOfLoss,
		ContributorAMBestNumber = ClaimInfo.ContributorAMBestNumber,
		PrcClaimMatchIndicator = claiminfo.prcclaimmatchindicator,
		PolicyUnitNumber = policy.UnitNumber,
		PolicyGroupSequenceNumber = policy.GroupSequenceNumber,
		PolicyRecordCode = policy.RecordCode,
		PolicyClassification = policy.classification,
		GroupUsage = policy.GroupUsage,
		Type = policy.type,
		PolicyNumber = policy.number,
		IssuerName = policy.IssuerName,
		FsiType = policy.FsiType,
		PolicyFsiNumber = policy.FsiNumber,
		FsiIssuerName = policy.fsiIssuerName,
		RiskPersonUnitNumber = RiskPerson.UnitNumber,
		RiskPersonGroupSequenceNumber = RiskPerson.GroupSequenceNumber,
		RiskPersonRecordCode = RiskPerson.RecordCode,
		RiskPersonClassification = RiskPerson.classification,
		RiskPersonLast = RiskPerson.last,
		RiskPersonFirst = RiskPerson.first,
		RiskPersonMiddle = RiskPerson.middle,
		RiskPersonSuffix = RiskPerson.suffix,
		RiskPersonDateOfBirth = RiskPerson.DateOfBirth,
		RiskPersonSex = RiskPerson.sex,
		RiskPersonSSN = RiskPerson.SSN,
		RiskPersonRelationship = RiskPerson.relationship,
		RiskPersonRelationshipDesc = RiskPerson.RelationshipDesc,
		RiskPersonIndividualAddressAssociationInd = RiskPerson.individualAddressAssociationInd,
		RiskPersonFsiLast = RiskPerson.FsiLast,
		RiskPersonFsiFirst = RiskPerson.FsiFirst,
		RiskPersonFsiMiddle = RiskPerson.FsiMiddle,
		RiskPersonFsiSuffix = RiskPerson.FsiSuffix,
		RiskPersonFsiDateOfBirth = RiskPerson.fsiDateOfBirth,
		RiskPersonFsiSex = RiskPerson.FsiSex,
		RiskPersonFsiSSN = RiskPerson.fsiSSN,
		ClaimantUnitNumber = claimant.UnitNumber,
		ClaimantGroupSequenceNumber = claimant.GroupSequenceNumber,
		ClaimantRecordCode = claimant.RecordCode,
		ClaimantClassification = claimant.classification,
		ClaimantLast = claimant.last,
		ClaimantFirst = claimant.first,
		ClaimantMiddle = claimant.middle,
		ClaimantSuffix = claimant.suffix,
		ClaimantDateOfBirth = claimant.dateofbirth,
		ClaimantSex = claimant.sex,
		ClaimantSSN = claimant.ssn,
		ClaimantRelationship = claimant.relationship,
		ClaimantRelationshipDesc = claimant.RelationshipDesc,
		ClaimantIndividualAddressAssociationInd = claimant.individualaddressassociationind,
		ClaimantFsiLast = claimant.FsiLast,
		ClaimantFsiFirst = claimant.FsiFirst,
		ClaimantFsiMiddle = claimant.FsiMiddle,
		ClaimantFsiSuffix = claimant.FsiSuffix,
		ClaimantFsiDateOfBirth = claimant.fsidateofbirth,
		ClaimantFsiSex = claimant.fsisex,
		ClaimantFsiSSN = claimant.fsissn,
		AdditionalName1UnitNumber = additionalname1.unitnumber,
		AdditionalName1GroupSequenceNumber = additionalname1.groupsequencenumber,
		AdditionalName1RecordCode = additionalname1.recordcode,
		AdditionalName1Classification = additionalname1.classification,
		AdditionalName1Last = additionalname1.last,
		AdditionalName1First = additionalname1.first,
		AdditionalName1Middle = additionalname1.middle,
		AdditionalName1Suffix = additionalname1.suffix,
		AdditionalName1Relationship = additionalname1.relationship,
		AdditionalName1RelationshipDesc = additionalname1.relationshipdesc,
		AdditionalName1IndividualAddressAssociationInd = additionalname1.individualaddressassociationind,
		AdditionalName1FsiLast = additionalname1.fsilast,
		AdditionalName1FsiFirst = additionalname1.fsifirst,
		AdditionalName1FsiMiddle = additionalname1.fsimiddle,
		AdditionalName1FsiSuffix = additionalname1.fsisuffix,
		AdditionalName2UnitNumber = additionalname2.unitnumber,
		AdditionalName2GroupSequenceNumber = additionalname2.groupsequencenumber,
		AdditionalName2RecordCode = additionalname2.recordcode,
		AdditionalName2Classification = additionalname2.classification,
		AdditionalName2Last = additionalname2.last,
		AdditionalName2First = additionalname2.first,
		AdditionalName2Middle = additionalname2.middle,
		AdditionalName2Suffix = additionalname2.suffix,
		AdditionalName2Relationship = additionalname2.relationship,
		AdditionalName2RelationshipDesc = additionalname2.relationshipdesc,
		AdditionalName2IndividualAddressAssociationInd = additionalname2.individualaddressassociationind,
		AdditionalName2FsiLast = additionalname2.fsilast,
		AdditionalName2FsiFirst = additionalname2.fsifirst,
		AdditionalName2FsiMiddle = additionalname2.fsimiddle,
		AdditionalName2FsiSuffix = additionalname2.fsisuffix,
		AdditionalName3UnitNumber = additionalname3.unitnumber,
		AdditionalName3GroupSequenceNumber = additionalname3.groupsequencenumber,
		AdditionalName3RecordCode = additionalname3.recordcode,
		AdditionalName3Classification = additionalname3.classification,
		AdditionalName3Last = additionalname3.last,
		AdditionalName3First = additionalname3.first,
		AdditionalName3Middle = additionalname3.middle,
		AdditionalName3Relationship = additionalname3.relationship,
		AdditionalName3RelationshipDesc = additionalname3.relationshipdesc,
		AdditionalName3IndividualAddressAssociationInd = additionalname3.individualaddressassociationind,
		AdditionalName3FsiLast = additionalname3.fsilast,
		AdditionalName3FsiFirst = additionalname3.fsifirst,
		AdditionalName3FsiMiddle = additionalname3.fsimiddle,
		AdditionalName3FsiSuffix = additionalname3.fsisuffix,
		AddressUnitNumber = address.UnitNumber,
		AddressGroupSequenceNumber = address.GroupSequenceNumber,
		AddressRecordCode = address.RecordCode,
		AddressClassification = address.classification,
		AddressGroupUsage = address.GroupUsage,
		HouseNumber = address.HouseNumber,
		StreetName = address.StreetName,
		AptNumber = address.AptNumber,
		City = address.City,
		State = address.State,
		ZIP = address.ZIP,
		ZIP4 = address.ZIP4,
		FsiHouseNumber = address.fsiHouseNumber,
		FsiStreetName = address.fsiStreetName,
		FsiAptNumber = address.fsiAptNumber,
		FsiCity = address.fsiCity,
		FsiState = address.fsiState,
		FsiZIP = address.fsiZIP,
		FsiZIP4 = address.fsiZIP4,
		TelephoneUnitNumber = telephone.UnitNumber,
		TelephoneGroupSequenceNumber = telephone.GroupSequenceNumber,
		TelephoneRecordCode = telephone.RecordCode,
		TelephoneClassification = telephone.classification,
		TelephoneGroupUsage = telephone.GroupUsage,
		AreaCode = telephone.AreaCode,
		Exchange = telephone.exchange,
		TelephoneNumber = telephone.number,
		FsiAreaCode = telephone.fsiAreaCode,
		FsiExchange = telephone.FsiExchange,
		FsiNumber = telephone.FsiNumber,
		MortgageUnitNumber = mortgage.UnitNumber,
		MortgageGroupSequenceNumber = mortgage.GroupSequenceNumber,
		MortgageRecordCode = mortgage.RecordCode,
		LoanNumber = mortgage.LoanNumber,
		CompanyName = mortgage.CompanyName,
		FsiLoanNumber = mortgage.fsiLoanNumber,
		FsiCompanyName = mortgage.fsiCompanyName),
	PERMITS([NonFCRA]));

USE KELBlackBox.FileCLDPCleaned.FileCDPropertyInsuredClaimPaymentsFlat(FLAT,
	ClaimsPropertyClaim(
		SectionIdentifier = SectionIdentifier,
		ClaimCatType = ClaimCatType,
		ClaimCatAmount = ClaimCatAmount,
		ClaimCatDisp = ClaimCatDisp),
	PERMITS([NonFCRA]));

		
// State Farm CONSTANT Definitions
ClaimsPropertyClaim: EXCLUSION_CODE_LIST := ['CONTA', 'FLOOD', 'QUAKE', 'WC', 'IDTHF'];
ClaimsPropertyClaim: CRAFT_CODE_LIST := ['CRAFT'];


// constants for SF711-SF720
ClaimsPropertyClaim: WEATHER_CLAIM_CODE_LIST := ['FREEZ', 'HAIL', 'LIGHT', 'WIND', 'SINK', 'WEATH'];

// constants for SF781-SF789, SF806-SF808, SF791-SF800 
ClaimsPropertyClaim: NON_WEATHER_CLAIM_CODE_LIST := ['CRAFT', 'CREDT', 'DISAP', 'DISSC', 'EXTEN', 'FIRE', 'PHYDA', 'SMOKE', 'THEFT', 'THFSC', 'VMM',  'OTHER', 'LIAB', 'MEDIC', 'SLIP', 'DAMAG', 'DOG'];

// constants for SF966-SF969
ClaimsPropertyClaim: FIRE_SMOKE_CLAIM_CODE_LIST := ['FIRE', 'SMOKE'];

// constants for SF1056-1079
ClaimsPropertyClaim: CRIME_CLAIM_CODE_LIST := ['THEFT', 'THFSC', 'CREDT', 'DISAP', 'DISSC'];
  
// constants for SF1146-SF1170
ClaimsPropertyClaim: LIABILITY_CODE_LIST := ['DOG', 'LIAB', 'SLIP', 'MEDIC', 'DAMAG']; 

// constants for SF1291-SF1313, SF1411-SF1434, SF1536-SF1549
ClaimsPropertyClaim: COLA_CODE_LIST := ['CRAFT', 'CREDT', 'DAMAG', 'DISAP', 'DISSC', 'DOG', 'EXTEN', 'FIRE', 'FREEZ', 'HAIL', 'LIAB', 'LIGHT', 'MEDIC', 'MOVE', 'MOLD', 'OTHER', 'PHYDA', 'SINK', 'SLIP', 'SMOKE', 'THEFT', 'THFSC', 'VMM', 'WATER', 'WIND', 'ACCDL', 'APPL', 'WEATH']; //LIST A

// constants for SF876-SF896, SF898, SF1351-SF1374 , SF1471-SF1494; NOT CODE LIST IS USED FOR SF966-SF1170
// ClaimsPropertyClaim: COLB_NOT_HAVE_CODE_LIST := ['EXTEN', 'FREEZ', 'HAIL', 'LIGHT', 'MOVE', 'OTHER', 'PHYDA', 'WATER', 'WIND'];
ClaimsPropertyClaim: COLB_CODE_LIST := ['CRAFT', 'CREDT', 'DAMAG', 'DISAP', 'DISSC', 'DOG', 'FIRE', 'LIAB', 'MEDIC', 'SLIP', 'SMOKE', 'THEFT', 'THFSC', 'VMM', 'ACCDL', 'APPL']; //LIST B
ClaimsPropertyClaim: COLB_TN_CODE_LIST := ['CRAFT', 'CREDT', 'DAMAG', 'DISAP', 'DISSC', 'DOG', 'FIRE', 'LIAB', 'SLIP', 'SMOKE', 'THEFT', 'THFSC', 'VMM', 'ACCDL', 'APPL']; // remove MEDIC from COLB_CODE_LIST

ClaimsPropertyClaim: COLC_CODE_LIST := ['FREEZ','HAIL','LIGHT','WIND','WATER','MOVE','OTHER','PHYDA','EXTEN','WEATH','MOLD','SINK'];
ClaimsPropertyClaim: SP_CAT_CODE_LIST := ['WATER', 'MOVE', 'MOLD'];
ClaimsPropertyClaim: SP_NONCAT_CODE_LIST := ['WATER', 'MOVE', 'MOLD', 'ACCDL','APPL'];
ClaimsPropertyClaim: IGNORE_CODE_LIST := ['LAE', 'COLL', 'FOROB', 'LIVES'];
ClaimsPropertyClaim: IGNORE_TN_CODE_LIST := ['LAE', 'COLL', 'FOROB', 'LIVES', 'MEDIC'];

ClaimsPropertyClaim: FULL_SCOPE_CODE_LIST := ['F'];
ClaimsPropertyClaim: RISK_INSRD_CODE_LIST := ['RISK', 'INSRD'];

// Adjusted the ClaimDate to fit the requirement: 
// Assume CLUE Report date is 01/18/2017, 
// If 01/18/2016 <= claim_date < 01/18/2017 then this claim falls into the past one year.

ClaimsPropertyClaim: => AdjustedClaimDate := ADJUSTCALENDAR(ClaimDate, 0, 0, 1);

ClaimsPropertyClaim.Payments: => cClaimCatType := IF( ClaimCatType:Null, '', ClaimCatType);
//EDITS holds last 2 bytes of ClaimCatAmount for cents so 54300 is really $543.00; Converted cClaimCatAmount to include dollars and cents
ClaimsPropertyClaim.Payments: => ClaimCatAmountTmp := IF( ClaimCatAmount:Null, 0, ClaimCatAmount);
ClaimsPropertyClaim.Payments: => cClaimCatAmount := IF(cClaimCatType IN ClaimsPropertyClaim.IGNORE_CODE_LIST , 0, ClaimCatAmountTmp);
ClaimsPropertyClaim.Payments: => cClaimCatAmountTN := IF(cClaimCatType IN ClaimsPropertyClaim.IGNORE_TN_CODE_LIST , 0, ClaimCatAmountTmp);
ClaimsPropertyClaim: => cAtFaultIndicator := IF(AtFaultIndicator:Null, '', AtFaultIndicator);

ClaimsPropertyClaim: => IsValidClaim := ISVALIDDATE(ClaimDate) AND ISVALIDDATE(rClaimsProperty.DateOfOrder) AND ClaimDate < rClaimsProperty.DateOfOrder AND rClaimsProperty.ProcessingCompletionStatus = 1 AND SectionIdentifier IN RISK_INSRD_CODE_LIST AND ScopeOfClaim IN FULL_SCOPE_CODE_LIST;  

//Claims in groups
//List A, B, and C Claims
ClaimsPropertyClaim: => IsCOLLAClaim := EXISTS(Payments(cClaimCatType IN COLA_CODE_LIST));
ClaimsPropertyClaim: => IsCOLLBClaim := EXISTS(Payments(cClaimCatType IN COLB_CODE_LIST));
ClaimsPropertyClaim: => IsCOLLCClaim := EXISTS(Payments(cClaimCatType IN COLC_CODE_LIST));

ClaimsPropertyClaim: => IsCOLLAClaimCat := EXISTS(Payments(cClaimCatType IN COLA_CODE_LIST)) AND cAtFaultIndicator = 'Y';
ClaimsPropertyClaim: => IsCOLLBClaimCat := EXISTS(Payments(cClaimCatType IN COLB_CODE_LIST)) AND cAtFaultIndicator = 'Y';
ClaimsPropertyClaim: => IsCOLLCClaimCat := EXISTS(Payments(cClaimCatType IN COLC_CODE_LIST)) AND cAtFaultIndicator = 'Y';

ClaimsPropertyClaim: => IsCOLLAClaimNonCat := EXISTS(Payments(cClaimCatType IN COLA_CODE_LIST)) AND cAtFaultIndicator != 'Y';
ClaimsPropertyClaim: => IsCOLLBClaimNonCat := EXISTS(Payments(cClaimCatType IN COLB_CODE_LIST)) AND cAtFaultIndicator != 'Y';
ClaimsPropertyClaim: => IsCOLLCClaimNonCat := EXISTS(Payments(cClaimCatType IN COLC_CODE_LIST)) AND cAtFaultIndicator != 'Y';

//None zero claim amount means that the sum of claim amounts of all causes of loss under one claim is larger than 0
//Sum up the claim amounts first and then create the none zero claims
ClaimsPropertyClaim: => TotalClaimAmt := SUM(Payments, cClaimCatAmount);
ClaimsPropertyClaim: => TotalClaimAmtTN := SUM(Payments, cClaimCatAmountTN);

ClaimsPropertyClaim: => IsCOLLANZClaim := EXISTS(Payments(cClaimCatType IN COLA_CODE_LIST)) AND TotalClaimAmt > 0;
ClaimsPropertyClaim: => IsCOLLBNZClaim := EXISTS(Payments(cClaimCatType IN COLB_CODE_LIST)) AND TotalClaimAmt > 0;
ClaimsPropertyClaim: => IsCOLLCNZClaim := EXISTS(Payments(cClaimCatType IN COLC_CODE_LIST)) AND TotalClaimAmt > 0;

//None zero claims for cat
ClaimsPropertyClaim: => IsCOLLANZClaimCat := IsCOLLANZClaim AND cAtFaultIndicator = 'Y';
ClaimsPropertyClaim: => IsCOLLBNZClaimCat := IsCOLLBNZClaim AND cAtFaultIndicator = 'Y';
ClaimsPropertyClaim: => IsCOLLCNZClaimCat := IsCOLLCNZClaim AND cAtFaultIndicator = 'Y';

ClaimsPropertyClaim: => IsCOLLANZClaimNonCat := IsCOLLANZClaim AND cAtFaultIndicator != 'Y';
ClaimsPropertyClaim: => IsCOLLBNZClaimNonCat := IsCOLLBNZClaim AND cAtFaultIndicator != 'Y';
ClaimsPropertyClaim: => IsCOLLCNZClaimNonCat := IsCOLLCNZClaim AND cAtFaultIndicator != 'Y';

// Special for TN
ClaimsPropertyClaim: => IsCOLLBNZClaimNonCatTN := EXISTS(Payments(cClaimCatType IN COLB_TN_CODE_LIST)) AND TotalClaimAmtTN > 0 AND (cAtFaultIndicator != 'Y');

//Add column in Payments to count the claim amount under each catagory
ClaimsPropertyClaim.Payments: => COLLAClmAmt := IF(cClaimCatType IN ClaimsPropertyClaim.COLA_CODE_LIST, cClaimCatAmount, 0);
ClaimsPropertyClaim.Payments: => COLLBClmAmt := IF(cClaimCatType IN ClaimsPropertyClaim.COLB_CODE_LIST, cClaimCatAmount, 0);
ClaimsPropertyClaim.Payments: => COLLCClmAmt := IF(cClaimCatType IN ClaimsPropertyClaim.COLC_CODE_LIST, cClaimCatAmount, 0);

//Exlusion claims
ClaimsPropertyClaim: => IsExclusionClaim := EXISTS(Payments(cClaimCatType IN EXCLUSION_CODE_LIST));

//Weather claims, cat and noncat, zero and nonzero
ClaimsPropertyClaim: => IsWeatherClaim := EXISTS(Payments(cClaimCatType IN WEATHER_CLAIM_CODE_LIST));
ClaimsPropertyClaim: => IsWeatherClaimCat := EXISTS(Payments(cClaimCatType IN WEATHER_CLAIM_CODE_LIST)) AND cAtFaultIndicator = 'Y'; 
ClaimsPropertyClaim: => IsWeatherClaimNonCat := IsWeatherClaim AND cAtFaultIndicator != 'Y'; //This format is different with the cat one, because I want to keep both ways to write the code

ClaimsPropertyClaim: => IsWeatherNZClaim := EXISTS(Payments(cClaimCatType IN WEATHER_CLAIM_CODE_LIST)) AND TotalClaimAmt > 0;
ClaimsPropertyClaim: => IsWeatherNZClaimCat := IsWeatherNZClaim AND cAtFaultIndicator = 'Y';
ClaimsPropertyClaim: => IsWeatherNZClaimNonCat := IsWeatherNZClaim AND cAtFaultIndicator != 'Y';

//Sum up the claim amount for weather cause of loss for each claim, and add the column in ClaimsPropertyClaim
// ClaimsPropertyClaim: => WeatherNZTotalClmAmt := SUM(Payments(cClaimCatType IN WEATHER_CLAIM_CODE_LIST OR cClaimCatType IN SP_CAT_CODE_LIST AND cClaimCatAmount > 0), cClaimCatAmount);
// ClaimsPropertyClaim: => WeatherNZNonCatTotalClmAmt := SUM(Payments(cClaimCatType IN WEATHER_CLAIM_CODE_LIST AND cClaimCatAmount > 0 AND cAtFaultIndicator != 'Y'), cClaimCatAmount);
// ClaimsPropertyClaim: => WeatherNZCatTotalClmAmt := SUM(Payments(cClaimCatType IN WEATHER_CLAIM_CODE_LIST OR cClaimCatType IN SP_CAT_CODE_LIST AND cClaimCatAmount > 0 AND cAtFaultIndicator = 'Y'), cClaimCatAmount);

//SP claims
ClaimsPropertyClaim: => IsSPClaimCat := EXISTS(Payments(cClaimCatType IN SP_CAT_CODE_LIST)) AND cAtFaultIndicator = 'Y';
ClaimsPropertyClaim: => IsSPClaimNonCat := EXISTS(Payments(cClaimCatType IN SP_NONCAT_CODE_LIST)) AND cAtFaultIndicator != 'Y';

ClaimsPropertyClaim: => IsSPNZClaimCat := EXISTS(Payments(cClaimCatType IN SP_CAT_CODE_LIST)) AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y';
ClaimsPropertyClaim: => IsSPNZClaimNonCat := EXISTS(Payments(cClaimCatType IN SP_NONCAT_CODE_LIST)) AND TotalClaimAmt >0 AND cAtFaultIndicator != 'Y';

//Liability claims (with a new method to write the code)
ClaimsPropertyClaim: => IsLiabilityClaim := EXISTS(Payments(cClaimCatType IN LIABILITY_CODE_LIST));
ClaimsPropertyClaim: => IsLiabilityClaimCat := IsLiabilityClaim AND (cAtFaultIndicator = 'Y');
ClaimsPropertyClaim: => IsLiabilityClaimNonCat := IsLiabilityClaim AND (cAtFaultIndicator != 'Y');

ClaimsPropertyClaim: => IsLiabilityNZClaim := IsLiabilityClaim AND TotalClaimAmt > 0;
ClaimsPropertyClaim: => IsLiabilityNZClaimCat := IsLiabilityNZClaim AND (cAtFaultIndicator = 'Y');
ClaimsPropertyClaim: => IsLiabilityNZClaimNonCat := IsLiabilityNZClaim AND (cAtFaultIndicator != 'Y');

//Nonweather claims
ClaimsPropertyClaim: => IsNonWeatherClaim := EXISTS(Payments(cClaimCatType IN NON_WEATHER_CLAIM_CODE_LIST));
ClaimsPropertyClaim: => IsNonWeatherClaimCat := IsNonWeatherClaim AND (cAtFaultIndicator = 'Y');
ClaimsPropertyClaim: => IsNonWeatherClaimNonCat := IsNonWeatherClaim AND (cAtFaultIndicator != 'Y');

ClaimsPropertyClaim: => IsNonNZWeatherClaim := IsNonWeatherClaim AND TotalClaimAmt > 0;
ClaimsPropertyClaim: => IsNonWeatherNZClaimCat := IsNonNZWeatherClaim AND (cAtFaultIndicator = 'Y');
ClaimsPropertyClaim: => IsNonWeatherNZClaimNonCat := IsNonNZWeatherClaim AND (cAtFaultIndicator != 'Y');

//Sum up the claim amount for none weather cause of loss for each claim, and add the column in ClaimsPropertyClaim
ClaimsPropertyClaim: => NonWeatherNZTotalClmAmt := SUM(Payments(cClaimCatType IN NON_WEATHER_CLAIM_CODE_LIST OR cClaimCatType IN SP_NONCAT_CODE_LIST AND cClaimCatAmount > 0), cClaimCatAmount);
ClaimsPropertyClaim: => NonWeatherNZNonCatTotalClmAmt := SUM(Payments(cClaimCatType IN NON_WEATHER_CLAIM_CODE_LIST OR cClaimCatType IN SP_NONCAT_CODE_LIST AND cClaimCatAmount > 0 AND cAtFaultIndicator != 'Y'), cClaimCatAmount);
ClaimsPropertyClaim: => NonWeatherNZCatTotalClmAmt := SUM(Payments(cClaimCatType IN WEATHER_CLAIM_CODE_LIST OR cClaimCatType IN SP_CAT_CODE_LIST AND cClaimCatAmount > 0 AND cAtFaultIndicator = 'Y'), cClaimCatAmount);

//Fire smoke claims
ClaimsPropertyClaim: => IsFireSmokeClaim := EXISTS(Payments(cClaimCatType IN FIRE_SMOKE_CLAIM_CODE_LIST));
ClaimsPropertyClaim: => IsFireSmokeClaimCat := IsFireSmokeClaim AND (cAtFaultIndicator = 'Y');
ClaimsPropertyClaim: => IsFireSmokeClaimNonCat := IsFireSmokeClaim AND (cAtFaultIndicator != 'Y');

ClaimsPropertyClaim: => IsFireSmokeNZClaim := IsFireSmokeClaim AND TotalClaimAmt > 0;
ClaimsPropertyClaim: => IsFireSmokeNZClaimCat := IsFireSmokeClaimCat AND TotalClaimAmt > 0;
ClaimsPropertyClaim: => IsFireSmokeNZClaimNonCat := IsFireSmokeClaimNonCat AND TotalClaimAmt > 0;

//Crime claims
ClaimsPropertyClaim: => IsCrimeClaim := EXISTS (Payments(cClaimCatType IN CRIME_CLAIM_CODE_LIST));
ClaimsPropertyClaim: => IsCrimeClaimCat := IsCrimeClaim AND (cAtFaultIndicator = 'Y');
ClaimsPropertyClaim: => IsCrimeClaimNonCat := IsCrimeClaim AND (cAtFaultIndicator != 'Y');

ClaimsPropertyClaim: => IsCrimeNZClaim := IsCrimeClaim AND TotalClaimAmt > 0;
ClaimsPropertyClaim: => IsCrimeNZClaimCat := IsCrimeClaimCat AND TotalClaimAmt > 0;
ClaimsPropertyClaim: => IsCrimeNZClaimNonCat := IsCrimeClaimNonCat AND TotalClaimAmt > 0;












//GROUP1: SF691 to SF780: BASED ON SAS CODE
//SF691 SF692 SF693 SF694 SF695
ClaimsProperty: => NumWeatherClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumWeatherClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumWeatherClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumWeatherClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumWeatherClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF696 SF697 SF698 SF699 SF700 
ClaimsProperty: => NumNZWeatherClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherNZClaim = TRUE OR IsSPNZClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZWeatherClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherNZClaim = TRUE OR IsSPNZClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZWeatherClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherNZClaim = TRUE OR IsSPNZClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZWeatherClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherNZClaim = TRUE OR IsSPNZClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZWeatherClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherNZClaim = TRUE OR IsSPNZClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF701 SF702 SF703 SF704 SF705 
ClaimsProperty: => NumWeatherCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaimCat = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumWeatherCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaimCat = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumWeatherCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaimCat = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumWeatherCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaimCat = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumWeatherCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaimCat = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF706 SF707 SF708 SF709 SF710
ClaimsProperty: => NumNZWeatherCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherNZClaimCat = TRUE OR IsSPNZClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZWeatherCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherNZClaimCat = TRUE OR IsSPNZClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZWeatherCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherNZClaimCat = TRUE OR IsSPNZClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZWeatherCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherNZClaimCat = TRUE OR IsSPNZClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZWeatherCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherNZClaimCat = TRUE OR IsSPNZClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF711 SF712 SF713 SF714 SF715
ClaimsProperty: => NumWeatherNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumWeatherNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumWeatherNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumWeatherNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumWeatherNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF716 SF717 SF718 SF719 SF720
ClaimsProperty: => NumNZWeatherNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim(IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZWeatherNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim(IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZWeatherNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim(IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZWeatherNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim(IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZWeatherNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim(IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//Use Count Attributes (SF691-SF720) as SF721-SF750 are only identifying whether claims with exact criteria exist or not
//SF721 SF722 SF723 SF724 SF725
ClaimsProperty: => ExistWeatherClmWithin1Yr := IF(NumWeatherClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherClmWithin2Yr := IF(NumWeatherClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherClmWithin3Yr := IF(NumWeatherClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherClmWithin4Yr := IF(NumWeatherClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherClmWithin5Yr := IF(NumWeatherClmWithin5Yr >= 1, 1, 0);

//SF726 SF727 SF728 SF729 SF730
ClaimsProperty: => ExistNZWeatherClmWithin1Yr := IF(NumNZWeatherClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherClmWithin2Yr := IF(NumNZWeatherClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherClmWithin3Yr := IF(NumNZWeatherClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherClmWithin4Yr := IF(NumNZWeatherClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherClmWithin5Yr := IF(NumNZWeatherClmWithin5Yr >= 1, 1, 0);

//SF731 SF732 SF733 SF734 SF735
ClaimsProperty: => ExistWeatherCatClmWithin1Yr := IF(NumWeatherCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherCatClmWithin2Yr := IF(NumWeatherCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherCatClmWithin3Yr := IF(NumWeatherCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherCatClmWithin4Yr := IF(NumWeatherCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherCatClmWithin5Yr := IF(NumWeatherCatClmWithin5Yr >= 1, 1, 0);

//SF736 SF737 SF738 SF739 SF740
ClaimsProperty: => ExistNZWeatherCatClmWithin1Yr := IF(NumNZWeatherCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherCatClmWithin2Yr := IF(NumNZWeatherCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherCatClmWithin3Yr := IF(NumNZWeatherCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherCatClmWithin4Yr := IF(NumNZWeatherCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherCatClmWithin5Yr := IF(NumNZWeatherCatClmWithin5Yr >= 1, 1, 0);

//SF741 SF742 SF743 SF744 SF745
ClaimsProperty: => ExistWeatherNonCatClmWithin1Yr := IF(NumWeatherNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherNonCatClmWithin2Yr := IF(NumWeatherNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherNonCatClmWithin3Yr := IF(NumWeatherNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherNonCatClmWithin4Yr := IF(NumWeatherNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistWeatherNonCatClmWithin5Yr := IF(NumWeatherNonCatClmWithin5Yr >= 1, 1, 0);

//SF746 SF747 SF748 SF749 SF750
ClaimsProperty: => ExistNZWeatherNonCatClmWithin1Yr := IF(NumNZWeatherNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherNonCatClmWithin2Yr := IF(NumNZWeatherNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherNonCatClmWithin3Yr := IF(NumNZWeatherNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherNonCatClmWithin4Yr := IF(NumNZWeatherNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZWeatherNonCatClmWithin5Yr := IF(NumNZWeatherNonCatClmWithin5Yr >= 1, 1, 0);

//SF751 SF752 SF753 SF754 SF755
ClaimsProperty: => TotalNZWeatherClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);

ClaimsProperty: => TotalNZWeatherClmAmtWithin1Yr := MIN(TotalNZWeatherClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherClmAmtWithin2Yr := MIN(TotalNZWeatherClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherClmAmtWithin3Yr := MIN(TotalNZWeatherClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherClmAmtWithin4Yr := MIN(TotalNZWeatherClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherClmAmtWithin5Yr := MIN(TotalNZWeatherClmAmtWithin5YrTemp, 9999992);

 
//SF756 SF757 SF758 SF759 SF760
ClaimsProperty: => TotalNZWeatherCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaimCat = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaimCat = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaimCat = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaimCat = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaimCat = TRUE OR IsSPClaimCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);

ClaimsProperty: => TotalNZWeatherCatClmAmtWithin1Yr := MIN(TotalNZWeatherCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherCatClmAmtWithin2Yr := MIN(TotalNZWeatherCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherCatClmAmtWithin3Yr := MIN(TotalNZWeatherCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherCatClmAmtWithin4Yr := MIN(TotalNZWeatherCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherCatClmAmtWithin5Yr := MIN(TotalNZWeatherCatClmAmtWithin5YrTemp, 9999992);

//SF761 SF762 SF763 SF764 SF765
ClaimsProperty: => TotalNZWeatherNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZWeatherNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsWeatherClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);

ClaimsProperty: => TotalNZWeatherNonCatClmAmtWithin1Yr := MIN(TotalNZWeatherNonCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherNonCatClmAmtWithin2Yr := MIN(TotalNZWeatherNonCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherNonCatClmAmtWithin3Yr := MIN(TotalNZWeatherNonCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherNonCatClmAmtWithin4Yr := MIN(TotalNZWeatherNonCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZWeatherNonCatClmAmtWithin5Yr := MIN(TotalNZWeatherNonCatClmAmtWithin5YrTemp, 9999992);

//SF766 SF767 SF768 SF769 SF770                        
ClaimsProperty: => AvgNZWeatherClmAmtWithin1Yr := IF(NumNZWeatherClmWithin1Yr > 0, MIN(ROUND(TotalNZWeatherClmAmtWithin1YrTemp/NumNZWeatherClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherClmAmtWithin2Yr := IF(NumNZWeatherClmWithin2Yr > 0, MIN(ROUND(TotalNZWeatherClmAmtWithin2YrTemp/NumNZWeatherClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherClmAmtWithin3Yr := IF(NumNZWeatherClmWithin3Yr > 0, MIN(ROUND(TotalNZWeatherClmAmtWithin3YrTemp/NumNZWeatherClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherClmAmtWithin4Yr := IF(NumNZWeatherClmWithin4Yr > 0, MIN(ROUND(TotalNZWeatherClmAmtWithin4YrTemp/NumNZWeatherClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherClmAmtWithin5Yr := IF(NumNZWeatherClmWithin5Yr > 0, MIN(ROUND(TotalNZWeatherClmAmtWithin5YrTemp/NumNZWeatherClmWithin5Yr), 9999992), 0);

//SF771 SF772 SF773 SF774 SF775
ClaimsProperty: => AvgNZWeatherCatClmAmtWithin1Yr := IF(NumNZWeatherCatClmWithin1Yr > 0, MIN(ROUND(TotalNZWeatherCatClmAmtWithin1YrTemp/NumNZWeatherCatClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherCatClmAmtWithin2Yr := IF(NumNZWeatherCatClmWithin2Yr > 0, MIN(ROUND(TotalNZWeatherCatClmAmtWithin2YrTemp/NumNZWeatherCatClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherCatClmAmtWithin3Yr := IF(NumNZWeatherCatClmWithin3Yr > 0, MIN(ROUND(TotalNZWeatherCatClmAmtWithin3YrTemp/NumNZWeatherCatClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherCatClmAmtWithin4Yr := IF(NumNZWeatherCatClmWithin4Yr > 0, MIN(ROUND(TotalNZWeatherCatClmAmtWithin4YrTemp/NumNZWeatherCatClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherCatClmAmtWithin5Yr := IF(NumNZWeatherCatClmWithin5Yr > 0, MIN(ROUND(TotalNZWeatherCatClmAmtWithin5YrTemp/NumNZWeatherCatClmWithin5Yr), 9999992), 0);

//SF776 SF777 SF778 SF779 SF780
ClaimsProperty: => AvgNZWeatherNonCatClmAmtWithin1Yr := IF(NumNZWeatherNonCatClmWithin1Yr > 0, MIN(ROUND(TotalNZWeatherNonCatClmAmtWithin1YrTemp/NumNZWeatherNonCatClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherNonCatClmAmtWithin2Yr := IF(NumNZWeatherNonCatClmWithin2Yr > 0, MIN(ROUND(TotalNZWeatherNonCatClmAmtWithin2YrTemp/NumNZWeatherNonCatClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherNonCatClmAmtWithin3Yr := IF(NumNZWeatherNonCatClmWithin3Yr > 0, MIN(ROUND(TotalNZWeatherNonCatClmAmtWithin3YrTemp/NumNZWeatherNonCatClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherNonCatClmAmtWithin4Yr := IF(NumNZWeatherNonCatClmWithin4Yr > 0, MIN(ROUND(TotalNZWeatherNonCatClmAmtWithin4YrTemp/NumNZWeatherNonCatClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZWeatherNonCatClmAmtWithin5Yr := IF(NumNZWeatherNonCatClmWithin5Yr > 0, MIN(ROUND(TotalNZWeatherNonCatClmAmtWithin5YrTemp/NumNZWeatherNonCatClmWithin5Yr), 9999992), 0);


//Group 2: SF781 to SF870
//SF781 - 785, nonweather claims and SP NonCat
ClaimsProperty: => NumNonWeatherClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaim = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNonWeatherClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaim = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNonWeatherClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaim = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNonWeatherClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaim = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNonWeatherClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaim = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF786-790, nonweather, SP NonCat, and non zero
ClaimsProperty: => NumNZNonWeatherClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonNZWeatherClaim = TRUE OR IsSPNZClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZNonWeatherClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonNZWeatherClaim = TRUE OR IsSPNZClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZNonWeatherClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonNZWeatherClaim = TRUE OR IsSPNZClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZNonWeatherClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonNZWeatherClaim = TRUE OR IsSPNZClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZNonWeatherClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonNZWeatherClaim = TRUE OR IsSPNZClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));


//SF791 - 795, non weather, cat, without SP NonCat
ClaimsProperty: => NumNonWeatherCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNonWeatherCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNonWeatherCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNonWeatherCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNonWeatherCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF796 - 800, non weather, cat, without SP NonCat, and non zero
ClaimsProperty: => NumNZNonWeatherCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZNonWeatherCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZNonWeatherCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZNonWeatherCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZNonWeatherCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF801- 805, non weather, NonCat, with SP NonCat
ClaimsProperty: => NumNonWeatherNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaimNonCat = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNonWeatherNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaimNonCat = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNonWeatherNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaimNonCat = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNonWeatherNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaimNonCat = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNonWeatherNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaimNonCat = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF806 - 810, non weather, NonCat, with SP NonCat, and non zero
ClaimsProperty: => NumNZNonWeatherNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherNZClaimNonCat = TRUE OR IsSPNZClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZNonWeatherNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherNZClaimNonCat = TRUE OR IsSPNZClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZNonWeatherNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherNZClaimNonCat = TRUE OR IsSPNZClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZNonWeatherNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherNZClaimNonCat = TRUE OR IsSPNZClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZNonWeatherNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherNZClaimNonCat = TRUE OR IsSPNZClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//Indicators and amount
//SF811 to 840 
ClaimsProperty: => ExistNonWeatherClmWithin1Yr := IF( NumNonWeatherClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherClmWithin2Yr := IF( NumNonWeatherClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherClmWithin3Yr := IF( NumNonWeatherClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherClmWithin4Yr := IF( NumNonWeatherClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherClmWithin5Yr := IF( NumNonWeatherClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherClmWithin1Yr := IF( NumNZNonWeatherClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherClmWithin2Yr := IF( NumNZNonWeatherClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherClmWithin3Yr := IF( NumNZNonWeatherClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherClmWithin4Yr := IF( NumNZNonWeatherClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherClmWithin5Yr := IF( NumNZNonWeatherClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherCatClmWithin1Yr      := IF( NumNonWeatherCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherCatClmWithin2Yr      := IF( NumNonWeatherCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherCatClmWithin3Yr      := IF( NumNonWeatherCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherCatClmWithin4Yr      := IF( NumNonWeatherCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherCatClmWithin5Yr      := IF( NumNonWeatherCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherCatClmWithin1Yr    := IF( NumNZNonWeatherCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherCatClmWithin2Yr    := IF( NumNZNonWeatherCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherCatClmWithin3Yr    := IF( NumNZNonWeatherCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherCatClmWithin4Yr    := IF( NumNZNonWeatherCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherCatClmWithin5Yr    := IF( NumNZNonWeatherCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherNonCatClmWithin1Yr   := IF( NumNonWeatherNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherNonCatClmWithin2Yr   := IF( NumNonWeatherNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherNonCatClmWithin3Yr   := IF( NumNonWeatherNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherNonCatClmWithin4Yr   := IF( NumNonWeatherNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNonWeatherNonCatClmWithin5Yr   := IF( NumNonWeatherNonCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherNonCatClmWithin1Yr := IF( NumNZNonWeatherNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherNonCatClmWithin2Yr := IF( NumNZNonWeatherNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherNonCatClmWithin3Yr := IF( NumNZNonWeatherNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherNonCatClmWithin4Yr := IF( NumNZNonWeatherNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZNonWeatherNonCatClmWithin5Yr := IF( NumNZNonWeatherNonCatClmWithin5Yr >= 1, 1, 0);


//SF841 to 845, total claim amount for each none weather report
ClaimsProperty: => TotalNZNonWeatherClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaim = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaim = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaim = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaim = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaim = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherClmAmtWithin1Yr := MIN(TotalNZNonWeatherClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherClmAmtWithin2Yr := MIN(TotalNZNonWeatherClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherClmAmtWithin3Yr := MIN(TotalNZNonWeatherClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherClmAmtWithin4Yr := MIN(TotalNZNonWeatherClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherClmAmtWithin5Yr := MIN(TotalNZNonWeatherClmAmtWithin5YrTemp, 9999992);


//SF846 to 850, total claim amount for each none weather cat report
ClaimsProperty: => TotalNZNonWeatherCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND IsNonWeatherClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherCatClmAmtWithin1Yr := MIN(TotalNZNonWeatherCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherCatClmAmtWithin2Yr := MIN(TotalNZNonWeatherCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherCatClmAmtWithin3Yr := MIN(TotalNZNonWeatherCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherCatClmAmtWithin4Yr := MIN(TotalNZNonWeatherCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherCatClmAmtWithin5Yr := MIN(TotalNZNonWeatherCatClmAmtWithin5YrTemp, 9999992);


//SF851 to 855, total claim amount for each none weather none cat report
ClaimsProperty: => TotalNZNonWeatherNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaimNonCat = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaimNonCat = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaimNonCat = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaimNonCat = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND (IsWeatherClaim = FALSE AND IsSPClaimCat = FALSE) AND (IsNonWeatherClaimNonCat = TRUE OR IsSPClaimNonCat = TRUE) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZNonWeatherNonCatClmAmtWithin1Yr := MIN(TotalNZNonWeatherNonCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherNonCatClmAmtWithin2Yr := MIN(TotalNZNonWeatherNonCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherNonCatClmAmtWithin3Yr := MIN(TotalNZNonWeatherNonCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherNonCatClmAmtWithin4Yr := MIN(TotalNZNonWeatherNonCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZNonWeatherNonCatClmAmtWithin5Yr := MIN(TotalNZNonWeatherNonCatClmAmtWithin5YrTemp, 9999992);


//SF856 to 860, average claim amount foe each none weather
ClaimsProperty: => AvgNZNonWeatherClmAmtWithin1Yr := IF(NumNZNonWeatherClmWithin1Yr > 0, MIN(ROUND(TotalNZNonWeatherClmAmtWithin1YrTemp/NumNZNonWeatherClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherClmAmtWithin2Yr := IF(NumNZNonWeatherClmWithin2Yr > 0, MIN(ROUND(TotalNZNonWeatherClmAmtWithin2YrTemp/NumNZNonWeatherClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherClmAmtWithin3Yr := IF(NumNZNonWeatherClmWithin3Yr > 0, MIN(ROUND(TotalNZNonWeatherClmAmtWithin3YrTemp/NumNZNonWeatherClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherClmAmtWithin4Yr := IF(NumNZNonWeatherClmWithin4Yr > 0, MIN(ROUND(TotalNZNonWeatherClmAmtWithin4YrTemp/NumNZNonWeatherClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherClmAmtWithin5Yr := IF(NumNZNonWeatherClmWithin5Yr > 0, MIN(ROUND(TotalNZNonWeatherClmAmtWithin5YrTemp/NumNZNonWeatherClmWithin5Yr), 9999992), 0);

//SF861 to 865, average claim amount foe each none weather and cat
ClaimsProperty: => AvgNZNonWeatherCatClmAmtWithin1Yr := IF(NumNZNonWeatherCatClmWithin1Yr > 0, MIN(ROUND(TotalNZNonWeatherCatClmAmtWithin1YrTemp/NumNZNonWeatherCatClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherCatClmAmtWithin2Yr := IF(NumNZNonWeatherCatClmWithin2Yr > 0, MIN(ROUND(TotalNZNonWeatherCatClmAmtWithin2YrTemp/NumNZNonWeatherCatClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherCatClmAmtWithin3Yr := IF(NumNZNonWeatherCatClmWithin3Yr > 0, MIN(ROUND(TotalNZNonWeatherCatClmAmtWithin3YrTemp/NumNZNonWeatherCatClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherCatClmAmtWithin4Yr := IF(NumNZNonWeatherCatClmWithin4Yr > 0, MIN(ROUND(TotalNZNonWeatherCatClmAmtWithin4YrTemp/NumNZNonWeatherCatClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherCatClmAmtWithin5Yr := IF(NumNZNonWeatherCatClmWithin5Yr > 0, MIN(ROUND(TotalNZNonWeatherCatClmAmtWithin5YrTemp/NumNZNonWeatherCatClmWithin5Yr), 9999992), 0);

//SF866 to 870, average claim amount foe each none weather and non cat
ClaimsProperty: => AvgNZNonWeatherNonCatClmAmtWithin1Yr := IF(NumNZNonWeatherNonCatClmWithin1Yr > 0, MIN(ROUND(TotalNZNonWeatherNonCatClmAmtWithin1YrTemp/NumNZNonWeatherNonCatClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherNonCatClmAmtWithin2Yr := IF(NumNZNonWeatherNonCatClmWithin2Yr > 0, MIN(ROUND(TotalNZNonWeatherNonCatClmAmtWithin2YrTemp/NumNZNonWeatherNonCatClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherNonCatClmAmtWithin3Yr := IF(NumNZNonWeatherNonCatClmWithin3Yr > 0, MIN(ROUND(TotalNZNonWeatherNonCatClmAmtWithin3YrTemp/NumNZNonWeatherNonCatClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherNonCatClmAmtWithin4Yr := IF(NumNZNonWeatherNonCatClmWithin4Yr > 0, MIN(ROUND(TotalNZNonWeatherNonCatClmAmtWithin4YrTemp/NumNZNonWeatherNonCatClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZNonWeatherNonCatClmAmtWithin5Yr := IF(NumNZNonWeatherNonCatClmWithin5Yr > 0, MIN(ROUND(TotalNZNonWeatherNonCatClmAmtWithin5YrTemp/NumNZNonWeatherNonCatClmWithin5Yr), 9999992), 0);


//Group 3, SF871 to SF960, and SF1621 to 1650, List B claims,
//SF871 - 875
ClaimsProperty: => NumColBClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColBClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColBClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColBClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColBClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF876 - 880, non zero
ClaimsProperty: => NumNZColBClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZColBClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZColBClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZColBClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZColBClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF881 - 885, cat
ClaimsProperty: => NumColBCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColBCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColBCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColBCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColBCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF886 - 890, cat and non zero
ClaimsProperty: => NumNZColBCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZColBCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZColBCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZColBCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZColBCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF891 - 895, non cat
ClaimsProperty: => NumColBNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColBNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColBNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColBNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColBNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));


//SF896 - 900, non cat and non zero
ClaimsProperty: => NumNZColBNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZColBNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZColBNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZColBNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZColBNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF896_TN, to SF899_TN
ClaimsProperty: => NumNZColBNonCatClmWithin1YrTN := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimNonCatTN = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZColBNonCatClmWithin2YrTN := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimNonCatTN = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZColBNonCatClmWithin3YrTN := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimNonCatTN = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZColBNonCatClmWithin4YrTN := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBNZClaimNonCatTN = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));


//SF901 to 905
ClaimsProperty: => ExistColBClmWithin1Yr := IF(NumColBClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBClmWithin2Yr := IF(NumColBClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBClmWithin3Yr := IF(NumColBClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBClmWithin4Yr := IF(NumColBClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBClmWithin5Yr := IF(NumColBClmWithin5Yr >= 1, 1, 0);

//SF906 to 910
ClaimsProperty: => ExistNZColBClmWithin1Yr := IF(NumNZColBClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBClmWithin2Yr := IF(NumNZColBClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBClmWithin3Yr := IF(NumNZColBClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBClmWithin4Yr := IF(NumNZColBClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBClmWithin5Yr := IF(NumNZColBClmWithin5Yr >= 1, 1, 0);

//SF910 to 915
ClaimsProperty: => ExistColBCatClmWithin1Yr := IF(NumColBCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBCatClmWithin2Yr := IF(NumColBCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBCatClmWithin3Yr := IF(NumColBCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBCatClmWithin4Yr := IF(NumColBCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBCatClmWithin5Yr := IF(NumColBCatClmWithin5Yr >= 1, 1, 0);

//SF916 to 920
ClaimsProperty: => ExistNZColBCatClmWithin1Yr := IF(NumNZColBCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBCatClmWithin2Yr := IF(NumNZColBCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBCatClmWithin3Yr := IF(NumNZColBCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBCatClmWithin4Yr := IF(NumNZColBCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBCatClmWithin5Yr := IF(NumNZColBCatClmWithin5Yr >= 1, 1, 0);

//SF921 to 925
ClaimsProperty: => ExistColBNonCatClmWithin1Yr := IF(NumColBNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBNonCatClmWithin2Yr := IF(NumColBNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBNonCatClmWithin3Yr := IF(NumColBNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBNonCatClmWithin4Yr := IF(NumColBNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBNonCatClmWithin5Yr := IF(NumColBNonCatClmWithin5Yr >= 1, 1, 0);

//SF926 to 930
ClaimsProperty: => ExistNZColBNonCatClmWithin1Yr := IF(NumNZColBNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBNonCatClmWithin2Yr := IF(NumNZColBNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBNonCatClmWithin3Yr := IF(NumNZColBNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBNonCatClmWithin4Yr := IF(NumNZColBNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColBNonCatClmWithin5Yr := IF(NumNZColBNonCatClmWithin5Yr >= 1, 1, 0);

//SF931 to 935, 
ClaimsProperty: => TotalNZColBClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZColBClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZColBClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZColBClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZColBClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZColBClmAmtWithin1Yr := MIN(TotalNZColBClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZColBClmAmtWithin2Yr := MIN(TotalNZColBClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZColBClmAmtWithin3Yr := MIN(TotalNZColBClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZColBClmAmtWithin4Yr := MIN(TotalNZColBClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZColBClmAmtWithin5Yr := MIN(TotalNZColBClmAmtWithin5YrTemp, 9999992);

//SF936 to 940
ClaimsProperty: => TotalNZColBCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZColBCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZColBCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZColBCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZColBCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZColBCatClmAmtWithin1Yr := MIN(TotalNZColBCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZColBCatClmAmtWithin2Yr := MIN(TotalNZColBCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZColBCatClmAmtWithin3Yr := MIN(TotalNZColBCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZColBCatClmAmtWithin4Yr := MIN(TotalNZColBCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZColBCatClmAmtWithin5Yr := MIN(TotalNZColBCatClmAmtWithin5YrTemp, 9999992);

//SF941 to 945
ClaimsProperty: => TotalNZColBNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZColBNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZColBNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZColBNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZColBNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaimNonCat = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZColBNonCatClmAmtWithin1Yr := MIN(TotalNZColBNonCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZColBNonCatClmAmtWithin2Yr := MIN(TotalNZColBNonCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZColBNonCatClmAmtWithin3Yr := MIN(TotalNZColBNonCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZColBNonCatClmAmtWithin4Yr := MIN(TotalNZColBNonCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZColBNonCatClmAmtWithin5Yr := MIN(TotalNZColBNonCatClmAmtWithin5YrTemp, 9999992);

//SF946 to 950
ClaimsProperty: => AvgNZColBClmAmtWithin1Yr := IF(NumNZColBClmWithin1Yr > 0, MIN(ROUND(TotalNZColBClmAmtWithin1YrTemp/NumNZColBClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBClmAmtWithin2Yr := IF(NumNZColBClmWithin2Yr > 0, MIN(ROUND(TotalNZColBClmAmtWithin2YrTemp/NumNZColBClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBClmAmtWithin3Yr := IF(NumNZColBClmWithin3Yr > 0, MIN(ROUND(TotalNZColBClmAmtWithin3YrTemp/NumNZColBClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBClmAmtWithin4Yr := IF(NumNZColBClmWithin4Yr > 0, MIN(ROUND(TotalNZColBClmAmtWithin4YrTemp/NumNZColBClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBClmAmtWithin5Yr := IF(NumNZColBClmWithin5Yr > 0, MIN(ROUND(TotalNZColBClmAmtWithin5YrTemp/NumNZColBClmWithin5Yr), 9999992), 0);

//SF951 to 955
ClaimsProperty: => AvgNZColBCatClmAmtWithin1Yr := IF(NumNZColBCatClmWithin1Yr > 0, MIN(ROUND(TotalNZColBCatClmAmtWithin1YrTemp/NumNZColBCatClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBCatClmAmtWithin2Yr := IF(NumNZColBCatClmWithin2Yr > 0, MIN(ROUND(TotalNZColBCatClmAmtWithin2YrTemp/NumNZColBCatClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBCatClmAmtWithin3Yr := IF(NumNZColBCatClmWithin3Yr > 0, MIN(ROUND(TotalNZColBCatClmAmtWithin3YrTemp/NumNZColBCatClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBCatClmAmtWithin4Yr := IF(NumNZColBCatClmWithin4Yr > 0, MIN(ROUND(TotalNZColBCatClmAmtWithin4YrTemp/NumNZColBCatClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBCatClmAmtWithin5Yr := IF(NumNZColBCatClmWithin5Yr > 0, MIN(ROUND(TotalNZColBCatClmAmtWithin5YrTemp/NumNZColBCatClmWithin5Yr), 9999992), 0);

//SF956 to 960
ClaimsProperty: => AvgNZColBNonCatClmAmtWithin1Yr := IF(NumNZColBNonCatClmWithin1Yr > 0, MIN(ROUND(TotalNZColBNonCatClmAmtWithin1YrTemp/NumNZColBNonCatClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBNonCatClmAmtWithin2Yr := IF(NumNZColBNonCatClmWithin2Yr > 0, MIN(ROUND(TotalNZColBNonCatClmAmtWithin2YrTemp/NumNZColBNonCatClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBNonCatClmAmtWithin3Yr := IF(NumNZColBNonCatClmWithin3Yr > 0, MIN(ROUND(TotalNZColBNonCatClmAmtWithin3YrTemp/NumNZColBNonCatClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBNonCatClmAmtWithin4Yr := IF(NumNZColBNonCatClmWithin4Yr > 0, MIN(ROUND(TotalNZColBNonCatClmAmtWithin4YrTemp/NumNZColBNonCatClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZColBNonCatClmAmtWithin5Yr := IF(NumNZColBNonCatClmWithin5Yr > 0, MIN(ROUND(TotalNZColBNonCatClmAmtWithin5YrTemp/NumNZColBNonCatClmWithin5Yr), 9999992), 0);


// DO NOT NEED CALCULATE THE ATTRIBUTES FOR SF16.....
//SF1621 to 1625, The average count in list B, total list B causes of loss count / number of list B claims
ClaimsPropertyClaim.Payments: => IsColBCV := IF(cClaimCatType IN ClaimsPropertyClaim.COLB_CODE_LIST, 1, 0); //Filter to select the cause of loss are in List B
ClaimsPropertyClaim: => TotalCountsOfIsColBCVTemp := SUM(Payments, IsColBCV);

//ClaimsProperty: => TotalCountsOfIsColBCVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalCountsOfIsColBCVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalCountsOfIsColBCVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalCountsOfIsColBCVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalCountsOfIsColBCVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColBCVTemp);

//ClaimsProperty: => AvgColBCountWithin1Yr := IF( > 0, ROUND(TotalCountsOfIsColBCVWithin1YrTemp/NumColBClmWithin1Yr, 4); //KEEP 4 DECIMALS
//ClaimsProperty: => AvgColBCountWithin2Yr := IF( > 0, ROUND(TotalCountsOfIsColBCVWithin2YrTemp/NumColBClmWithin2Yr, 4); //KEEP 4 DECIMALS
//ClaimsProperty: => AvgColBCountWithin3Yr := IF( > 0, ROUND(TotalCountsOfIsColBCVWithin3YrTemp/NumColBClmWithin3Yr, 4); //KEEP 4 DECIMALS
//ClaimsProperty: => AvgColBCountWithin4Yr := IF( > 0, ROUND(TotalCountsOfIsColBCVWithin4YrTemp/NumColBClmWithin4Yr, 4); //KEEP 4 DECIMALS
//ClaimsProperty: => AvgColBCountWithin5Yr := IF( > 0, ROUND(TotalCountsOfIsColBCVWithin5YrTemp/NumColBClmWithin5Yr, 4); //KEEP 4 DECIMALS

//SF1626 to 1630, add total claim amt larger than 0
//ClaimsProperty: => TotalNZCountsOfIsColBCVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZCountsOfIsColBCVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZCountsOfIsColBCVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZCountsOfIsColBCVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZCountsOfIsColBCVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColBCVTemp);

//ClaimsProperty: => AvgNZColBCountWithin1Yr := IF( > 0, ROUND(TotalNZCountsOfIsColBCVWithin1YrTemp/NumNZColBClmWithin1Yr, 4);
//ClaimsProperty: => AvgNZColBCountWithin2Yr := IF( > 0, ROUND(TotalNZCountsOfIsColBCVWithin2YrTemp/NumNZColBClmWithin2Yr, 4);
//ClaimsProperty: => AvgNZColBCountWithin3Yr := IF( > 0, ROUND(TotalNZCountsOfIsColBCVWithin3YrTemp/NumNZColBClmWithin3Yr, 4);
//ClaimsProperty: => AvgNZColBCountWithin4Yr := IF( > 0, ROUND(TotalNZCountsOfIsColBCVWithin4YrTemp/NumNZColBClmWithin4Yr, 4);
//ClaimsProperty: => AvgNZColBCountWithin5Yr := IF( > 0, ROUND(TotalNZCountsOfIsColBCVWithin5YrTemp/NumNZColBClmWithin5Yr, 4);


//SF1631 to 1635, add the cat indicator 














//ClaimsProperty: => TotalCatCountsOfIsColBCVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalCatCountsOfIsColBCVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalCatCountsOfIsColBCVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalCatCountsOfIsColBCVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColBCVTemp);












//ClaimsProperty: => TotalCatCountsOfIsColBCVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColBCVTemp);








//ClaimsProperty: => AvgColBCatCountWithin1Yr := IF( > 0, ROUND(TotalCatCountsOfIsColBCVWithin1YrTemp/NumColBCatClmWithin1Yr, 4);
//ClaimsProperty: => AvgColBCatCountWithin2Yr := IF( > 0, ROUND(TotalCatCountsOfIsColBCVWithin2YrTemp/NumColBCatClmWithin2Yr, 4);
//ClaimsProperty: => AvgColBCatCountWithin3Yr := IF( > 0, ROUND(TotalCatCountsOfIsColBCVWithin3YrTemp/NumColBCatClmWithin3Yr, 4);
//ClaimsProperty: => AvgColBCatCountWithin4Yr := IF( > 0, ROUND(TotalCatCountsOfIsColBCVWithin4YrTemp/NumColBCatClmWithin4Yr, 4);
//ClaimsProperty: => AvgColBCatCountWithin5Yr := IF( > 0, ROUND(TotalCatCountsOfIsColBCVWithin5YrTemp/NumColBCatClmWithin5Yr, 4);
//
//
////SF1636 to 1640, add cat and total claim amt larger than 0
//ClaimsProperty: => TotalNZCatCountsOfIsColBCVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZCatCountsOfIsColBCVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZCatCountsOfIsColBCVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZCatCountsOfIsColBCVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZCatCountsOfIsColBCVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColBCVTemp);
//
//ClaimsProperty: => AvgNZColBCatCountWithin1Yr := IF( > 0, ROUND(TotalNZCatCountsOfIsColBCVWithin1YrTemp/NumNZColBCatClmWithin1Yr, 4);
//ClaimsProperty: => AvgNZColBCatCountWithin2Yr := IF( > 0, ROUND(TotalNZCatCountsOfIsColBCVWithin2YrTemp/NumNZColBCatClmWithin2Yr, 4);
//ClaimsProperty: => AvgNZColBCatCountWithin3Yr := IF( > 0, ROUND(TotalNZCatCountsOfIsColBCVWithin3YrTemp/NumNZColBCatClmWithin3Yr, 4);
//ClaimsProperty: => AvgNZColBCatCountWithin4Yr := IF( > 0, ROUND(TotalNZCatCountsOfIsColBCVWithin4YrTemp/NumNZColBCatClmWithin4Yr, 4);
//ClaimsProperty: => AvgNZColBCatCountWithin5Yr := IF( > 0, ROUND(TotalNZCatCountsOfIsColBCVWithin5YrTemp/NumNZColBCatClmWithin5Yr, 4);
//
////SF1641 to 1645
//ClaimsProperty: => TotalNonCatCountsOfIsColBCVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNonCatCountsOfIsColBCVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNonCatCountsOfIsColBCVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNonCatCountsOfIsColBCVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNonCatCountsOfIsColBCVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColBCVTemp);
//
//ClaimsProperty: => AvgColBNonCatCountWithin1Yr := IF( > 0, ROUND(TotalNonCatCountsOfIsColBCVWithin1YrTemp/NumColBNonCatClmWithin1Yr, 4);
//ClaimsProperty: => AvgColBNonCatCountWithin2Yr := IF( > 0, ROUND(TotalNonCatCountsOfIsColBCVWithin2YrTemp/NumColBNonCatClmWithin2Yr, 4);
//ClaimsProperty: => AvgColBNonCatCountWithin3Yr := IF( > 0, ROUND(TotalNonCatCountsOfIsColBCVWithin3YrTemp/NumColBNonCatClmWithin3Yr, 4);
//ClaimsProperty: => AvgColBNonCatCountWithin4Yr := IF( > 0, ROUND(TotalNonCatCountsOfIsColBCVWithin4YrTemp/NumColBNonCatClmWithin4Yr, 4);
//ClaimsProperty: => AvgColBNonCatCountWithin5Yr := IF( > 0, ROUND(TotalNonCatCountsOfIsColBCVWithin5YrTemp/NumColBNonCatClmWithin5Yr, 4);
//
////SF1646 to 1650
//ClaimsProperty: => TotalNZNonCatCountsOfIsColBCVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZNonCatCountsOfIsColBCVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZNonCatCountsOfIsColBCVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZNonCatCountsOfIsColBCVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColBCVTemp);
//ClaimsProperty: => TotalNZNonCatCountsOfIsColBCVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColBCVTemp);
//
//ClaimsProperty: => AvgNZColBNonCatCountWithin1Yr := IF( > 0, ROUND(TotalNZNonCatCountsOfIsColBCVWithin1YrTemp/NumNZColBNonCatClmWithin1Yr, 4);
//ClaimsProperty: => AvgNZColBNonCatCountWithin2Yr := IF( > 0, ROUND(TotalNZNonCatCountsOfIsColBCVWithin2YrTemp/NumNZColBNonCatClmWithin2Yr, 4);
//ClaimsProperty: => AvgNZColBNonCatCountWithin3Yr := IF( > 0, ROUND(TotalNZNonCatCountsOfIsColBCVWithin3YrTemp/NumNZColBNonCatClmWithin3Yr, 4);
//ClaimsProperty: => AvgNZColBNonCatCountWithin4Yr := IF( > 0, ROUND(TotalNZNonCatCountsOfIsColBCVWithin4YrTemp/NumNZColBNonCatClmWithin4Yr, 4);
//ClaimsProperty: => AvgNZColBNonCatCountWithin5Yr := IF( > 0, ROUND(TotalNZNonCatCountsOfIsColBCVWithin5YrTemp/NumNZColBNonCatClmWithin5Yr, 4);
//START HERE AGAIN, BECAUSE NO NEED CALCULATE THE SF16... ABOVE







//Group 4, SF961 to Fire claims
//SF961-965, Fire smoke claims, 
ClaimsProperty: => NumFireSmokeClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumFireSmokeClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumFireSmokeClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumFireSmokeClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumFireSmokeClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF966 - 970, Fire smoke claims, none zero
ClaimsProperty: => NumNZFireSmokeClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZFireSmokeClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZFireSmokeClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZFireSmokeClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZFireSmokeClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF971 - 975, fire smoke claims, cat
ClaimsProperty: => NumFireSmokeCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumFireSmokeCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumFireSmokeCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumFireSmokeCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumFireSmokeCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF976 - 980, fire smoke claims, cat, and none zero
ClaimsProperty: => NumNZFireSmokeCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZFireSmokeCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZFireSmokeCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZFireSmokeCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZFireSmokeCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF981 to 985, fire smoke claims, none cat
ClaimsProperty: => NumFireSmokeNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumFireSmokeNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumFireSmokeNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumFireSmokeNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumFireSmokeNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF986 to 990, fire smoke claims, none cat, and none zero
ClaimsProperty: => NumNZFireSmokeNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZFireSmokeNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZFireSmokeNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZFireSmokeNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZFireSmokeNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));
    

//SF991 to 1020
ClaimsProperty: => ExistFireSmokeClmWithin1Yr   := IF( NumFireSmokeClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeClmWithin2Yr   := IF( NumFireSmokeClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeClmWithin3Yr   := IF( NumFireSmokeClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeClmWithin4Yr   := IF( NumFireSmokeClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeClmWithin5Yr   := IF( NumFireSmokeClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeClmWithin1Yr := IF( NumNZFireSmokeClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeClmWithin2Yr := IF( NumNZFireSmokeClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeClmWithin3Yr := IF( NumNZFireSmokeClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeClmWithin4Yr := IF( NumNZFireSmokeClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeClmWithin5Yr := IF( NumNZFireSmokeClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeCatClmWithin1Yr      := IF( NumFireSmokeCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeCatClmWithin2Yr      := IF( NumFireSmokeCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeCatClmWithin3Yr      := IF( NumFireSmokeCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeCatClmWithin4Yr      := IF( NumFireSmokeCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeCatClmWithin5Yr      := IF( NumFireSmokeCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeCatClmWithin1Yr    := IF( NumNZFireSmokeCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeCatClmWithin2Yr    := IF( NumNZFireSmokeCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeCatClmWithin3Yr    := IF( NumNZFireSmokeCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeCatClmWithin4Yr    := IF( NumNZFireSmokeCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeCatClmWithin5Yr    := IF( NumNZFireSmokeCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeNonCatClmWithin1Yr   := IF( NumFireSmokeNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeNonCatClmWithin2Yr   := IF( NumFireSmokeNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeNonCatClmWithin3Yr   := IF( NumFireSmokeNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeNonCatClmWithin4Yr   := IF( NumFireSmokeNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistFireSmokeNonCatClmWithin5Yr   := IF( NumFireSmokeNonCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeNonCatClmWithin1Yr := IF( NumNZFireSmokeNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeNonCatClmWithin2Yr := IF( NumNZFireSmokeNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeNonCatClmWithin3Yr := IF( NumNZFireSmokeNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeNonCatClmWithin4Yr := IF( NumNZFireSmokeNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZFireSmokeNonCatClmWithin5Yr := IF( NumNZFireSmokeNonCatClmWithin5Yr >= 1, 1, 0);

//SF1021 to 1025,
ClaimsProperty: => TotalNZFireSmokeClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeClmAmtWithin1Yr := MIN(TotalNZFireSmokeClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeClmAmtWithin2Yr := MIN(TotalNZFireSmokeClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeClmAmtWithin3Yr := MIN(TotalNZFireSmokeClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeClmAmtWithin4Yr := MIN(TotalNZFireSmokeClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeClmAmtWithin5Yr := MIN(TotalNZFireSmokeClmAmtWithin5YrTemp, 9999992);

//SF1026 to 1030
ClaimsProperty: => TotalNZFireSmokeCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeCatClmAmtWithin1Yr := MIN(TotalNZFireSmokeCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeCatClmAmtWithin2Yr := MIN(TotalNZFireSmokeCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeCatClmAmtWithin3Yr := MIN(TotalNZFireSmokeCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeCatClmAmtWithin4Yr := MIN(TotalNZFireSmokeCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeCatClmAmtWithin5Yr := MIN(TotalNZFireSmokeCatClmAmtWithin5YrTemp, 9999992);

//SF1031 to 1035
ClaimsProperty: => TotalNZFireSmokeNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE  AND IsCOLLCClaim = FALSE AND IsFireSmokeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZFireSmokeNonCatClmAmtWithin1Yr := MIN(TotalNZFireSmokeNonCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeNonCatClmAmtWithin2Yr := MIN(TotalNZFireSmokeNonCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeNonCatClmAmtWithin3Yr := MIN(TotalNZFireSmokeNonCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeNonCatClmAmtWithin4Yr := MIN(TotalNZFireSmokeNonCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZFireSmokeNonCatClmAmtWithin5Yr := MIN(TotalNZFireSmokeNonCatClmAmtWithin5YrTemp, 9999992);

//SF1036 to 1040
ClaimsProperty: => AvgNZFireSmokeClmAmtWithin1Yr := IF(NumNZFireSmokeClmWithin1Yr > 0, MIN(ROUND(TotalNZFireSmokeClmAmtWithin1YrTemp/NumNZFireSmokeClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeClmAmtWithin2Yr := IF(NumNZFireSmokeClmWithin2Yr > 0, MIN(ROUND(TotalNZFireSmokeClmAmtWithin2YrTemp/NumNZFireSmokeClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeClmAmtWithin3Yr := IF(NumNZFireSmokeClmWithin3Yr > 0, MIN(ROUND(TotalNZFireSmokeClmAmtWithin3YrTemp/NumNZFireSmokeClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeClmAmtWithin4Yr := IF(NumNZFireSmokeClmWithin4Yr > 0, MIN(ROUND(TotalNZFireSmokeClmAmtWithin4YrTemp/NumNZFireSmokeClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeClmAmtWithin5Yr := IF(NumNZFireSmokeClmWithin5Yr > 0, MIN(ROUND(TotalNZFireSmokeClmAmtWithin5YrTemp/NumNZFireSmokeClmWithin5Yr), 9999992), 0);
 
//SF1041 to 1045
ClaimsProperty: => AvgNZFireSmokeCatClmAmtWithin1Yr := IF(NumNZFireSmokeCatClmWithin1Yr > 0, MIN(ROUND(TotalNZFireSmokeCatClmAmtWithin1YrTemp/NumNZFireSmokeCatClmWithin1Yr ), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeCatClmAmtWithin2Yr := IF(NumNZFireSmokeCatClmWithin2Yr > 0, MIN(ROUND(TotalNZFireSmokeCatClmAmtWithin2YrTemp/NumNZFireSmokeCatClmWithin2Yr ), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeCatClmAmtWithin3Yr := IF(NumNZFireSmokeCatClmWithin3Yr > 0, MIN(ROUND(TotalNZFireSmokeCatClmAmtWithin3YrTemp/NumNZFireSmokeCatClmWithin3Yr ), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeCatClmAmtWithin4Yr := IF(NumNZFireSmokeCatClmWithin4Yr > 0, MIN(ROUND(TotalNZFireSmokeCatClmAmtWithin4YrTemp/NumNZFireSmokeCatClmWithin4Yr ), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeCatClmAmtWithin5Yr := IF(NumNZFireSmokeCatClmWithin5Yr > 0, MIN(ROUND(TotalNZFireSmokeCatClmAmtWithin5YrTemp/NumNZFireSmokeCatClmWithin5Yr ), 9999992), 0);


//SF1046 to 1050 
ClaimsProperty: => AvgNZFireSmokeNonCatClmAmtWithin1Yr := IF(NumNZFireSmokeNonCatClmWithin1Yr > 0, MIN(ROUND(TotalNZFireSmokeNonCatClmAmtWithin1YrTemp/NumNZFireSmokeNonCatClmWithin1Yr ), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeNonCatClmAmtWithin2Yr := IF(NumNZFireSmokeNonCatClmWithin2Yr > 0, MIN(ROUND(TotalNZFireSmokeNonCatClmAmtWithin2YrTemp/NumNZFireSmokeNonCatClmWithin2Yr ), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeNonCatClmAmtWithin3Yr := IF(NumNZFireSmokeNonCatClmWithin3Yr > 0, MIN(ROUND(TotalNZFireSmokeNonCatClmAmtWithin3YrTemp/NumNZFireSmokeNonCatClmWithin3Yr ), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeNonCatClmAmtWithin4Yr := IF(NumNZFireSmokeNonCatClmWithin4Yr > 0, MIN(ROUND(TotalNZFireSmokeNonCatClmAmtWithin4YrTemp/NumNZFireSmokeNonCatClmWithin4Yr ), 9999992), 0);
ClaimsProperty: => AvgNZFireSmokeNonCatClmAmtWithin5Yr := IF(NumNZFireSmokeNonCatClmWithin5Yr > 0, MIN(ROUND(TotalNZFireSmokeNonCatClmAmtWithin5YrTemp/NumNZFireSmokeNonCatClmWithin5Yr ), 9999992), 0);


 
//Group 5, SF1051 to 1140, Crime claims  
//SF1051 to 1055, crime claim, cat and none cat, with zero
ClaimsProperty: => NumCrimeClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumCrimeClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumCrimeClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumCrimeClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumCrimeClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1056 to 1060, crime claim, cat and none cat, none zero
ClaimsProperty: => NumNZCrimeClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZCrimeClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZCrimeClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZCrimeClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZCrimeClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1061 to 1065, crime claim, cat and with zero
ClaimsProperty: => NumCrimeCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumCrimeCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumCrimeCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumCrimeCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumCrimeCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1066 to 1070, crime claim, cat and none zero
ClaimsProperty: => NumNZCrimeCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZCrimeCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZCrimeCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZCrimeCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZCrimeCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1071 to 1075, crime claim, none cat and with zero
ClaimsProperty: => NumCrimeNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumCrimeNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumCrimeNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumCrimeNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumCrimeNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1076 to 1080, crime claim, none cata and none zero
ClaimsProperty: => NumNZCrimeNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZCrimeNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZCrimeNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZCrimeNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZCrimeNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1081 -1110
ClaimsProperty: => ExistCrimeClmWithin1Yr   := IF( NumCrimeClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeClmWithin2Yr   := IF( NumCrimeClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeClmWithin3Yr   := IF( NumCrimeClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeClmWithin4Yr   := IF( NumCrimeClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeClmWithin5Yr   := IF( NumCrimeClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeClmWithin1Yr := IF( NumNZCrimeClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeClmWithin2Yr := IF( NumNZCrimeClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeClmWithin3Yr := IF( NumNZCrimeClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeClmWithin4Yr := IF( NumNZCrimeClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeClmWithin5Yr := IF( NumNZCrimeClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeCatClmWithin1Yr      := IF( NumCrimeCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeCatClmWithin2Yr      := IF( NumCrimeCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeCatClmWithin3Yr      := IF( NumCrimeCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeCatClmWithin4Yr      := IF( NumCrimeCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeCatClmWithin5Yr      := IF( NumCrimeCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeCatClmWithin1Yr    := IF( NumNZCrimeCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeCatClmWithin2Yr    := IF( NumNZCrimeCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeCatClmWithin3Yr    := IF( NumNZCrimeCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeCatClmWithin4Yr    := IF( NumNZCrimeCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeCatClmWithin5Yr    := IF( NumNZCrimeCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeNonCatClmWithin1Yr   := IF( NumCrimeNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeNonCatClmWithin2Yr   := IF( NumCrimeNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeNonCatClmWithin3Yr   := IF( NumCrimeNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeNonCatClmWithin4Yr   := IF( NumCrimeNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistCrimeNonCatClmWithin5Yr   := IF( NumCrimeNonCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeNonCatClmWithin1Yr := IF( NumNZCrimeNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeNonCatClmWithin2Yr := IF( NumNZCrimeNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeNonCatClmWithin3Yr := IF( NumNZCrimeNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeNonCatClmWithin4Yr := IF( NumNZCrimeNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZCrimeNonCatClmWithin5Yr := IF( NumNZCrimeNonCatClmWithin5Yr >= 1, 1, 0);

//SF1111 to 1115,
ClaimsProperty: => TotalNZCrimeClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeClmAmtWithin1Yr := MIN(TotalNZCrimeClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeClmAmtWithin2Yr := MIN(TotalNZCrimeClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeClmAmtWithin3Yr := MIN(TotalNZCrimeClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeClmAmtWithin4Yr := MIN(TotalNZCrimeClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeClmAmtWithin5Yr := MIN(TotalNZCrimeClmAmtWithin5YrTemp, 9999992);


//SF1116 to 1120
ClaimsProperty: => TotalNZCrimeCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeCatClmAmtWithin1Yr := MIN(TotalNZCrimeCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeCatClmAmtWithin2Yr := MIN(TotalNZCrimeCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeCatClmAmtWithin3Yr := MIN(TotalNZCrimeCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeCatClmAmtWithin4Yr := MIN(TotalNZCrimeCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeCatClmAmtWithin5Yr := MIN(TotalNZCrimeCatClmAmtWithin5YrTemp, 9999992);


//SF1121 to 1125
ClaimsProperty: => TotalNZCrimeNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsCrimeClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZCrimeNonCatClmAmtWithin1Yr := MIN(TotalNZCrimeNonCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeNonCatClmAmtWithin2Yr := MIN(TotalNZCrimeNonCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeNonCatClmAmtWithin3Yr := MIN(TotalNZCrimeNonCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeNonCatClmAmtWithin4Yr := MIN(TotalNZCrimeNonCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZCrimeNonCatClmAmtWithin5Yr := MIN(TotalNZCrimeNonCatClmAmtWithin5YrTemp, 9999992);


//SF1126 to 1130
ClaimsProperty: => AvgNZCrimeClmAmtWithin1Yr := IF(NumNZCrimeClmWithin1Yr > 0, MIN(ROUND(TotalNZCrimeClmAmtWithin1YrTemp/NumNZCrimeClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZCrimeClmAmtWithin2Yr := IF(NumNZCrimeClmWithin2Yr > 0, MIN(ROUND(TotalNZCrimeClmAmtWithin2YrTemp/NumNZCrimeClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZCrimeClmAmtWithin3Yr := IF(NumNZCrimeClmWithin3Yr > 0, MIN(ROUND(TotalNZCrimeClmAmtWithin3YrTemp/NumNZCrimeClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZCrimeClmAmtWithin4Yr := IF(NumNZCrimeClmWithin4Yr > 0, MIN(ROUND(TotalNZCrimeClmAmtWithin4YrTemp/NumNZCrimeClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZCrimeClmAmtWithin5Yr := IF(NumNZCrimeClmWithin5Yr > 0, MIN(ROUND(TotalNZCrimeClmAmtWithin5YrTemp/NumNZCrimeClmWithin5Yr), 9999992), 0);

//SF1131 to 1135
ClaimsProperty: => AvgNZCrimeCatClmAmtWithin1Yr := IF(NumNZCrimeCatClmWithin1Yr > 0, MIN(ROUND(TotalNZCrimeCatClmAmtWithin1YrTemp/NumNZCrimeCatClmWithin1Yr ), 9999992), 0);
ClaimsProperty: => AvgNZCrimeCatClmAmtWithin2Yr := IF(NumNZCrimeCatClmWithin2Yr > 0, MIN(ROUND(TotalNZCrimeCatClmAmtWithin2YrTemp/NumNZCrimeCatClmWithin2Yr ), 9999992), 0);
ClaimsProperty: => AvgNZCrimeCatClmAmtWithin3Yr := IF(NumNZCrimeCatClmWithin3Yr > 0, MIN(ROUND(TotalNZCrimeCatClmAmtWithin3YrTemp/NumNZCrimeCatClmWithin3Yr ), 9999992), 0);
ClaimsProperty: => AvgNZCrimeCatClmAmtWithin4Yr := IF(NumNZCrimeCatClmWithin4Yr > 0, MIN(ROUND(TotalNZCrimeCatClmAmtWithin4YrTemp/NumNZCrimeCatClmWithin4Yr ), 9999992), 0);
ClaimsProperty: => AvgNZCrimeCatClmAmtWithin5Yr := IF(NumNZCrimeCatClmWithin5Yr > 0, MIN(ROUND(TotalNZCrimeCatClmAmtWithin5YrTemp/NumNZCrimeCatClmWithin5Yr ), 9999992), 0);


//SF1136 to 1140 
ClaimsProperty: => AvgNZCrimeNonCatClmAmtWithin1Yr := IF(NumNZCrimeNonCatClmWithin1Yr > 0, MIN(ROUND(TotalNZCrimeNonCatClmAmtWithin1YrTemp/NumNZCrimeNonCatClmWithin1Yr ), 9999992), 0);
ClaimsProperty: => AvgNZCrimeNonCatClmAmtWithin2Yr := IF(NumNZCrimeNonCatClmWithin2Yr > 0, MIN(ROUND(TotalNZCrimeNonCatClmAmtWithin2YrTemp/NumNZCrimeNonCatClmWithin2Yr ), 9999992), 0);
ClaimsProperty: => AvgNZCrimeNonCatClmAmtWithin3Yr := IF(NumNZCrimeNonCatClmWithin3Yr > 0, MIN(ROUND(TotalNZCrimeNonCatClmAmtWithin3YrTemp/NumNZCrimeNonCatClmWithin3Yr ), 9999992), 0);
ClaimsProperty: => AvgNZCrimeNonCatClmAmtWithin4Yr := IF(NumNZCrimeNonCatClmWithin4Yr > 0, MIN(ROUND(TotalNZCrimeNonCatClmAmtWithin4YrTemp/NumNZCrimeNonCatClmWithin4Yr ), 9999992), 0);
ClaimsProperty: => AvgNZCrimeNonCatClmAmtWithin5Yr := IF(NumNZCrimeNonCatClmWithin5Yr > 0, MIN(ROUND(TotalNZCrimeNonCatClmAmtWithin5YrTemp/NumNZCrimeNonCatClmWithin5Yr ), 9999992), 0);


 

//Group 6, SF1141 to SF1230, Liability claims

//SF1141 to 1145, liability claims, cat and none cat, with zero
ClaimsProperty: => NumLiabilityClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumLiabilityClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumLiabilityClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumLiabilityClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumLiabilityClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1146 to 1150, liability claims, cat and none cat, without zero
ClaimsProperty: => NumNZLiabilityClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZLiabilityClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZLiabilityClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZLiabilityClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZLiabilityClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));


//SF1151 to 1155, liability claims, cat, with zero
ClaimsProperty: => NumLiabilityCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumLiabilityCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumLiabilityCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumLiabilityCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumLiabilityCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));


//SF1156 to 1160, liability claims, cat, without zero
ClaimsProperty: => NumNZLiabilityCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZLiabilityCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZLiabilityCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZLiabilityCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZLiabilityCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1161 to 1165, liability claims, none cat, with zero
ClaimsProperty: => NumLiabilityNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumLiabilityNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumLiabilityNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumLiabilityNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumLiabilityNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1166 to 1170, liability claims, none cat, without zero
ClaimsProperty: => NumNZLiabilityNonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZLiabilityNonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZLiabilityNonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZLiabilityNonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZLiabilityNonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityNZClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1171 to 1200
ClaimsProperty: => ExistLiabilityClmWithin1Yr   := IF( NumLiabilityClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityClmWithin2Yr   := IF( NumLiabilityClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityClmWithin3Yr   := IF( NumLiabilityClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityClmWithin4Yr   := IF( NumLiabilityClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityClmWithin5Yr   := IF( NumLiabilityClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityClmWithin1Yr := IF( NumNZLiabilityClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityClmWithin2Yr := IF( NumNZLiabilityClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityClmWithin3Yr := IF( NumNZLiabilityClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityClmWithin4Yr := IF( NumNZLiabilityClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityClmWithin5Yr := IF( NumNZLiabilityClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityCatClmWithin1Yr      := IF( NumLiabilityCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityCatClmWithin2Yr      := IF( NumLiabilityCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityCatClmWithin3Yr      := IF( NumLiabilityCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityCatClmWithin4Yr      := IF( NumLiabilityCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityCatClmWithin5Yr      := IF( NumLiabilityCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityCatClmWithin1Yr    := IF( NumNZLiabilityCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityCatClmWithin2Yr    := IF( NumNZLiabilityCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityCatClmWithin3Yr    := IF( NumNZLiabilityCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityCatClmWithin4Yr    := IF( NumNZLiabilityCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityCatClmWithin5Yr    := IF( NumNZLiabilityCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityNonCatClmWithin1Yr   := IF( NumLiabilityNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityNonCatClmWithin2Yr   := IF( NumLiabilityNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityNonCatClmWithin3Yr   := IF( NumLiabilityNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityNonCatClmWithin4Yr   := IF( NumLiabilityNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistLiabilityNonCatClmWithin5Yr   := IF( NumLiabilityNonCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityNonCatClmWithin1Yr := IF( NumNZLiabilityNonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityNonCatClmWithin2Yr := IF( NumNZLiabilityNonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityNonCatClmWithin3Yr := IF( NumNZLiabilityNonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityNonCatClmWithin4Yr := IF( NumNZLiabilityNonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZLiabilityNonCatClmWithin5Yr := IF( NumNZLiabilityNonCatClmWithin5Yr >= 1, 1, 0);




//SF1201 to 1205,
ClaimsProperty: => TotalNZLiabilityClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaim = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityClmAmtWithin1Yr := MIN(TotalNZLiabilityClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityClmAmtWithin2Yr := MIN(TotalNZLiabilityClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityClmAmtWithin3Yr := MIN(TotalNZLiabilityClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityClmAmtWithin4Yr := MIN(TotalNZLiabilityClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityClmAmtWithin5Yr := MIN(TotalNZLiabilityClmAmtWithin5YrTemp, 9999992);

//SF1206 to 1210
ClaimsProperty: => TotalNZLiabilityCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityCatClmAmtWithin1Yr := MIN(TotalNZLiabilityCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityCatClmAmtWithin2Yr := MIN(TotalNZLiabilityCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityCatClmAmtWithin3Yr := MIN(TotalNZLiabilityCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityCatClmAmtWithin4Yr := MIN(TotalNZLiabilityCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityCatClmAmtWithin5Yr := MIN(TotalNZLiabilityCatClmAmtWithin5YrTemp, 9999992);

//SF1211 to 1215
ClaimsProperty: => TotalNZLiabilityNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZLiabilityNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLCClaim = FALSE AND IsLiabilityClaimNonCat = TRUE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);

ClaimsProperty: => TotalNZLiabilityNonCatClmAmtWithin1Yr := MIN(TotalNZLiabilityNonCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityNonCatClmAmtWithin2Yr := MIN(TotalNZLiabilityNonCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityNonCatClmAmtWithin3Yr := MIN(TotalNZLiabilityNonCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityNonCatClmAmtWithin4Yr := MIN(TotalNZLiabilityNonCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZLiabilityNonCatClmAmtWithin5Yr := MIN(TotalNZLiabilityNonCatClmAmtWithin5YrTemp, 9999992);

//SF1216 to 1210
ClaimsProperty: => AvgNZLiabilityClmAmtWithin1Yr := IF(NumNZLiabilityClmWithin1Yr > 0 , MIN(ROUND(TotalNZLiabilityClmAmtWithin1YrTemp/NumNZLiabilityClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityClmAmtWithin2Yr := IF(NumNZLiabilityClmWithin2Yr > 0 , MIN(ROUND(TotalNZLiabilityClmAmtWithin2YrTemp/NumNZLiabilityClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityClmAmtWithin3Yr := IF(NumNZLiabilityClmWithin3Yr > 0 , MIN(ROUND(TotalNZLiabilityClmAmtWithin3YrTemp/NumNZLiabilityClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityClmAmtWithin4Yr := IF(NumNZLiabilityClmWithin4Yr > 0 , MIN(ROUND(TotalNZLiabilityClmAmtWithin4YrTemp/NumNZLiabilityClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityClmAmtWithin5Yr := IF(NumNZLiabilityClmWithin5Yr > 0 , MIN(ROUND(TotalNZLiabilityClmAmtWithin5YrTemp/NumNZLiabilityClmWithin5Yr), 9999992), 0);
 
 
//SF1221 to 1225
ClaimsProperty: => AvgNZLiabilityCatClmAmtWithin1Yr := IF(NumNZLiabilityCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZLiabilityCatClmAmtWithin1YrTemp/NumNZLiabilityCatClmWithin1Yr ), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityCatClmAmtWithin2Yr := IF(NumNZLiabilityCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZLiabilityCatClmAmtWithin2YrTemp/NumNZLiabilityCatClmWithin2Yr ), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityCatClmAmtWithin3Yr := IF(NumNZLiabilityCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZLiabilityCatClmAmtWithin3YrTemp/NumNZLiabilityCatClmWithin3Yr ), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityCatClmAmtWithin4Yr := IF(NumNZLiabilityCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZLiabilityCatClmAmtWithin4YrTemp/NumNZLiabilityCatClmWithin4Yr ), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityCatClmAmtWithin5Yr := IF(NumNZLiabilityCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZLiabilityCatClmAmtWithin5YrTemp/NumNZLiabilityCatClmWithin5Yr ), 9999992), 0);

//SF1226 to 1230 
ClaimsProperty: => AvgNZLiabilityNonCatClmAmtWithin1Yr := IF(NumNZLiabilityNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZLiabilityNonCatClmAmtWithin1YrTemp/NumNZLiabilityNonCatClmWithin1Yr ), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityNonCatClmAmtWithin2Yr := IF(NumNZLiabilityNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZLiabilityNonCatClmAmtWithin2YrTemp/NumNZLiabilityNonCatClmWithin2Yr ), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityNonCatClmAmtWithin3Yr := IF(NumNZLiabilityNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZLiabilityNonCatClmAmtWithin3YrTemp/NumNZLiabilityNonCatClmWithin3Yr ), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityNonCatClmAmtWithin4Yr := IF(NumNZLiabilityNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZLiabilityNonCatClmAmtWithin4YrTemp/NumNZLiabilityNonCatClmWithin4Yr ), 9999992), 0);
ClaimsProperty: => AvgNZLiabilityNonCatClmAmtWithin5Yr := IF(NumNZLiabilityNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZLiabilityNonCatClmAmtWithin5YrTemp/NumNZLiabilityNonCatClmWithin5Yr ), 9999992), 0);



//Group 7, SF1231 to 1260, 1531 to 1620. List A claims
//SF1531 to 1535, List A claims, cat and none cat, with zero
ClaimsProperty: => NumColAClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColAClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColAClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColAClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColAClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1536 to 1539, List A claims, Cat and none at, without zero
ClaimsProperty: => NumNZColAClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZColAClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZColAClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZColAClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZColAClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1540 to 1545, List A claims, cat with zero
ClaimsProperty: => NumColACatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColACatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColACatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColACatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColACatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1546 to 1550, List A claims, cat without zero
ClaimsProperty: => NumNZColACatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZColACatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZColACatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZColACatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZColACatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1551 to 1555, List A claims, NonCat with zero
ClaimsProperty: => NumColANonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColANonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColANonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColANonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColANonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1556 to 1560, List A claims, NonCat without zero
ClaimsProperty: => NumNZColANonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumNZColANonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumNZColANonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumNZColANonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumNZColANonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLANZClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1561 to 1590
ClaimsProperty: => ExistColAClmWithin1Yr   := IF( NumColAClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAClmWithin2Yr   := IF( NumColAClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAClmWithin3Yr   := IF( NumColAClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAClmWithin4Yr   := IF( NumColAClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAClmWithin5Yr   := IF( NumColAClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColAClmWithin1Yr := IF( NumNZColAClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColAClmWithin2Yr := IF( NumNZColAClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColAClmWithin3Yr := IF( NumNZColAClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColAClmWithin4Yr := IF( NumNZColAClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColAClmWithin5Yr := IF( NumNZColAClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistColACatClmWithin1Yr      := IF( NumColACatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColACatClmWithin2Yr      := IF( NumColACatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColACatClmWithin3Yr      := IF( NumColACatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColACatClmWithin4Yr      := IF( NumColACatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColACatClmWithin5Yr      := IF( NumColACatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColACatClmWithin1Yr    := IF( NumNZColACatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColACatClmWithin2Yr    := IF( NumNZColACatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColACatClmWithin3Yr    := IF( NumNZColACatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColACatClmWithin4Yr    := IF( NumNZColACatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColACatClmWithin5Yr    := IF( NumNZColACatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistColANonCatClmWithin1Yr   := IF( NumColANonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColANonCatClmWithin2Yr   := IF( NumColANonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColANonCatClmWithin3Yr   := IF( NumColANonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColANonCatClmWithin4Yr   := IF( NumColANonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColANonCatClmWithin5Yr   := IF( NumColANonCatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColANonCatClmWithin1Yr := IF( NumNZColANonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColANonCatClmWithin2Yr := IF( NumNZColANonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColANonCatClmWithin3Yr := IF( NumNZColANonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColANonCatClmWithin4Yr := IF( NumNZColANonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistNZColANonCatClmWithin5Yr := IF( NumNZColANonCatClmWithin5Yr >= 1, 1, 0);

//SF1591 to 1595,
ClaimsProperty: => TotalNZColAClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZColAClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZColAClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZColAClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZColAClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZColAClmAmtWithin1Yr := MIN(TotalNZColAClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZColAClmAmtWithin2Yr := MIN(TotalNZColAClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZColAClmAmtWithin3Yr := MIN(TotalNZColAClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZColAClmAmtWithin4Yr := MIN(TotalNZColAClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZColAClmAmtWithin5Yr := MIN(TotalNZColAClmAmtWithin5YrTemp, 9999992);

//SF1596 to 1600
ClaimsProperty: => TotalNZColACatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZColACatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZColACatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZColACatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZColACatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZColACatClmAmtWithin1Yr := MIN(TotalNZColACatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZColACatClmAmtWithin2Yr := MIN(TotalNZColACatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZColACatClmAmtWithin3Yr := MIN(TotalNZColACatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZColACatClmAmtWithin4Yr := MIN(TotalNZColACatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZColACatClmAmtWithin5Yr := MIN(TotalNZColACatClmAmtWithin5YrTemp, 9999992);

//SF1601 to 1605
ClaimsProperty: => TotalNZColANonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalClaimAmt);
ClaimsProperty: => TotalNZColANonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalClaimAmt);
ClaimsProperty: => TotalNZColANonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalClaimAmt);
ClaimsProperty: => TotalNZColANonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalClaimAmt);
ClaimsProperty: => TotalNZColANonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalClaimAmt);
ClaimsProperty: => TotalNZColANonCatClmAmtWithin1Yr := MIN(TotalNZColANonCatClmAmtWithin1YrTemp, 9999992);
ClaimsProperty: => TotalNZColANonCatClmAmtWithin2Yr := MIN(TotalNZColANonCatClmAmtWithin2YrTemp, 9999992);
ClaimsProperty: => TotalNZColANonCatClmAmtWithin3Yr := MIN(TotalNZColANonCatClmAmtWithin3YrTemp, 9999992);
ClaimsProperty: => TotalNZColANonCatClmAmtWithin4Yr := MIN(TotalNZColANonCatClmAmtWithin4YrTemp, 9999992);
ClaimsProperty: => TotalNZColANonCatClmAmtWithin5Yr := MIN(TotalNZColANonCatClmAmtWithin5YrTemp, 9999992);

//SF1606 to 1610
ClaimsProperty: => AvgNZColAClmAmtWithin1Yr := IF(NumNZColAClmWithin1Yr > 0 , MIN(ROUND(TotalNZColAClmAmtWithin1YrTemp/NumNZColAClmWithin1Yr), 9999992), 0);
ClaimsProperty: => AvgNZColAClmAmtWithin2Yr := IF(NumNZColAClmWithin2Yr > 0 , MIN(ROUND(TotalNZColAClmAmtWithin2YrTemp/NumNZColAClmWithin2Yr), 9999992), 0);
ClaimsProperty: => AvgNZColAClmAmtWithin3Yr := IF(NumNZColAClmWithin3Yr > 0 , MIN(ROUND(TotalNZColAClmAmtWithin3YrTemp/NumNZColAClmWithin3Yr), 9999992), 0);
ClaimsProperty: => AvgNZColAClmAmtWithin4Yr := IF(NumNZColAClmWithin4Yr > 0 , MIN(ROUND(TotalNZColAClmAmtWithin4YrTemp/NumNZColAClmWithin4Yr), 9999992), 0);
ClaimsProperty: => AvgNZColAClmAmtWithin5Yr := IF(NumNZColAClmWithin5Yr > 0 , MIN(ROUND(TotalNZColAClmAmtWithin5YrTemp/NumNZColAClmWithin5Yr), 9999992), 0);
 
//SF1611 to 1615
ClaimsProperty: => AvgNZColACatClmAmtWithin1Yr := IF(NumNZColACatClmWithin1Yr > 0 , MIN(ROUND(TotalNZColACatClmAmtWithin1YrTemp/NumNZColACatClmWithin1Yr ), 9999992), 0);
ClaimsProperty: => AvgNZColACatClmAmtWithin2Yr := IF(NumNZColACatClmWithin2Yr > 0 , MIN(ROUND(TotalNZColACatClmAmtWithin2YrTemp/NumNZColACatClmWithin2Yr ), 9999992), 0);
ClaimsProperty: => AvgNZColACatClmAmtWithin3Yr := IF(NumNZColACatClmWithin3Yr > 0 , MIN(ROUND(TotalNZColACatClmAmtWithin3YrTemp/NumNZColACatClmWithin3Yr ), 9999992), 0);
ClaimsProperty: => AvgNZColACatClmAmtWithin4Yr := IF(NumNZColACatClmWithin4Yr > 0 , MIN(ROUND(TotalNZColACatClmAmtWithin4YrTemp/NumNZColACatClmWithin4Yr ), 9999992), 0);
ClaimsProperty: => AvgNZColACatClmAmtWithin5Yr := IF(NumNZColACatClmWithin5Yr > 0 , MIN(ROUND(TotalNZColACatClmAmtWithin5YrTemp/NumNZColACatClmWithin5Yr ), 9999992), 0);

//SF1616 to 1620 
ClaimsProperty: => AvgNZColANonCatClmAmtWithin1Yr := IF(NumNZColANonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZColANonCatClmAmtWithin1YrTemp/NumNZColANonCatClmWithin1Yr ), 9999992), 0);
ClaimsProperty: => AvgNZColANonCatClmAmtWithin2Yr := IF(NumNZColANonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZColANonCatClmAmtWithin2YrTemp/NumNZColANonCatClmWithin2Yr ), 9999992), 0);
ClaimsProperty: => AvgNZColANonCatClmAmtWithin3Yr := IF(NumNZColANonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZColANonCatClmAmtWithin3YrTemp/NumNZColANonCatClmWithin3Yr ), 9999992), 0);
ClaimsProperty: => AvgNZColANonCatClmAmtWithin4Yr := IF(NumNZColANonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZColANonCatClmAmtWithin4YrTemp/NumNZColANonCatClmWithin4Yr ), 9999992), 0);
ClaimsProperty: => AvgNZColANonCatClmAmtWithin5Yr := IF(NumNZColANonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZColANonCatClmAmtWithin5YrTemp/NumNZColANonCatClmWithin5Yr ), 9999992), 0);



//NO NEED CALCULATE THE FOLLOWING UNTIL 1260
//SF1231 to 1235, The average count in list A, total list A causes of loss count / number of list A claims
// ClaimsPropertyClaim.Payments: => IsColACV := IF(cClaimCatType IN ClaimsPropertyClaim.COLA_CODE_LIST, 1, 0); //Filter to select the cause of loss are in List A
// ClaimsPropertyClaim: => TotalCountsOfIsColACVTemp := SUM(Payments, IsColACV);

// ClaimsProperty: => TotalCountsOfIsColACVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalCountsOfIsColACVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalCountsOfIsColACVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalCountsOfIsColACVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalCountsOfIsColACVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColACVTemp);

// ClaimsProperty: => AvgColACountWithin1Yr := IF( > 0 , ROUND(TotalCountsOfIsColACVWithin1YrTemp/NumColAClmWithin1Yr); //KEEP 4 DECIMALS
// ClaimsProperty: => AvgColACountWithin2Yr := IF( > 0 , ROUND(TotalCountsOfIsColACVWithin2YrTemp/NumColAClmWithin2Yr); //KEEP 4 DECIMALS
// ClaimsProperty: => AvgColACountWithin3Yr := IF( > 0 , ROUND(TotalCountsOfIsColACVWithin3YrTemp/NumColAClmWithin3Yr); //KEEP 4 DECIMALS
// ClaimsProperty: => AvgColACountWithin4Yr := IF( > 0 , ROUND(TotalCountsOfIsColACVWithin4YrTemp/NumColAClmWithin4Yr); //KEEP 4 DECIMALS
// ClaimsProperty: => AvgColACountWithin5Yr := IF( > 0 , ROUND(TotalCountsOfIsColACVWithin5YrTemp/NumColAClmWithin5Yr); //KEEP 4 DECIMALS

//SF1236 to 1240, add total claim amt larger than 0
// ClaimsProperty: => TotalNZCountsOfIsColACVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZCountsOfIsColACVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZCountsOfIsColACVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZCountsOfIsColACVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZCountsOfIsColACVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColACVTemp);

// ClaimsProperty: => AvgNZColACountWithin1Yr := IF( > 0 , ROUND(TotalNZCountsOfIsColACVWithin1YrTemp/NumNZColAClmWithin1Yr);
// ClaimsProperty: => AvgNZColACountWithin2Yr := IF( > 0 , ROUND(TotalNZCountsOfIsColACVWithin2YrTemp/NumNZColAClmWithin2Yr);
// ClaimsProperty: => AvgNZColACountWithin3Yr := IF( > 0 , ROUND(TotalNZCountsOfIsColACVWithin3YrTemp/NumNZColAClmWithin3Yr);
// ClaimsProperty: => AvgNZColACountWithin4Yr := IF( > 0 , ROUND(TotalNZCountsOfIsColACVWithin4YrTemp/NumNZColAClmWithin4Yr);
// ClaimsProperty: => AvgNZColACountWithin5Yr := IF( > 0 , ROUND(TotalNZCountsOfIsColACVWithin5YrTemp/NumNZColAClmWithin5Yr);

//SF1241 to 1245, add the cat indicator 
// ClaimsProperty: => TotalCatCountsOfIsColACVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalCatCountsOfIsColACVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalCatCountsOfIsColACVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalCatCountsOfIsColACVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalCatCountsOfIsColACVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColACVTemp);

// ClaimsProperty: => AvgColACatCountWithin1Yr := IF( > 0 , ROUND(TotalCatCountsOfIsColACVWithin1YrTemp/NumColACatClmWithin1Yr);
// ClaimsProperty: => AvgColACatCountWithin2Yr := IF( > 0 , ROUND(TotalCatCountsOfIsColACVWithin2YrTemp/NumColACatClmWithin2Yr);
// ClaimsProperty: => AvgColACatCountWithin3Yr := IF( > 0 , ROUND(TotalCatCountsOfIsColACVWithin3YrTemp/NumColACatClmWithin3Yr);
// ClaimsProperty: => AvgColACatCountWithin4Yr := IF( > 0 , ROUND(TotalCatCountsOfIsColACVWithin4YrTemp/NumColACatClmWithin4Yr);
// ClaimsProperty: => AvgColACatCountWithin5Yr := IF( > 0 , ROUND(TotalCatCountsOfIsColACVWithin5YrTemp/NumColACatClmWithin5Yr);


//SF1246 to 1250, add cat and total claim amt larger than 0
// ClaimsProperty: => TotalNZCatCountsOfIsColACVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZCatCountsOfIsColACVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZCatCountsOfIsColACVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZCatCountsOfIsColACVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZCatCountsOfIsColACVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColACVTemp);

// ClaimsProperty: => AvgNZColACatCountWithin1Yr := IF( > 0 , ROUND(TotalNZCatCountsOfIsColACVWithin1YrTemp/NumNZColACatClmWithin1Yr);
// ClaimsProperty: => AvgNZColACatCountWithin2Yr := IF( > 0 , ROUND(TotalNZCatCountsOfIsColACVWithin2YrTemp/NumNZColACatClmWithin2Yr);
// ClaimsProperty: => AvgNZColACatCountWithin3Yr := IF( > 0 , ROUND(TotalNZCatCountsOfIsColACVWithin3YrTemp/NumNZColACatClmWithin3Yr);
// ClaimsProperty: => AvgNZColACatCountWithin4Yr := IF( > 0 , ROUND(TotalNZCatCountsOfIsColACVWithin4YrTemp/NumNZColACatClmWithin4Yr);
// ClaimsProperty: => AvgNZColACatCountWithin5Yr := IF( > 0 , ROUND(TotalNZCatCountsOfIsColACVWithin5YrTemp/NumNZColACatClmWithin5Yr);

//SF1251 to 1255
// ClaimsProperty: => TotalNonCatCountsOfIsColACVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNonCatCountsOfIsColACVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNonCatCountsOfIsColACVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNonCatCountsOfIsColACVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNonCatCountsOfIsColACVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColACVTemp);

// ClaimsProperty: => AvgColANonCatCountWithin1Yr := IF( > 0 , ROUND(TotalNonCatCountsOfIsColACVWithin1YrTemp/NumColANonCatClmWithin1Yr);
// ClaimsProperty: => AvgColANonCatCountWithin2Yr := IF( > 0 , ROUND(TotalNonCatCountsOfIsColACVWithin2YrTemp/NumColANonCatClmWithin2Yr);
// ClaimsProperty: => AvgColANonCatCountWithin3Yr := IF( > 0 , ROUND(TotalNonCatCountsOfIsColACVWithin3YrTemp/NumColANonCatClmWithin3Yr);
// ClaimsProperty: => AvgColANonCatCountWithin4Yr := IF( > 0 , ROUND(TotalNonCatCountsOfIsColACVWithin4YrTemp/NumColANonCatClmWithin4Yr);
// ClaimsProperty: => AvgColANonCatCountWithin5Yr := IF( > 0 , ROUND(TotalNonCatCountsOfIsColACVWithin5YrTemp/NumColANonCatClmWithin5Yr);

//SF1256 to 1260
// ClaimsProperty: => TotalNZNonCatCountsOfIsColACVWithin1YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZNonCatCountsOfIsColACVWithin2YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZNonCatCountsOfIsColACVWithin3YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZNonCatCountsOfIsColACVWithin4YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4), TotalCountsOfIsColACVTemp);
// ClaimsProperty: => TotalNZNonCatCountsOfIsColACVWithin5YrTemp := SUM(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND TotalClaimAmt > 0 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5), TotalCountsOfIsColACVTemp);

// ClaimsProperty: => AvgNZColANonCatCountWithin1Yr := IF( > 0 , ROUND(TotalNZNonCatCountsOfIsColACVWithin1YrTemp/NumNZColANonCatClmWithin1Yr);
// ClaimsProperty: => AvgNZColANonCatCountWithin2Yr := IF( > 0 , ROUND(TotalNZNonCatCountsOfIsColACVWithin2YrTemp/NumNZColANonCatClmWithin2Yr);
// ClaimsProperty: => AvgNZColANonCatCountWithin3Yr := IF( > 0 , ROUND(TotalNZNonCatCountsOfIsColACVWithin3YrTemp/NumNZColANonCatClmWithin3Yr);
// ClaimsProperty: => AvgNZColANonCatCountWithin4Yr := IF( > 0 , ROUND(TotalNZNonCatCountsOfIsColACVWithin4YrTemp/NumNZColANonCatClmWithin4Yr);
// ClaimsProperty: => AvgNZColANonCatCountWithin5Yr := IF( > 0 , ROUND(TotalNZNonCatCountsOfIsColACVWithin5YrTemp/NumNZColANonCatClmWithin5Yr);

//NO NEED CALCULATE THE ABOVE UNTIL 1260


//Group 8, Counts that total claim amount is larger than 5000 or 3000
//SF1291 to 1295,
ClaimsProperty: => NumColAGE5000ClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000  AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColAGE5000ClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000  AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColAGE5000ClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000  AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColAGE5000ClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000  AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColAGE5000ClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000  AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1301 to 1305
ClaimsProperty: => NumColAGE5000CatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000 AND cAtFaultIndicator = 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColAGE5000CatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000 AND cAtFaultIndicator = 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColAGE5000CatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000 AND cAtFaultIndicator = 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColAGE5000CatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000 AND cAtFaultIndicator = 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColAGE5000CatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000 AND cAtFaultIndicator = 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1311 to 1315
ClaimsProperty: => NumColAGE5000NonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000 AND cAtFaultIndicator != 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColAGE5000NonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000 AND cAtFaultIndicator != 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColAGE5000NonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000 AND cAtFaultIndicator != 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColAGE5000NonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000 AND cAtFaultIndicator != 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColAGE5000NonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 5000 AND cAtFaultIndicator != 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1321 to 1345, indicators
ClaimsProperty: => ExistColAGE5000ClmWithin1Yr   := IF( NumColAGE5000ClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000ClmWithin2Yr   := IF( NumColAGE5000ClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000ClmWithin3Yr   := IF( NumColAGE5000ClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000ClmWithin4Yr   := IF( NumColAGE5000ClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000ClmWithin5Yr   := IF( NumColAGE5000ClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000CatClmWithin1Yr      := IF( NumColAGE5000CatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000CatClmWithin2Yr      := IF( NumColAGE5000CatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000CatClmWithin3Yr      := IF( NumColAGE5000CatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000CatClmWithin4Yr      := IF( NumColAGE5000CatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000CatClmWithin5Yr      := IF( NumColAGE5000CatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000NonCatClmWithin1Yr   := IF( NumColAGE5000NonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000NonCatClmWithin2Yr   := IF( NumColAGE5000NonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000NonCatClmWithin3Yr   := IF( NumColAGE5000NonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000NonCatClmWithin4Yr   := IF( NumColAGE5000NonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE5000NonCatClmWithin5Yr   := IF( NumColAGE5000NonCatClmWithin5Yr >= 1, 1, 0);



//SF1411 to 1415
ClaimsProperty: => NumColAGE3000ClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000  AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColAGE3000ClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000  AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColAGE3000ClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000  AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColAGE3000ClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000  AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColAGE3000ClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000  AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1421 to 1425
ClaimsProperty: => NumColAGE3000CatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator = 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColAGE3000CatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator = 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColAGE3000CatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator = 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColAGE3000CatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator = 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColAGE3000CatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator = 'Y'   AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1431 to 1435
ClaimsProperty: => NumColAGE3000NonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColAGE3000NonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColAGE3000NonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColAGE3000NonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColAGE3000NonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaimNonCat = TRUE AND IsExclusionClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1441 to SF1465
ClaimsProperty: => ExistColAGE3000ClmWithin1Yr   := IF( NumColAGE3000ClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000ClmWithin2Yr   := IF( NumColAGE3000ClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000ClmWithin3Yr   := IF( NumColAGE3000ClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000ClmWithin4Yr   := IF( NumColAGE3000ClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000ClmWithin5Yr   := IF( NumColAGE3000ClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000CatClmWithin1Yr      := IF( NumColAGE3000CatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000CatClmWithin2Yr      := IF( NumColAGE3000CatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000CatClmWithin3Yr      := IF( NumColAGE3000CatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000CatClmWithin4Yr      := IF( NumColAGE3000CatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000CatClmWithin5Yr      := IF( NumColAGE3000CatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000NonCatClmWithin1Yr   := IF( NumColAGE3000NonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000NonCatClmWithin2Yr   := IF( NumColAGE3000NonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000NonCatClmWithin3Yr   := IF( NumColAGE3000NonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000NonCatClmWithin4Yr   := IF( NumColAGE3000NonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColAGE3000NonCatClmWithin5Yr   := IF( NumColAGE3000NonCatClmWithin5Yr >= 1, 1, 0);


//Group 9, 
//SF1351 to 1355
ClaimsProperty: => NumColBGE5000ClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND (TotalClaimAmt >= 5000) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColBGE5000ClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND (TotalClaimAmt >= 5000) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColBGE5000ClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND (TotalClaimAmt >= 5000) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColBGE5000ClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND (TotalClaimAmt >= 5000) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColBGE5000ClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND (TotalClaimAmt >= 5000) AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));


//SF1361 to 1365
ClaimsProperty: => NumColBGE5000CatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND (TotalClaimAmt >= 5000) AND IsValidClaim = TRUE AND (cAtFaultIndicator = 'Y') AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColBGE5000CatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND (TotalClaimAmt >= 5000) AND IsValidClaim = TRUE AND (cAtFaultIndicator = 'Y') AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColBGE5000CatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND (TotalClaimAmt >= 5000) AND IsValidClaim = TRUE AND (cAtFaultIndicator = 'Y') AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColBGE5000CatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND (TotalClaimAmt >= 5000) AND IsValidClaim = TRUE AND (cAtFaultIndicator = 'Y') AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColBGE5000CatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND (TotalClaimAmt >= 5000) AND IsValidClaim = TRUE AND (cAtFaultIndicator = 'Y') AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));


//SF1371 to 1375
ClaimsProperty: => NumColBGE5000NonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt >= 5000 AND IsValidClaim = TRUE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColBGE5000NonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt >= 5000 AND IsValidClaim = TRUE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColBGE5000NonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt >= 5000 AND IsValidClaim = TRUE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColBGE5000NonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt >= 5000 AND IsValidClaim = TRUE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColBGE5000NonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND TotalClaimAmt >= 5000 AND IsValidClaim = TRUE AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1381 to 1405, indicators
ClaimsProperty: => ExistColBGE5000ClmWithin1Yr   := IF( NumColBGE5000ClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000ClmWithin2Yr   := IF( NumColBGE5000ClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000ClmWithin3Yr   := IF( NumColBGE5000ClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000ClmWithin4Yr   := IF( NumColBGE5000ClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000ClmWithin5Yr   := IF( NumColBGE5000ClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000CatClmWithin1Yr      := IF( NumColBGE5000CatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000CatClmWithin2Yr      := IF( NumColBGE5000CatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000CatClmWithin3Yr      := IF( NumColBGE5000CatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000CatClmWithin4Yr      := IF( NumColBGE5000CatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000CatClmWithin5Yr      := IF( NumColBGE5000CatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000NonCatClmWithin1Yr   := IF( NumColBGE5000NonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000NonCatClmWithin2Yr   := IF( NumColBGE5000NonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000NonCatClmWithin3Yr   := IF( NumColBGE5000NonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000NonCatClmWithin4Yr   := IF( NumColBGE5000NonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE5000NonCatClmWithin5Yr   := IF( NumColBGE5000NonCatClmWithin5Yr >= 1, 1, 0);


//SF1471 to 1475
ClaimsProperty: => NumColBGE3000ClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColBGE3000ClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColBGE3000ClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColBGE3000ClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColBGE3000ClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));


//SF1481 to 1485
ClaimsProperty: => NumColBGE3000CatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColBGE3000CatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColBGE3000CatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColBGE3000CatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColBGE3000CatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator = 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));


//SF1491 to 1495
ClaimsProperty: => NumColBGE3000NonCatClmWithin1Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1));
ClaimsProperty: => NumColBGE3000NonCatClmWithin2Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2));
ClaimsProperty: => NumColBGE3000NonCatClmWithin3Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3));
ClaimsProperty: => NumColBGE3000NonCatClmWithin4Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4));
ClaimsProperty: => NumColBGE3000NonCatClmWithin5Yr := COUNT(ClaimsPropertyClaim (IsCOLLAClaim = TRUE AND IsExclusionClaim = FALSE AND IsCOLLBClaim = TRUE AND IsCOLLCClaim = FALSE AND IsValidClaim = TRUE AND TotalClaimAmt >= 3000 AND cAtFaultIndicator != 'Y' AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5));

//SF1501 to 1525
ClaimsProperty: => ExistColBGE3000ClmWithin1Yr   := IF( NumColBGE3000ClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000ClmWithin2Yr   := IF( NumColBGE3000ClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000ClmWithin3Yr   := IF( NumColBGE3000ClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000ClmWithin4Yr   := IF( NumColBGE3000ClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000ClmWithin5Yr   := IF( NumColBGE3000ClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000CatClmWithin1Yr      := IF( NumColBGE3000CatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000CatClmWithin2Yr      := IF( NumColBGE3000CatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000CatClmWithin3Yr      := IF( NumColBGE3000CatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000CatClmWithin4Yr      := IF( NumColBGE3000CatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000CatClmWithin5Yr      := IF( NumColBGE3000CatClmWithin5Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000NonCatClmWithin1Yr   := IF( NumColBGE3000NonCatClmWithin1Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000NonCatClmWithin2Yr   := IF( NumColBGE3000NonCatClmWithin2Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000NonCatClmWithin3Yr   := IF( NumColBGE3000NonCatClmWithin3Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000NonCatClmWithin4Yr   := IF( NumColBGE3000NonCatClmWithin4Yr >= 1, 1, 0);
ClaimsProperty: => ExistColBGE3000NonCatClmWithin5Yr   := IF( NumColBGE3000NonCatClmWithin5Yr >= 1, 1, 0);


//Group 10

ClaimsProperty: =>  PercentColACatClmWithin1Yr := IF(NumColAClmWithin1Yr > 0 , ROUND(NumColACatClmWithin1Yr/NumColAClmWithin1Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentColACatClmWithin2Yr := IF(NumColAClmWithin2Yr > 0 , ROUND(NumColACatClmWithin2Yr/NumColAClmWithin2Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentColACatClmWithin3Yr := IF(NumColAClmWithin3Yr > 0 , ROUND(NumColACatClmWithin3Yr/NumColAClmWithin3Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentColACatClmWithin4Yr := IF(NumColAClmWithin4Yr > 0 , ROUND(NumColACatClmWithin4Yr/NumColAClmWithin4Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentColACatClmWithin5Yr := IF(NumColAClmWithin5Yr > 0 , ROUND(NumColACatClmWithin5Yr/NumColAClmWithin5Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZColACatClmWithin1Yr := IF(NumNZColAClmWithin1Yr > 0 , ROUND(NumNZColACatClmWithin1Yr/NumNZColAClmWithin1Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZColACatClmWithin2Yr := IF(NumNZColAClmWithin2Yr > 0 , ROUND(NumNZColACatClmWithin2Yr/NumNZColAClmWithin2Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZColACatClmWithin3Yr := IF(NumNZColAClmWithin3Yr > 0 , ROUND(NumNZColACatClmWithin3Yr/NumNZColAClmWithin3Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZColACatClmWithin4Yr := IF(NumNZColAClmWithin4Yr > 0 , ROUND(NumNZColACatClmWithin4Yr/NumNZColAClmWithin4Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZColACatClmWithin5Yr := IF(NumNZColAClmWithin5Yr > 0 , ROUND(NumNZColACatClmWithin5Yr/NumNZColAClmWithin5Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentColBCatClmWithin1Yr := IF(NumColBClmWithin1Yr > 0 , ROUND(NumColBCatClmWithin1Yr/NumColBClmWithin1Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentColBCatClmWithin2Yr := IF(NumColBClmWithin2Yr > 0 , ROUND(NumColBCatClmWithin2Yr/NumColBClmWithin2Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentColBCatClmWithin3Yr := IF(NumColBClmWithin3Yr > 0 , ROUND(NumColBCatClmWithin3Yr/NumColBClmWithin3Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentColBCatClmWithin4Yr := IF(NumColBClmWithin4Yr > 0 , ROUND(NumColBCatClmWithin4Yr/NumColBClmWithin4Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentColBCatClmWithin5Yr := IF(NumColBClmWithin5Yr > 0 , ROUND(NumColBCatClmWithin5Yr/NumColBClmWithin5Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZColBCatClmWithin1Yr := IF(NumNZColBClmWithin1Yr > 0 , ROUND(NumNZColBCatClmWithin1Yr/NumNZColBClmWithin1Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZColBCatClmWithin2Yr := IF(NumNZColBClmWithin2Yr > 0 , ROUND(NumNZColBCatClmWithin2Yr/NumNZColBClmWithin2Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZColBCatClmWithin3Yr := IF(NumNZColBClmWithin3Yr > 0 , ROUND(NumNZColBCatClmWithin3Yr/NumNZColBClmWithin3Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZColBCatClmWithin4Yr := IF(NumNZColBClmWithin4Yr > 0 , ROUND(NumNZColBCatClmWithin4Yr/NumNZColBClmWithin4Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZColBCatClmWithin5Yr := IF(NumNZColBClmWithin5Yr > 0 , ROUND(NumNZColBCatClmWithin5Yr/NumNZColBClmWithin5Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentWeatherCatClmWithin1Yr := IF(NumColAClmWithin1Yr > 0 , ROUND(NumWeatherClmWithin1Yr/NumColAClmWithin1Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentWeatherCatClmWithin2Yr := IF(NumColAClmWithin2Yr > 0 , ROUND(NumWeatherClmWithin2Yr/NumColAClmWithin2Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentWeatherCatClmWithin3Yr := IF(NumColAClmWithin3Yr > 0 , ROUND(NumWeatherClmWithin3Yr/NumColAClmWithin3Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentWeatherCatClmWithin4Yr := IF(NumColAClmWithin4Yr > 0 , ROUND(NumWeatherClmWithin4Yr/NumColAClmWithin4Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentWeatherCatClmWithin5Yr := IF(NumColAClmWithin5Yr > 0 , ROUND(NumWeatherClmWithin5Yr/NumColAClmWithin5Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZWeatherCatClmWithin1Yr := IF(NumNZColAClmWithin1Yr > 0 , ROUND(NumNZWeatherClmWithin1Yr/NumNZColAClmWithin1Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZWeatherCatClmWithin2Yr := IF(NumNZColAClmWithin2Yr > 0 , ROUND(NumNZWeatherClmWithin2Yr/NumNZColAClmWithin2Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZWeatherCatClmWithin3Yr := IF(NumNZColAClmWithin3Yr > 0 , ROUND(NumNZWeatherClmWithin3Yr/NumNZColAClmWithin3Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZWeatherCatClmWithin4Yr := IF(NumNZColAClmWithin4Yr > 0 , ROUND(NumNZWeatherClmWithin4Yr/NumNZColAClmWithin4Yr * 10000)/10000, 0);
ClaimsProperty: =>  PercentNZWeatherCatClmWithin5Yr := IF(NumNZColAClmWithin5Yr > 0 , ROUND(NumNZWeatherClmWithin5Yr/NumNZColAClmWithin5Yr * 10000)/10000, 0);

//CRAFT claims
// ClaimsPropertyClaim: CRAFT_CODE_LIST := ['CRAFT'];
// ClaimsPropertyClaim: => IsCRAFTClaim := EXISTS (Payments(cClaimCatType IN CRAFT_CODE_LIST));
// ClaimsPropertyClaim.Payments: => CRAFTClaimAmount := IF(cClaimCatType = 'CRAFT', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalCRAFTClmAmtTemp := SUM(Payments, CRAFTClaimAmount);

// ClaimsProperty: => NumCRAFTCatClmWithin1Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
// ClaimsProperty: => NumCRAFTCatClmWithin2Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
// ClaimsProperty: => NumCRAFTCatClmWithin3Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
// ClaimsProperty: => NumCRAFTCatClmWithin4Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
// ClaimsProperty: => NumCRAFTCatClmWithin5Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
// ClaimsProperty: => NumNZCRAFTCatClmWithin1Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmt > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
// ClaimsProperty: => NumNZCRAFTCatClmWithin2Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmt > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
// ClaimsProperty: => NumNZCRAFTCatClmWithin3Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmt > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
// ClaimsProperty: => NumNZCRAFTCatClmWithin4Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmt > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
// ClaimsProperty: => NumNZCRAFTCatClmWithin5Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmt > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
// ClaimsProperty: => ExistCRAFTCatClmWithin1Yr := IF( NumCRAFTCatClmWithin1Yr >= 1 , 1, 0);
// ClaimsProperty: => ExistCRAFTCatClmWithin2Yr := IF( NumCRAFTCatClmWithin2Yr >= 1 , 1, 0);
// ClaimsProperty: => ExistCRAFTCatClmWithin3Yr := IF( NumCRAFTCatClmWithin3Yr >= 1 , 1, 0);
// ClaimsProperty: => ExistCRAFTCatClmWithin4Yr := IF( NumCRAFTCatClmWithin4Yr >= 1 , 1, 0);
// ClaimsProperty: => ExistCRAFTCatClmWithin5Yr := IF( NumCRAFTCatClmWithin5Yr >= 1 , 1, 0);
// ClaimsProperty: => ExistNZCRAFTCatClmWithin1Yr := IF( NumNZCRAFTCatClmWithin1Yr >= 1 , 1, 0);
// ClaimsProperty: => ExistNZCRAFTCatClmWithin2Yr := IF( NumNZCRAFTCatClmWithin2Yr >= 1 , 1, 0);
// ClaimsProperty: => ExistNZCRAFTCatClmWithin3Yr := IF( NumNZCRAFTCatClmWithin3Yr >= 1 , 1, 0);
// ClaimsProperty: => ExistNZCRAFTCatClmWithin4Yr := IF( NumNZCRAFTCatClmWithin4Yr >= 1 , 1, 0);
// ClaimsProperty: => ExistNZCRAFTCatClmWithin5Yr := IF( NumNZCRAFTCatClmWithin5Yr >= 1 , 1, 0);
// ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalCRAFTClmAmtTemp);    
// ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalCRAFTClmAmtTemp);    
// ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalCRAFTClmAmtTemp);    
// ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalCRAFTClmAmtTemp);    
// ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalCRAFTClmAmtTemp);    




// ClaimsProperty: => AvgNZCRAFTCatClmAmtWithin1Yr := TotalNZCRAFTCatClmAmtWithin1YrTemp/NumNZCRAFTCatClmWithin1Yr;
// ClaimsProperty: => AvgNZCRAFTCatClmAmtWithin2Yr := TotalNZCRAFTCatClmAmtWithin2YrTemp/NumNZCRAFTCatClmWithin2Yr;
// ClaimsProperty: => AvgNZCRAFTCatClmAmtWithin3Yr := TotalNZCRAFTCatClmAmtWithin3YrTemp/NumNZCRAFTCatClmWithin3Yr;
// ClaimsProperty: => AvgNZCRAFTCatClmAmtWithin4Yr := TotalNZCRAFTCatClmAmtWithin4YrTemp/NumNZCRAFTCatClmWithin4Yr;
// ClaimsProperty: => AvgNZCRAFTCatClmAmtWithin5Yr := TotalNZCRAFTCatClmAmtWithin5YrTemp/NumNZCRAFTCatClmWithin5Yr;
//CRAFT claims
ClaimsPropertyClaim: => TotalClaimAmtComp := SUM(Payments, ClaimCatAmountTmp);
// ClaimsPropertyClaim: CRAFT_CODE_LIST := ['CRAFT'];
ClaimsPropertyClaim: => IsCRAFTClaim := EXISTS (Payments(cClaimCatType IN CRAFT_CODE_LIST));
ClaimsPropertyClaim.Payments: => CRAFTClaimAmount := IF(cClaimCatType = 'CRAFT', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalCRAFTClmAmtTemp := SUM(Payments, CRAFTClaimAmount);

ClaimsProperty: => NumCRAFTCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumCRAFTCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumCRAFTCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumCRAFTCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumCRAFTCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZCRAFTCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZCRAFTCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZCRAFTCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZCRAFTCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZCRAFTCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistCRAFTCatClmWithin1Yr   := IF( NumCRAFTCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCRAFTCatClmWithin2Yr   := IF( NumCRAFTCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCRAFTCatClmWithin3Yr   := IF( NumCRAFTCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCRAFTCatClmWithin4Yr   := IF( NumCRAFTCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCRAFTCatClmWithin5Yr   := IF( NumCRAFTCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCRAFTCatClmWithin1Yr := IF( NumNZCRAFTCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCRAFTCatClmWithin2Yr := IF( NumNZCRAFTCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCRAFTCatClmWithin3Yr := IF( NumNZCRAFTCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCRAFTCatClmWithin4Yr := IF( NumNZCRAFTCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCRAFTCatClmWithin5Yr := IF( NumNZCRAFTCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalCRAFTClmAmtTemp);    
ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalCRAFTClmAmtTemp);    
ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalCRAFTClmAmtTemp);    
ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalCRAFTClmAmtTemp);    
ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalCRAFTClmAmtTemp);    
ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin1Yr := IF(NumCRAFTCatClmWithin1Yr > 0 ,MIN(TotalNZCRAFTCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin2Yr := IF(NumCRAFTCatClmWithin2Yr > 0 ,MIN(TotalNZCRAFTCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin3Yr := IF(NumCRAFTCatClmWithin3Yr > 0 ,MIN(TotalNZCRAFTCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin4Yr := IF(NumCRAFTCatClmWithin4Yr > 0 ,MIN(TotalNZCRAFTCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCRAFTCatClmAmtWithin5Yr := IF(NumCRAFTCatClmWithin5Yr > 0 ,MIN(TotalNZCRAFTCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZCRAFTCatClmAmtWithin1Yr   := IF(NumNZCRAFTCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZCRAFTCatClmAmtWithin1YrTemp/NumNZCRAFTCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCRAFTCatClmAmtWithin2Yr   := IF(NumNZCRAFTCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZCRAFTCatClmAmtWithin2YrTemp/NumNZCRAFTCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCRAFTCatClmAmtWithin3Yr   := IF(NumNZCRAFTCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZCRAFTCatClmAmtWithin3YrTemp/NumNZCRAFTCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCRAFTCatClmAmtWithin4Yr   := IF(NumNZCRAFTCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZCRAFTCatClmAmtWithin4YrTemp/NumNZCRAFTCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCRAFTCatClmAmtWithin5Yr   := IF(NumNZCRAFTCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZCRAFTCatClmAmtWithin5YrTemp/NumNZCRAFTCatClmWithin5Yr), 9999992), 9999999);


//CREDT claims
ClaimsPropertyClaim: CREDT_CODE_LIST := ['CREDT'];
ClaimsPropertyClaim: => IsCREDTClaim := EXISTS (Payments(cClaimCatType IN CREDT_CODE_LIST));
ClaimsPropertyClaim.Payments: => CREDTClaimAmount := IF(cClaimCatType = 'CREDT', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalCREDTClmAmtTemp := SUM(Payments, CREDTClaimAmount);

ClaimsProperty: => NumCREDTCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumCREDTCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumCREDTCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumCREDTCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumCREDTCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZCREDTCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND TotalCREDTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZCREDTCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND TotalCREDTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZCREDTCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND TotalCREDTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZCREDTCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND TotalCREDTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZCREDTCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND TotalCREDTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistCREDTCatClmWithin1Yr   := IF( NumCREDTCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCREDTCatClmWithin2Yr   := IF( NumCREDTCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCREDTCatClmWithin3Yr   := IF( NumCREDTCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCREDTCatClmWithin4Yr   := IF( NumCREDTCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCREDTCatClmWithin5Yr   := IF( NumCREDTCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCREDTCatClmWithin1Yr := IF( NumNZCREDTCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCREDTCatClmWithin2Yr := IF( NumNZCREDTCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCREDTCatClmWithin3Yr := IF( NumNZCREDTCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCREDTCatClmWithin4Yr := IF( NumNZCREDTCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCREDTCatClmWithin5Yr := IF( NumNZCREDTCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZCREDTCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalCREDTClmAmtTemp);    
ClaimsProperty: => TotalNZCREDTCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalCREDTClmAmtTemp);    
ClaimsProperty: => TotalNZCREDTCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalCREDTClmAmtTemp);    
ClaimsProperty: => TotalNZCREDTCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalCREDTClmAmtTemp);    
ClaimsProperty: => TotalNZCREDTCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalCREDTClmAmtTemp);    
ClaimsProperty: => TotalNZCREDTCatClmAmtWithin1Yr := IF(NumCREDTCatClmWithin1Yr > 0 , MIN(TotalNZCREDTCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCREDTCatClmAmtWithin2Yr := IF(NumCREDTCatClmWithin2Yr > 0 , MIN(TotalNZCREDTCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCREDTCatClmAmtWithin3Yr := IF(NumCREDTCatClmWithin3Yr > 0 , MIN(TotalNZCREDTCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCREDTCatClmAmtWithin4Yr := IF(NumCREDTCatClmWithin4Yr > 0 , MIN(TotalNZCREDTCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCREDTCatClmAmtWithin5Yr := IF(NumCREDTCatClmWithin5Yr > 0 , MIN(TotalNZCREDTCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZCREDTCatClmAmtWithin1Yr   := IF(NumNZCREDTCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZCREDTCatClmAmtWithin1YrTemp/NumNZCREDTCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCREDTCatClmAmtWithin2Yr   := IF(NumNZCREDTCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZCREDTCatClmAmtWithin2YrTemp/NumNZCREDTCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCREDTCatClmAmtWithin3Yr   := IF(NumNZCREDTCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZCREDTCatClmAmtWithin3YrTemp/NumNZCREDTCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCREDTCatClmAmtWithin4Yr   := IF(NumNZCREDTCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZCREDTCatClmAmtWithin4YrTemp/NumNZCREDTCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCREDTCatClmAmtWithin5Yr   := IF(NumNZCREDTCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZCREDTCatClmAmtWithin5YrTemp/NumNZCREDTCatClmWithin5Yr), 9999992), 9999999);


//DOG claims
ClaimsPropertyClaim: DOG_CODE_LIST := ['DOG'];
ClaimsPropertyClaim: => IsDOGClaim := EXISTS (Payments(cClaimCatType IN DOG_CODE_LIST));
ClaimsPropertyClaim.Payments: => DOGClaimAmount := IF(cClaimCatType = 'DOG', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalDOGClmAmtTemp := SUM(Payments, DOGClaimAmount);

ClaimsProperty: => NumDOGCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumDOGCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumDOGCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumDOGCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumDOGCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZDOGCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND TotalDOGClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZDOGCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND TotalDOGClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZDOGCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND TotalDOGClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZDOGCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND TotalDOGClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZDOGCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND TotalDOGClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistDOGCatClmWithin1Yr   := IF( NumDOGCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDOGCatClmWithin2Yr   := IF( NumDOGCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDOGCatClmWithin3Yr   := IF( NumDOGCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDOGCatClmWithin4Yr   := IF( NumDOGCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDOGCatClmWithin5Yr   := IF( NumDOGCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDOGCatClmWithin1Yr := IF( NumNZDOGCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDOGCatClmWithin2Yr := IF( NumNZDOGCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDOGCatClmWithin3Yr := IF( NumNZDOGCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDOGCatClmWithin4Yr := IF( NumNZDOGCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDOGCatClmWithin5Yr := IF( NumNZDOGCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZDOGCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalDOGClmAmtTemp);    
ClaimsProperty: => TotalNZDOGCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalDOGClmAmtTemp);    
ClaimsProperty: => TotalNZDOGCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalDOGClmAmtTemp);    
ClaimsProperty: => TotalNZDOGCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalDOGClmAmtTemp);    
ClaimsProperty: => TotalNZDOGCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalDOGClmAmtTemp);    
ClaimsProperty: => TotalNZDOGCatClmAmtWithin1Yr := IF(NumDOGCatClmWithin1Yr > 0 , MIN(TotalNZDOGCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDOGCatClmAmtWithin2Yr := IF(NumDOGCatClmWithin2Yr > 0 , MIN(TotalNZDOGCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDOGCatClmAmtWithin3Yr := IF(NumDOGCatClmWithin3Yr > 0 , MIN(TotalNZDOGCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDOGCatClmAmtWithin4Yr := IF(NumDOGCatClmWithin4Yr > 0 , MIN(TotalNZDOGCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDOGCatClmAmtWithin5Yr := IF(NumDOGCatClmWithin5Yr > 0 , MIN(TotalNZDOGCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZDOGCatClmAmtWithin1Yr   := IF(NumNZDOGCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZDOGCatClmAmtWithin1YrTemp/NumNZDOGCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDOGCatClmAmtWithin2Yr   := IF(NumNZDOGCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZDOGCatClmAmtWithin2YrTemp/NumNZDOGCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDOGCatClmAmtWithin3Yr   := IF(NumNZDOGCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZDOGCatClmAmtWithin3YrTemp/NumNZDOGCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDOGCatClmAmtWithin4Yr   := IF(NumNZDOGCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZDOGCatClmAmtWithin4YrTemp/NumNZDOGCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDOGCatClmAmtWithin5Yr   := IF(NumNZDOGCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZDOGCatClmAmtWithin5YrTemp/NumNZDOGCatClmWithin5Yr), 9999992), 9999999);


//DISAP claims
ClaimsPropertyClaim: DISAP_CODE_LIST := ['DISAP'];
ClaimsPropertyClaim: => IsDISAPClaim := EXISTS (Payments(cClaimCatType IN DISAP_CODE_LIST));
ClaimsPropertyClaim.Payments: => DISAPClaimAmount := IF(cClaimCatType = 'DISAP', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalDISAPClmAmtTemp := SUM(Payments, DISAPClaimAmount);

ClaimsProperty: => NumDISAPCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumDISAPCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumDISAPCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumDISAPCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumDISAPCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZDISAPCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND TotalDISAPClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZDISAPCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND TotalDISAPClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZDISAPCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND TotalDISAPClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZDISAPCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND TotalDISAPClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZDISAPCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND TotalDISAPClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistDISAPCatClmWithin1Yr   := IF( NumDISAPCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISAPCatClmWithin2Yr   := IF( NumDISAPCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISAPCatClmWithin3Yr   := IF( NumDISAPCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISAPCatClmWithin4Yr   := IF( NumDISAPCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISAPCatClmWithin5Yr   := IF( NumDISAPCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISAPCatClmWithin1Yr := IF( NumNZDISAPCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISAPCatClmWithin2Yr := IF( NumNZDISAPCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISAPCatClmWithin3Yr := IF( NumNZDISAPCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISAPCatClmWithin4Yr := IF( NumNZDISAPCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISAPCatClmWithin5Yr := IF( NumNZDISAPCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZDISAPCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalDISAPClmAmtTemp);    
ClaimsProperty: => TotalNZDISAPCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalDISAPClmAmtTemp);    
ClaimsProperty: => TotalNZDISAPCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalDISAPClmAmtTemp);    
ClaimsProperty: => TotalNZDISAPCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalDISAPClmAmtTemp);    
ClaimsProperty: => TotalNZDISAPCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalDISAPClmAmtTemp);    
ClaimsProperty: => TotalNZDISAPCatClmAmtWithin1Yr := IF(NumDISAPCatClmWithin1Yr > 0 , MIN(TotalNZDISAPCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISAPCatClmAmtWithin2Yr := IF(NumDISAPCatClmWithin2Yr > 0 , MIN(TotalNZDISAPCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISAPCatClmAmtWithin3Yr := IF(NumDISAPCatClmWithin3Yr > 0 , MIN(TotalNZDISAPCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISAPCatClmAmtWithin4Yr := IF(NumDISAPCatClmWithin4Yr > 0 , MIN(TotalNZDISAPCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISAPCatClmAmtWithin5Yr := IF(NumDISAPCatClmWithin5Yr > 0 , MIN(TotalNZDISAPCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZDISAPCatClmAmtWithin1Yr   := IF(NumNZDISAPCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZDISAPCatClmAmtWithin1YrTemp/NumNZDISAPCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISAPCatClmAmtWithin2Yr   := IF(NumNZDISAPCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZDISAPCatClmAmtWithin2YrTemp/NumNZDISAPCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISAPCatClmAmtWithin3Yr   := IF(NumNZDISAPCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZDISAPCatClmAmtWithin3YrTemp/NumNZDISAPCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISAPCatClmAmtWithin4Yr   := IF(NumNZDISAPCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZDISAPCatClmAmtWithin4YrTemp/NumNZDISAPCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISAPCatClmAmtWithin5Yr   := IF(NumNZDISAPCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZDISAPCatClmAmtWithin5YrTemp/NumNZDISAPCatClmWithin5Yr), 9999992), 9999999);


//DAMAG claims
ClaimsPropertyClaim: DAMAG_CODE_LIST := ['DAMAG'];
ClaimsPropertyClaim: => IsDAMAGClaim := EXISTS (Payments(cClaimCatType IN DAMAG_CODE_LIST));
ClaimsPropertyClaim.Payments: => DAMAGClaimAmount := IF(cClaimCatType = 'DAMAG', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalDAMAGClmAmtTemp := SUM(Payments, DAMAGClaimAmount);

ClaimsProperty: => NumDAMAGCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumDAMAGCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumDAMAGCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumDAMAGCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumDAMAGCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZDAMAGCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND TotalDAMAGClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZDAMAGCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND TotalDAMAGClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZDAMAGCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND TotalDAMAGClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZDAMAGCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND TotalDAMAGClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZDAMAGCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND TotalDAMAGClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistDAMAGCatClmWithin1Yr   := IF( NumDAMAGCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDAMAGCatClmWithin2Yr   := IF( NumDAMAGCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDAMAGCatClmWithin3Yr   := IF( NumDAMAGCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDAMAGCatClmWithin4Yr   := IF( NumDAMAGCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDAMAGCatClmWithin5Yr   := IF( NumDAMAGCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDAMAGCatClmWithin1Yr := IF( NumNZDAMAGCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDAMAGCatClmWithin2Yr := IF( NumNZDAMAGCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDAMAGCatClmWithin3Yr := IF( NumNZDAMAGCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDAMAGCatClmWithin4Yr := IF( NumNZDAMAGCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDAMAGCatClmWithin5Yr := IF( NumNZDAMAGCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZDAMAGCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalDAMAGClmAmtTemp);    
ClaimsProperty: => TotalNZDAMAGCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalDAMAGClmAmtTemp);    
ClaimsProperty: => TotalNZDAMAGCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalDAMAGClmAmtTemp);    
ClaimsProperty: => TotalNZDAMAGCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalDAMAGClmAmtTemp);    
ClaimsProperty: => TotalNZDAMAGCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalDAMAGClmAmtTemp);    
ClaimsProperty: => TotalNZDAMAGCatClmAmtWithin1Yr := IF(NumDAMAGCatClmWithin1Yr > 0 , MIN(TotalNZDAMAGCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDAMAGCatClmAmtWithin2Yr := IF(NumDAMAGCatClmWithin2Yr > 0 , MIN(TotalNZDAMAGCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDAMAGCatClmAmtWithin3Yr := IF(NumDAMAGCatClmWithin3Yr > 0 , MIN(TotalNZDAMAGCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDAMAGCatClmAmtWithin4Yr := IF(NumDAMAGCatClmWithin4Yr > 0 , MIN(TotalNZDAMAGCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDAMAGCatClmAmtWithin5Yr := IF(NumDAMAGCatClmWithin5Yr > 0 , MIN(TotalNZDAMAGCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZDAMAGCatClmAmtWithin1Yr   := IF(NumNZDAMAGCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZDAMAGCatClmAmtWithin1YrTemp/NumNZDAMAGCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDAMAGCatClmAmtWithin2Yr   := IF(NumNZDAMAGCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZDAMAGCatClmAmtWithin2YrTemp/NumNZDAMAGCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDAMAGCatClmAmtWithin3Yr   := IF(NumNZDAMAGCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZDAMAGCatClmAmtWithin3YrTemp/NumNZDAMAGCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDAMAGCatClmAmtWithin4Yr   := IF(NumNZDAMAGCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZDAMAGCatClmAmtWithin4YrTemp/NumNZDAMAGCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDAMAGCatClmAmtWithin5Yr   := IF(NumNZDAMAGCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZDAMAGCatClmAmtWithin5YrTemp/NumNZDAMAGCatClmWithin5Yr), 9999992), 9999999);


//DISSC claims
ClaimsPropertyClaim: DISSC_CODE_LIST := ['DISSC'];
ClaimsPropertyClaim: => IsDISSCClaim := EXISTS (Payments(cClaimCatType IN DISSC_CODE_LIST));
ClaimsPropertyClaim.Payments: => DISSCClaimAmount := IF(cClaimCatType = 'DISSC', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalDISSCClmAmtTemp := SUM(Payments, DISSCClaimAmount);

ClaimsProperty: => NumDISSCCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumDISSCCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumDISSCCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumDISSCCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumDISSCCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZDISSCCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND TotalDISSCClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZDISSCCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND TotalDISSCClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZDISSCCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND TotalDISSCClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZDISSCCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND TotalDISSCClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZDISSCCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND TotalDISSCClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistDISSCCatClmWithin1Yr   := IF( NumDISSCCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISSCCatClmWithin2Yr   := IF( NumDISSCCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISSCCatClmWithin3Yr   := IF( NumDISSCCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISSCCatClmWithin4Yr   := IF( NumDISSCCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISSCCatClmWithin5Yr   := IF( NumDISSCCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISSCCatClmWithin1Yr := IF( NumNZDISSCCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISSCCatClmWithin2Yr := IF( NumNZDISSCCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISSCCatClmWithin3Yr := IF( NumNZDISSCCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISSCCatClmWithin4Yr := IF( NumNZDISSCCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISSCCatClmWithin5Yr := IF( NumNZDISSCCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZDISSCCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalDISSCClmAmtTemp);    
ClaimsProperty: => TotalNZDISSCCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalDISSCClmAmtTemp);    
ClaimsProperty: => TotalNZDISSCCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalDISSCClmAmtTemp);    
ClaimsProperty: => TotalNZDISSCCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalDISSCClmAmtTemp);    
ClaimsProperty: => TotalNZDISSCCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalDISSCClmAmtTemp);    
ClaimsProperty: => TotalNZDISSCCatClmAmtWithin1Yr := IF(NumDISSCCatClmWithin1Yr > 0 , MIN(TotalNZDISSCCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISSCCatClmAmtWithin2Yr := IF(NumDISSCCatClmWithin2Yr > 0 , MIN(TotalNZDISSCCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISSCCatClmAmtWithin3Yr := IF(NumDISSCCatClmWithin3Yr > 0 , MIN(TotalNZDISSCCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISSCCatClmAmtWithin4Yr := IF(NumDISSCCatClmWithin4Yr > 0 , MIN(TotalNZDISSCCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISSCCatClmAmtWithin5Yr := IF(NumDISSCCatClmWithin5Yr > 0 , MIN(TotalNZDISSCCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZDISSCCatClmAmtWithin1Yr   := IF(NumNZDISSCCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZDISSCCatClmAmtWithin1YrTemp/NumNZDISSCCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISSCCatClmAmtWithin2Yr   := IF(NumNZDISSCCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZDISSCCatClmAmtWithin2YrTemp/NumNZDISSCCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISSCCatClmAmtWithin3Yr   := IF(NumNZDISSCCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZDISSCCatClmAmtWithin3YrTemp/NumNZDISSCCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISSCCatClmAmtWithin4Yr   := IF(NumNZDISSCCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZDISSCCatClmAmtWithin4YrTemp/NumNZDISSCCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISSCCatClmAmtWithin5Yr   := IF(NumNZDISSCCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZDISSCCatClmAmtWithin5YrTemp/NumNZDISSCCatClmWithin5Yr), 9999992), 9999999);


//EXTEN claims
ClaimsPropertyClaim: EXTEN_CODE_LIST := ['EXTEN'];
ClaimsPropertyClaim: => IsEXTENClaim := EXISTS (Payments(cClaimCatType IN EXTEN_CODE_LIST));
ClaimsPropertyClaim.Payments: => EXTENClaimAmount := IF(cClaimCatType = 'EXTEN', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalEXTENClmAmtTemp := SUM(Payments, EXTENClaimAmount);

ClaimsProperty: => NumEXTENCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumEXTENCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumEXTENCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumEXTENCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumEXTENCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZEXTENCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND TotalEXTENClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZEXTENCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND TotalEXTENClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZEXTENCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND TotalEXTENClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZEXTENCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND TotalEXTENClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZEXTENCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND TotalEXTENClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistEXTENCatClmWithin1Yr   := IF( NumEXTENCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistEXTENCatClmWithin2Yr   := IF( NumEXTENCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistEXTENCatClmWithin3Yr   := IF( NumEXTENCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistEXTENCatClmWithin4Yr   := IF( NumEXTENCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistEXTENCatClmWithin5Yr   := IF( NumEXTENCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZEXTENCatClmWithin1Yr := IF( NumNZEXTENCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZEXTENCatClmWithin2Yr := IF( NumNZEXTENCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZEXTENCatClmWithin3Yr := IF( NumNZEXTENCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZEXTENCatClmWithin4Yr := IF( NumNZEXTENCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZEXTENCatClmWithin5Yr := IF( NumNZEXTENCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZEXTENCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalEXTENClmAmtTemp);    
ClaimsProperty: => TotalNZEXTENCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalEXTENClmAmtTemp);    
ClaimsProperty: => TotalNZEXTENCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalEXTENClmAmtTemp);    
ClaimsProperty: => TotalNZEXTENCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalEXTENClmAmtTemp);    
ClaimsProperty: => TotalNZEXTENCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalEXTENClmAmtTemp);    
ClaimsProperty: => TotalNZEXTENCatClmAmtWithin1Yr := IF(NumEXTENCatClmWithin1Yr > 0 , MIN(TotalNZEXTENCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZEXTENCatClmAmtWithin2Yr := IF(NumEXTENCatClmWithin2Yr > 0 , MIN(TotalNZEXTENCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZEXTENCatClmAmtWithin3Yr := IF(NumEXTENCatClmWithin3Yr > 0 , MIN(TotalNZEXTENCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZEXTENCatClmAmtWithin4Yr := IF(NumEXTENCatClmWithin4Yr > 0 , MIN(TotalNZEXTENCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZEXTENCatClmAmtWithin5Yr := IF(NumEXTENCatClmWithin5Yr > 0 , MIN(TotalNZEXTENCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZEXTENCatClmAmtWithin1Yr   := IF(NumNZEXTENCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZEXTENCatClmAmtWithin1YrTemp/NumNZEXTENCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZEXTENCatClmAmtWithin2Yr   := IF(NumNZEXTENCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZEXTENCatClmAmtWithin2YrTemp/NumNZEXTENCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZEXTENCatClmAmtWithin3Yr   := IF(NumNZEXTENCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZEXTENCatClmAmtWithin3YrTemp/NumNZEXTENCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZEXTENCatClmAmtWithin4Yr   := IF(NumNZEXTENCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZEXTENCatClmAmtWithin4YrTemp/NumNZEXTENCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZEXTENCatClmAmtWithin5Yr   := IF(NumNZEXTENCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZEXTENCatClmAmtWithin5YrTemp/NumNZEXTENCatClmWithin5Yr), 9999992), 9999999);


//FIRE claims
ClaimsPropertyClaim: FIRE_CODE_LIST := ['FIRE'];
ClaimsPropertyClaim: => IsFIREClaim := EXISTS (Payments(cClaimCatType IN FIRE_CODE_LIST));
ClaimsPropertyClaim.Payments: => FIREClaimAmount := IF(cClaimCatType = 'FIRE', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalFIREClmAmtTemp := SUM(Payments, FIREClaimAmount);

ClaimsProperty: => NumFIRECatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumFIRECatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumFIRECatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumFIRECatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumFIRECatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZFIRECatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND TotalFIREClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZFIRECatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND TotalFIREClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZFIRECatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND TotalFIREClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZFIRECatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND TotalFIREClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZFIRECatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND TotalFIREClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistFIRECatClmWithin1Yr   := IF( NumFIRECatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFIRECatClmWithin2Yr   := IF( NumFIRECatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFIRECatClmWithin3Yr   := IF( NumFIRECatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFIRECatClmWithin4Yr   := IF( NumFIRECatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFIRECatClmWithin5Yr   := IF( NumFIRECatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFIRECatClmWithin1Yr := IF( NumNZFIRECatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFIRECatClmWithin2Yr := IF( NumNZFIRECatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFIRECatClmWithin3Yr := IF( NumNZFIRECatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFIRECatClmWithin4Yr := IF( NumNZFIRECatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFIRECatClmWithin5Yr := IF( NumNZFIRECatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZFIRECatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalFIREClmAmtTemp);    
ClaimsProperty: => TotalNZFIRECatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalFIREClmAmtTemp);    
ClaimsProperty: => TotalNZFIRECatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalFIREClmAmtTemp);    
ClaimsProperty: => TotalNZFIRECatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalFIREClmAmtTemp);    
ClaimsProperty: => TotalNZFIRECatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalFIREClmAmtTemp);    
ClaimsProperty: => TotalNZFIRECatClmAmtWithin1Yr := IF(NumFIRECatClmWithin1Yr > 0 , MIN(TotalNZFIRECatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFIRECatClmAmtWithin2Yr := IF(NumFIRECatClmWithin2Yr > 0 , MIN(TotalNZFIRECatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFIRECatClmAmtWithin3Yr := IF(NumFIRECatClmWithin3Yr > 0 , MIN(TotalNZFIRECatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFIRECatClmAmtWithin4Yr := IF(NumFIRECatClmWithin4Yr > 0 , MIN(TotalNZFIRECatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFIRECatClmAmtWithin5Yr := IF(NumFIRECatClmWithin5Yr > 0 , MIN(TotalNZFIRECatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZFIRECatClmAmtWithin1Yr   := IF(NumNZFIRECatClmWithin1Yr > 0 , MIN(ROUND(TotalNZFIRECatClmAmtWithin1YrTemp/NumNZFIRECatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFIRECatClmAmtWithin2Yr   := IF(NumNZFIRECatClmWithin2Yr > 0 , MIN(ROUND(TotalNZFIRECatClmAmtWithin2YrTemp/NumNZFIRECatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFIRECatClmAmtWithin3Yr   := IF(NumNZFIRECatClmWithin3Yr > 0 , MIN(ROUND(TotalNZFIRECatClmAmtWithin3YrTemp/NumNZFIRECatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFIRECatClmAmtWithin4Yr   := IF(NumNZFIRECatClmWithin4Yr > 0 , MIN(ROUND(TotalNZFIRECatClmAmtWithin4YrTemp/NumNZFIRECatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFIRECatClmAmtWithin5Yr   := IF(NumNZFIRECatClmWithin5Yr > 0 , MIN(ROUND(TotalNZFIRECatClmAmtWithin5YrTemp/NumNZFIRECatClmWithin5Yr), 9999992), 9999999);


//FREEZ claims
ClaimsPropertyClaim: FREEZ_CODE_LIST := ['FREEZ'];
ClaimsPropertyClaim: => IsFREEZClaim := EXISTS (Payments(cClaimCatType IN FREEZ_CODE_LIST));
ClaimsPropertyClaim.Payments: => FREEZClaimAmount := IF(cClaimCatType = 'FREEZ', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalFREEZClmAmtTemp := SUM(Payments, FREEZClaimAmount);

ClaimsProperty: => NumFREEZCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumFREEZCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumFREEZCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumFREEZCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumFREEZCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZFREEZCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND TotalFREEZClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZFREEZCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND TotalFREEZClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZFREEZCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND TotalFREEZClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZFREEZCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND TotalFREEZClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZFREEZCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND TotalFREEZClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistFREEZCatClmWithin1Yr   := IF( NumFREEZCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFREEZCatClmWithin2Yr   := IF( NumFREEZCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFREEZCatClmWithin3Yr   := IF( NumFREEZCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFREEZCatClmWithin4Yr   := IF( NumFREEZCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFREEZCatClmWithin5Yr   := IF( NumFREEZCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFREEZCatClmWithin1Yr := IF( NumNZFREEZCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFREEZCatClmWithin2Yr := IF( NumNZFREEZCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFREEZCatClmWithin3Yr := IF( NumNZFREEZCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFREEZCatClmWithin4Yr := IF( NumNZFREEZCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFREEZCatClmWithin5Yr := IF( NumNZFREEZCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZFREEZCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalFREEZClmAmtTemp);    
ClaimsProperty: => TotalNZFREEZCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalFREEZClmAmtTemp);    
ClaimsProperty: => TotalNZFREEZCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalFREEZClmAmtTemp);    
ClaimsProperty: => TotalNZFREEZCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalFREEZClmAmtTemp);    
ClaimsProperty: => TotalNZFREEZCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalFREEZClmAmtTemp);    
ClaimsProperty: => TotalNZFREEZCatClmAmtWithin1Yr := IF(NumFREEZCatClmWithin1Yr > 0 , MIN(TotalNZFREEZCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFREEZCatClmAmtWithin2Yr := IF(NumFREEZCatClmWithin2Yr > 0 , MIN(TotalNZFREEZCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFREEZCatClmAmtWithin3Yr := IF(NumFREEZCatClmWithin3Yr > 0 , MIN(TotalNZFREEZCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFREEZCatClmAmtWithin4Yr := IF(NumFREEZCatClmWithin4Yr > 0 , MIN(TotalNZFREEZCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFREEZCatClmAmtWithin5Yr := IF(NumFREEZCatClmWithin5Yr > 0 , MIN(TotalNZFREEZCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZFREEZCatClmAmtWithin1Yr   := IF(NumNZFREEZCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZFREEZCatClmAmtWithin1YrTemp/NumNZFREEZCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFREEZCatClmAmtWithin2Yr   := IF(NumNZFREEZCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZFREEZCatClmAmtWithin2YrTemp/NumNZFREEZCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFREEZCatClmAmtWithin3Yr   := IF(NumNZFREEZCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZFREEZCatClmAmtWithin3YrTemp/NumNZFREEZCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFREEZCatClmAmtWithin4Yr   := IF(NumNZFREEZCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZFREEZCatClmAmtWithin4YrTemp/NumNZFREEZCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFREEZCatClmAmtWithin5Yr   := IF(NumNZFREEZCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZFREEZCatClmAmtWithin5YrTemp/NumNZFREEZCatClmWithin5Yr), 9999992), 9999999);


//HAIL claims
ClaimsPropertyClaim: HAIL_CODE_LIST := ['HAIL'];
ClaimsPropertyClaim: => IsHAILClaim := EXISTS (Payments(cClaimCatType IN HAIL_CODE_LIST));
ClaimsPropertyClaim.Payments: => HAILClaimAmount := IF(cClaimCatType = 'HAIL', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalHAILClmAmtTemp := SUM(Payments, HAILClaimAmount);

ClaimsProperty: => NumHAILCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumHAILCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumHAILCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumHAILCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumHAILCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZHAILCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND TotalHAILClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZHAILCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND TotalHAILClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZHAILCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND TotalHAILClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZHAILCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND TotalHAILClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZHAILCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND TotalHAILClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistHAILCatClmWithin1Yr   := IF( NumHAILCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistHAILCatClmWithin2Yr   := IF( NumHAILCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistHAILCatClmWithin3Yr   := IF( NumHAILCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistHAILCatClmWithin4Yr   := IF( NumHAILCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistHAILCatClmWithin5Yr   := IF( NumHAILCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZHAILCatClmWithin1Yr := IF( NumNZHAILCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZHAILCatClmWithin2Yr := IF( NumNZHAILCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZHAILCatClmWithin3Yr := IF( NumNZHAILCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZHAILCatClmWithin4Yr := IF( NumNZHAILCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZHAILCatClmWithin5Yr := IF( NumNZHAILCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZHAILCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalHAILClmAmtTemp);    
ClaimsProperty: => TotalNZHAILCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalHAILClmAmtTemp);    
ClaimsProperty: => TotalNZHAILCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalHAILClmAmtTemp);    
ClaimsProperty: => TotalNZHAILCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalHAILClmAmtTemp);    
ClaimsProperty: => TotalNZHAILCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalHAILClmAmtTemp);    
ClaimsProperty: => TotalNZHAILCatClmAmtWithin1Yr := IF(NumHAILCatClmWithin1Yr > 0 , MIN(TotalNZHAILCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZHAILCatClmAmtWithin2Yr := IF(NumHAILCatClmWithin2Yr > 0 , MIN(TotalNZHAILCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZHAILCatClmAmtWithin3Yr := IF(NumHAILCatClmWithin3Yr > 0 , MIN(TotalNZHAILCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZHAILCatClmAmtWithin4Yr := IF(NumHAILCatClmWithin4Yr > 0 , MIN(TotalNZHAILCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZHAILCatClmAmtWithin5Yr := IF(NumHAILCatClmWithin5Yr > 0 , MIN(TotalNZHAILCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZHAILCatClmAmtWithin1Yr   := IF(NumNZHAILCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZHAILCatClmAmtWithin1YrTemp/NumNZHAILCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZHAILCatClmAmtWithin2Yr   := IF(NumNZHAILCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZHAILCatClmAmtWithin2YrTemp/NumNZHAILCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZHAILCatClmAmtWithin3Yr   := IF(NumNZHAILCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZHAILCatClmAmtWithin3YrTemp/NumNZHAILCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZHAILCatClmAmtWithin4Yr   := IF(NumNZHAILCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZHAILCatClmAmtWithin4YrTemp/NumNZHAILCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZHAILCatClmAmtWithin5Yr   := IF(NumNZHAILCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZHAILCatClmAmtWithin5YrTemp/NumNZHAILCatClmWithin5Yr), 9999992), 9999999);


//LIAB claims
ClaimsPropertyClaim: LIAB_CODE_LIST := ['LIAB'];
ClaimsPropertyClaim: => IsLIABClaim := EXISTS (Payments(cClaimCatType IN LIAB_CODE_LIST));
ClaimsPropertyClaim.Payments: => LIABClaimAmount := IF(cClaimCatType = 'LIAB', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalLIABClmAmtTemp := SUM(Payments, LIABClaimAmount);

ClaimsProperty: => NumLIABCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumLIABCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumLIABCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumLIABCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumLIABCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZLIABCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND TotalLIABClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZLIABCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND TotalLIABClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZLIABCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND TotalLIABClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZLIABCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND TotalLIABClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZLIABCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND TotalLIABClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistLIABCatClmWithin1Yr   := IF( NumLIABCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIABCatClmWithin2Yr   := IF( NumLIABCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIABCatClmWithin3Yr   := IF( NumLIABCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIABCatClmWithin4Yr   := IF( NumLIABCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIABCatClmWithin5Yr   := IF( NumLIABCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIABCatClmWithin1Yr := IF( NumNZLIABCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIABCatClmWithin2Yr := IF( NumNZLIABCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIABCatClmWithin3Yr := IF( NumNZLIABCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIABCatClmWithin4Yr := IF( NumNZLIABCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIABCatClmWithin5Yr := IF( NumNZLIABCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZLIABCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalLIABClmAmtTemp);    
ClaimsProperty: => TotalNZLIABCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalLIABClmAmtTemp);    
ClaimsProperty: => TotalNZLIABCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalLIABClmAmtTemp);    
ClaimsProperty: => TotalNZLIABCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalLIABClmAmtTemp);    
ClaimsProperty: => TotalNZLIABCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalLIABClmAmtTemp);    
ClaimsProperty: => TotalNZLIABCatClmAmtWithin1Yr := IF(NumLIABCatClmWithin1Yr > 0 , MIN(TotalNZLIABCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIABCatClmAmtWithin2Yr := IF(NumLIABCatClmWithin2Yr > 0 , MIN(TotalNZLIABCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIABCatClmAmtWithin3Yr := IF(NumLIABCatClmWithin3Yr > 0 , MIN(TotalNZLIABCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIABCatClmAmtWithin4Yr := IF(NumLIABCatClmWithin4Yr > 0 , MIN(TotalNZLIABCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIABCatClmAmtWithin5Yr := IF(NumLIABCatClmWithin5Yr > 0 , MIN(TotalNZLIABCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZLIABCatClmAmtWithin1Yr   := IF(NumNZLIABCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZLIABCatClmAmtWithin1YrTemp/NumNZLIABCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIABCatClmAmtWithin2Yr   := IF(NumNZLIABCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZLIABCatClmAmtWithin2YrTemp/NumNZLIABCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIABCatClmAmtWithin3Yr   := IF(NumNZLIABCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZLIABCatClmAmtWithin3YrTemp/NumNZLIABCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIABCatClmAmtWithin4Yr   := IF(NumNZLIABCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZLIABCatClmAmtWithin4YrTemp/NumNZLIABCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIABCatClmAmtWithin5Yr   := IF(NumNZLIABCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZLIABCatClmAmtWithin5YrTemp/NumNZLIABCatClmWithin5Yr), 9999992), 9999999);


//LIGHT claims
ClaimsPropertyClaim: LIGHT_CODE_LIST := ['LIGHT'];
ClaimsPropertyClaim: => IsLIGHTClaim := EXISTS (Payments(cClaimCatType IN LIGHT_CODE_LIST));
ClaimsPropertyClaim.Payments: => LIGHTClaimAmount := IF(cClaimCatType = 'LIGHT', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalLIGHTClmAmtTemp := SUM(Payments, LIGHTClaimAmount);

ClaimsProperty: => NumLIGHTCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumLIGHTCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumLIGHTCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumLIGHTCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumLIGHTCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZLIGHTCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND TotalLIGHTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZLIGHTCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND TotalLIGHTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZLIGHTCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND TotalLIGHTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZLIGHTCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND TotalLIGHTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZLIGHTCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND TotalLIGHTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistLIGHTCatClmWithin1Yr   := IF( NumLIGHTCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIGHTCatClmWithin2Yr   := IF( NumLIGHTCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIGHTCatClmWithin3Yr   := IF( NumLIGHTCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIGHTCatClmWithin4Yr   := IF( NumLIGHTCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIGHTCatClmWithin5Yr   := IF( NumLIGHTCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIGHTCatClmWithin1Yr := IF( NumNZLIGHTCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIGHTCatClmWithin2Yr := IF( NumNZLIGHTCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIGHTCatClmWithin3Yr := IF( NumNZLIGHTCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIGHTCatClmWithin4Yr := IF( NumNZLIGHTCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIGHTCatClmWithin5Yr := IF( NumNZLIGHTCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZLIGHTCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalLIGHTClmAmtTemp);    
ClaimsProperty: => TotalNZLIGHTCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalLIGHTClmAmtTemp);    
ClaimsProperty: => TotalNZLIGHTCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalLIGHTClmAmtTemp);    
ClaimsProperty: => TotalNZLIGHTCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalLIGHTClmAmtTemp);    
ClaimsProperty: => TotalNZLIGHTCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalLIGHTClmAmtTemp);    
ClaimsProperty: => TotalNZLIGHTCatClmAmtWithin1Yr := IF(NumLIGHTCatClmWithin1Yr > 0 , MIN(TotalNZLIGHTCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIGHTCatClmAmtWithin2Yr := IF(NumLIGHTCatClmWithin2Yr > 0 , MIN(TotalNZLIGHTCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIGHTCatClmAmtWithin3Yr := IF(NumLIGHTCatClmWithin3Yr > 0 , MIN(TotalNZLIGHTCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIGHTCatClmAmtWithin4Yr := IF(NumLIGHTCatClmWithin4Yr > 0 , MIN(TotalNZLIGHTCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIGHTCatClmAmtWithin5Yr := IF(NumLIGHTCatClmWithin5Yr > 0 , MIN(TotalNZLIGHTCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZLIGHTCatClmAmtWithin1Yr   := IF(NumNZLIGHTCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZLIGHTCatClmAmtWithin1YrTemp/NumNZLIGHTCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIGHTCatClmAmtWithin2Yr   := IF(NumNZLIGHTCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZLIGHTCatClmAmtWithin2YrTemp/NumNZLIGHTCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIGHTCatClmAmtWithin3Yr   := IF(NumNZLIGHTCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZLIGHTCatClmAmtWithin3YrTemp/NumNZLIGHTCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIGHTCatClmAmtWithin4Yr   := IF(NumNZLIGHTCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZLIGHTCatClmAmtWithin4YrTemp/NumNZLIGHTCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIGHTCatClmAmtWithin5Yr   := IF(NumNZLIGHTCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZLIGHTCatClmAmtWithin5YrTemp/NumNZLIGHTCatClmWithin5Yr), 9999992), 9999999);


//MEDIC claims
ClaimsPropertyClaim: MEDIC_CODE_LIST := ['MEDIC'];
ClaimsPropertyClaim: => IsMEDICClaim := EXISTS (Payments(cClaimCatType IN MEDIC_CODE_LIST));
ClaimsPropertyClaim.Payments: => MEDICClaimAmount := IF(cClaimCatType = 'MEDIC', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalMEDICClmAmtTemp := SUM(Payments, MEDICClaimAmount);

ClaimsProperty: => NumMEDICCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumMEDICCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumMEDICCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumMEDICCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumMEDICCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZMEDICCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND TotalMEDICClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZMEDICCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND TotalMEDICClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZMEDICCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND TotalMEDICClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZMEDICCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND TotalMEDICClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZMEDICCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND TotalMEDICClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistMEDICCatClmWithin1Yr   := IF( NumMEDICCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMEDICCatClmWithin2Yr   := IF( NumMEDICCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMEDICCatClmWithin3Yr   := IF( NumMEDICCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMEDICCatClmWithin4Yr   := IF( NumMEDICCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMEDICCatClmWithin5Yr   := IF( NumMEDICCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMEDICCatClmWithin1Yr := IF( NumNZMEDICCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMEDICCatClmWithin2Yr := IF( NumNZMEDICCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMEDICCatClmWithin3Yr := IF( NumNZMEDICCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMEDICCatClmWithin4Yr := IF( NumNZMEDICCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMEDICCatClmWithin5Yr := IF( NumNZMEDICCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZMEDICCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalMEDICClmAmtTemp);    
ClaimsProperty: => TotalNZMEDICCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalMEDICClmAmtTemp);    
ClaimsProperty: => TotalNZMEDICCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalMEDICClmAmtTemp);    
ClaimsProperty: => TotalNZMEDICCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalMEDICClmAmtTemp);    
ClaimsProperty: => TotalNZMEDICCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalMEDICClmAmtTemp);    
ClaimsProperty: => TotalNZMEDICCatClmAmtWithin1Yr := IF(NumMEDICCatClmWithin1Yr > 0 , MIN(TotalNZMEDICCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMEDICCatClmAmtWithin2Yr := IF(NumMEDICCatClmWithin2Yr > 0 , MIN(TotalNZMEDICCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMEDICCatClmAmtWithin3Yr := IF(NumMEDICCatClmWithin3Yr > 0 , MIN(TotalNZMEDICCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMEDICCatClmAmtWithin4Yr := IF(NumMEDICCatClmWithin4Yr > 0 , MIN(TotalNZMEDICCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMEDICCatClmAmtWithin5Yr := IF(NumMEDICCatClmWithin5Yr > 0 , MIN(TotalNZMEDICCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZMEDICCatClmAmtWithin1Yr   := IF(NumNZMEDICCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZMEDICCatClmAmtWithin1YrTemp/NumNZMEDICCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMEDICCatClmAmtWithin2Yr   := IF(NumNZMEDICCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZMEDICCatClmAmtWithin2YrTemp/NumNZMEDICCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMEDICCatClmAmtWithin3Yr   := IF(NumNZMEDICCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZMEDICCatClmAmtWithin3YrTemp/NumNZMEDICCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMEDICCatClmAmtWithin4Yr   := IF(NumNZMEDICCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZMEDICCatClmAmtWithin4YrTemp/NumNZMEDICCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMEDICCatClmAmtWithin5Yr   := IF(NumNZMEDICCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZMEDICCatClmAmtWithin5YrTemp/NumNZMEDICCatClmWithin5Yr), 9999992), 9999999);


//MOVE claims
ClaimsPropertyClaim: MOVE_CODE_LIST := ['MOVE'];
ClaimsPropertyClaim: => IsMOVEClaim := EXISTS (Payments(cClaimCatType IN MOVE_CODE_LIST));
ClaimsPropertyClaim.Payments: => MOVEClaimAmount := IF(cClaimCatType = 'MOVE', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalMOVEClmAmtTemp := SUM(Payments, MOVEClaimAmount);

ClaimsProperty: => NumMOVECatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumMOVECatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumMOVECatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumMOVECatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumMOVECatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZMOVECatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND TotalMOVEClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZMOVECatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND TotalMOVEClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZMOVECatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND TotalMOVEClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZMOVECatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND TotalMOVEClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZMOVECatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND TotalMOVEClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistMOVECatClmWithin1Yr   := IF( NumMOVECatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMOVECatClmWithin2Yr   := IF( NumMOVECatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMOVECatClmWithin3Yr   := IF( NumMOVECatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMOVECatClmWithin4Yr   := IF( NumMOVECatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMOVECatClmWithin5Yr   := IF( NumMOVECatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMOVECatClmWithin1Yr := IF( NumNZMOVECatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMOVECatClmWithin2Yr := IF( NumNZMOVECatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMOVECatClmWithin3Yr := IF( NumNZMOVECatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMOVECatClmWithin4Yr := IF( NumNZMOVECatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMOVECatClmWithin5Yr := IF( NumNZMOVECatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZMOVECatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalMOVEClmAmtTemp);    
ClaimsProperty: => TotalNZMOVECatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalMOVEClmAmtTemp);    
ClaimsProperty: => TotalNZMOVECatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalMOVEClmAmtTemp);    
ClaimsProperty: => TotalNZMOVECatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalMOVEClmAmtTemp);    
ClaimsProperty: => TotalNZMOVECatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalMOVEClmAmtTemp);    
ClaimsProperty: => TotalNZMOVECatClmAmtWithin1Yr := IF(NumMOVECatClmWithin1Yr > 0 , MIN(TotalNZMOVECatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMOVECatClmAmtWithin2Yr := IF(NumMOVECatClmWithin2Yr > 0 , MIN(TotalNZMOVECatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMOVECatClmAmtWithin3Yr := IF(NumMOVECatClmWithin3Yr > 0 , MIN(TotalNZMOVECatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMOVECatClmAmtWithin4Yr := IF(NumMOVECatClmWithin4Yr > 0 , MIN(TotalNZMOVECatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMOVECatClmAmtWithin5Yr := IF(NumMOVECatClmWithin5Yr > 0 , MIN(TotalNZMOVECatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZMOVECatClmAmtWithin1Yr   := IF(NumNZMOVECatClmWithin1Yr > 0 , MIN(ROUND(TotalNZMOVECatClmAmtWithin1YrTemp/NumNZMOVECatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMOVECatClmAmtWithin2Yr   := IF(NumNZMOVECatClmWithin2Yr > 0 , MIN(ROUND(TotalNZMOVECatClmAmtWithin2YrTemp/NumNZMOVECatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMOVECatClmAmtWithin3Yr   := IF(NumNZMOVECatClmWithin3Yr > 0 , MIN(ROUND(TotalNZMOVECatClmAmtWithin3YrTemp/NumNZMOVECatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMOVECatClmAmtWithin4Yr   := IF(NumNZMOVECatClmWithin4Yr > 0 , MIN(ROUND(TotalNZMOVECatClmAmtWithin4YrTemp/NumNZMOVECatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMOVECatClmAmtWithin5Yr   := IF(NumNZMOVECatClmWithin5Yr > 0 , MIN(ROUND(TotalNZMOVECatClmAmtWithin5YrTemp/NumNZMOVECatClmWithin5Yr), 9999992), 9999999);


//OTHER claims
ClaimsPropertyClaim: OTHER_CODE_LIST := ['OTHER'];
ClaimsPropertyClaim: => IsOTHERClaim := EXISTS (Payments(cClaimCatType IN OTHER_CODE_LIST));
ClaimsPropertyClaim.Payments: => OTHERClaimAmount := IF(cClaimCatType = 'OTHER', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalOTHERClmAmtTemp := SUM(Payments, OTHERClaimAmount);

ClaimsProperty: => NumOTHERCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumOTHERCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumOTHERCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumOTHERCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumOTHERCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZOTHERCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND TotalOTHERClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZOTHERCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND TotalOTHERClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZOTHERCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND TotalOTHERClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZOTHERCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND TotalOTHERClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZOTHERCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND TotalOTHERClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistOTHERCatClmWithin1Yr   := IF( NumOTHERCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistOTHERCatClmWithin2Yr   := IF( NumOTHERCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistOTHERCatClmWithin3Yr   := IF( NumOTHERCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistOTHERCatClmWithin4Yr   := IF( NumOTHERCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistOTHERCatClmWithin5Yr   := IF( NumOTHERCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZOTHERCatClmWithin1Yr := IF( NumNZOTHERCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZOTHERCatClmWithin2Yr := IF( NumNZOTHERCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZOTHERCatClmWithin3Yr := IF( NumNZOTHERCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZOTHERCatClmWithin4Yr := IF( NumNZOTHERCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZOTHERCatClmWithin5Yr := IF( NumNZOTHERCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZOTHERCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalOTHERClmAmtTemp);    
ClaimsProperty: => TotalNZOTHERCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalOTHERClmAmtTemp);    
ClaimsProperty: => TotalNZOTHERCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalOTHERClmAmtTemp);    
ClaimsProperty: => TotalNZOTHERCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalOTHERClmAmtTemp);    
ClaimsProperty: => TotalNZOTHERCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalOTHERClmAmtTemp);    
ClaimsProperty: => TotalNZOTHERCatClmAmtWithin1Yr := IF(NumOTHERCatClmWithin1Yr > 0 , MIN(TotalNZOTHERCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZOTHERCatClmAmtWithin2Yr := IF(NumOTHERCatClmWithin2Yr > 0 , MIN(TotalNZOTHERCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZOTHERCatClmAmtWithin3Yr := IF(NumOTHERCatClmWithin3Yr > 0 , MIN(TotalNZOTHERCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZOTHERCatClmAmtWithin4Yr := IF(NumOTHERCatClmWithin4Yr > 0 , MIN(TotalNZOTHERCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZOTHERCatClmAmtWithin5Yr := IF(NumOTHERCatClmWithin5Yr > 0 , MIN(TotalNZOTHERCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZOTHERCatClmAmtWithin1Yr   := IF(NumNZOTHERCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZOTHERCatClmAmtWithin1YrTemp/NumNZOTHERCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZOTHERCatClmAmtWithin2Yr   := IF(NumNZOTHERCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZOTHERCatClmAmtWithin2YrTemp/NumNZOTHERCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZOTHERCatClmAmtWithin3Yr   := IF(NumNZOTHERCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZOTHERCatClmAmtWithin3YrTemp/NumNZOTHERCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZOTHERCatClmAmtWithin4Yr   := IF(NumNZOTHERCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZOTHERCatClmAmtWithin4YrTemp/NumNZOTHERCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZOTHERCatClmAmtWithin5Yr   := IF(NumNZOTHERCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZOTHERCatClmAmtWithin5YrTemp/NumNZOTHERCatClmWithin5Yr), 9999992), 9999999);


//PHYDA claims
ClaimsPropertyClaim: PHYDA_CODE_LIST := ['PHYDA'];
ClaimsPropertyClaim: => IsPHYDAClaim := EXISTS (Payments(cClaimCatType IN PHYDA_CODE_LIST));
ClaimsPropertyClaim.Payments: => PHYDAClaimAmount := IF(cClaimCatType = 'PHYDA', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalPHYDAClmAmtTemp := SUM(Payments, PHYDAClaimAmount);

ClaimsProperty: => NumPHYDACatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumPHYDACatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumPHYDACatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumPHYDACatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumPHYDACatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZPHYDACatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND TotalPHYDAClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZPHYDACatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND TotalPHYDAClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZPHYDACatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND TotalPHYDAClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZPHYDACatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND TotalPHYDAClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZPHYDACatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND TotalPHYDAClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistPHYDACatClmWithin1Yr   := IF( NumPHYDACatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistPHYDACatClmWithin2Yr   := IF( NumPHYDACatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistPHYDACatClmWithin3Yr   := IF( NumPHYDACatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistPHYDACatClmWithin4Yr   := IF( NumPHYDACatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistPHYDACatClmWithin5Yr   := IF( NumPHYDACatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZPHYDACatClmWithin1Yr := IF( NumNZPHYDACatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZPHYDACatClmWithin2Yr := IF( NumNZPHYDACatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZPHYDACatClmWithin3Yr := IF( NumNZPHYDACatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZPHYDACatClmWithin4Yr := IF( NumNZPHYDACatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZPHYDACatClmWithin5Yr := IF( NumNZPHYDACatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZPHYDACatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalPHYDAClmAmtTemp);    
ClaimsProperty: => TotalNZPHYDACatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalPHYDAClmAmtTemp);    
ClaimsProperty: => TotalNZPHYDACatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalPHYDAClmAmtTemp);    
ClaimsProperty: => TotalNZPHYDACatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalPHYDAClmAmtTemp);    
ClaimsProperty: => TotalNZPHYDACatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalPHYDAClmAmtTemp);    
ClaimsProperty: => TotalNZPHYDACatClmAmtWithin1Yr := IF(NumPHYDACatClmWithin1Yr > 0 , MIN(TotalNZPHYDACatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZPHYDACatClmAmtWithin2Yr := IF(NumPHYDACatClmWithin2Yr > 0 , MIN(TotalNZPHYDACatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZPHYDACatClmAmtWithin3Yr := IF(NumPHYDACatClmWithin3Yr > 0 , MIN(TotalNZPHYDACatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZPHYDACatClmAmtWithin4Yr := IF(NumPHYDACatClmWithin4Yr > 0 , MIN(TotalNZPHYDACatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZPHYDACatClmAmtWithin5Yr := IF(NumPHYDACatClmWithin5Yr > 0 , MIN(TotalNZPHYDACatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZPHYDACatClmAmtWithin1Yr   := IF(NumNZPHYDACatClmWithin1Yr > 0 , MIN(ROUND(TotalNZPHYDACatClmAmtWithin1YrTemp/NumNZPHYDACatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZPHYDACatClmAmtWithin2Yr   := IF(NumNZPHYDACatClmWithin2Yr > 0 , MIN(ROUND(TotalNZPHYDACatClmAmtWithin2YrTemp/NumNZPHYDACatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZPHYDACatClmAmtWithin3Yr   := IF(NumNZPHYDACatClmWithin3Yr > 0 , MIN(ROUND(TotalNZPHYDACatClmAmtWithin3YrTemp/NumNZPHYDACatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZPHYDACatClmAmtWithin4Yr   := IF(NumNZPHYDACatClmWithin4Yr > 0 , MIN(ROUND(TotalNZPHYDACatClmAmtWithin4YrTemp/NumNZPHYDACatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZPHYDACatClmAmtWithin5Yr   := IF(NumNZPHYDACatClmWithin5Yr > 0 , MIN(ROUND(TotalNZPHYDACatClmAmtWithin5YrTemp/NumNZPHYDACatClmWithin5Yr), 9999992), 9999999);


//SLIP claims
ClaimsPropertyClaim: SLIP_CODE_LIST := ['SLIP'];
ClaimsPropertyClaim: => IsSLIPClaim := EXISTS (Payments(cClaimCatType IN SLIP_CODE_LIST));
ClaimsPropertyClaim.Payments: => SLIPClaimAmount := IF(cClaimCatType = 'SLIP', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalSLIPClmAmtTemp := SUM(Payments, SLIPClaimAmount);

ClaimsProperty: => NumSLIPCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumSLIPCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumSLIPCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumSLIPCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumSLIPCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZSLIPCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND TotalSLIPClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZSLIPCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND TotalSLIPClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZSLIPCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND TotalSLIPClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZSLIPCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND TotalSLIPClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZSLIPCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND TotalSLIPClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistSLIPCatClmWithin1Yr   := IF( NumSLIPCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSLIPCatClmWithin2Yr   := IF( NumSLIPCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSLIPCatClmWithin3Yr   := IF( NumSLIPCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSLIPCatClmWithin4Yr   := IF( NumSLIPCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSLIPCatClmWithin5Yr   := IF( NumSLIPCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSLIPCatClmWithin1Yr := IF( NumNZSLIPCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSLIPCatClmWithin2Yr := IF( NumNZSLIPCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSLIPCatClmWithin3Yr := IF( NumNZSLIPCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSLIPCatClmWithin4Yr := IF( NumNZSLIPCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSLIPCatClmWithin5Yr := IF( NumNZSLIPCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZSLIPCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalSLIPClmAmtTemp);    
ClaimsProperty: => TotalNZSLIPCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalSLIPClmAmtTemp);    
ClaimsProperty: => TotalNZSLIPCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalSLIPClmAmtTemp);    
ClaimsProperty: => TotalNZSLIPCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalSLIPClmAmtTemp);    
ClaimsProperty: => TotalNZSLIPCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalSLIPClmAmtTemp);    
ClaimsProperty: => TotalNZSLIPCatClmAmtWithin1Yr := IF(NumSLIPCatClmWithin1Yr > 0 , MIN(TotalNZSLIPCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSLIPCatClmAmtWithin2Yr := IF(NumSLIPCatClmWithin2Yr > 0 , MIN(TotalNZSLIPCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSLIPCatClmAmtWithin3Yr := IF(NumSLIPCatClmWithin3Yr > 0 , MIN(TotalNZSLIPCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSLIPCatClmAmtWithin4Yr := IF(NumSLIPCatClmWithin4Yr > 0 , MIN(TotalNZSLIPCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSLIPCatClmAmtWithin5Yr := IF(NumSLIPCatClmWithin5Yr > 0 , MIN(TotalNZSLIPCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZSLIPCatClmAmtWithin1Yr   := IF(NumNZSLIPCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZSLIPCatClmAmtWithin1YrTemp/NumNZSLIPCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSLIPCatClmAmtWithin2Yr   := IF(NumNZSLIPCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZSLIPCatClmAmtWithin2YrTemp/NumNZSLIPCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSLIPCatClmAmtWithin3Yr   := IF(NumNZSLIPCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZSLIPCatClmAmtWithin3YrTemp/NumNZSLIPCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSLIPCatClmAmtWithin4Yr   := IF(NumNZSLIPCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZSLIPCatClmAmtWithin4YrTemp/NumNZSLIPCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSLIPCatClmAmtWithin5Yr   := IF(NumNZSLIPCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZSLIPCatClmAmtWithin5YrTemp/NumNZSLIPCatClmWithin5Yr), 9999992), 9999999);


//SMOKE claims
ClaimsPropertyClaim: SMOKE_CODE_LIST := ['SMOKE'];
ClaimsPropertyClaim: => IsSMOKEClaim := EXISTS (Payments(cClaimCatType IN SMOKE_CODE_LIST));
ClaimsPropertyClaim.Payments: => SMOKEClaimAmount := IF(cClaimCatType = 'SMOKE', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalSMOKEClmAmtTemp := SUM(Payments, SMOKEClaimAmount);

ClaimsProperty: => NumSMOKECatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumSMOKECatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumSMOKECatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumSMOKECatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumSMOKECatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZSMOKECatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND TotalSMOKEClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZSMOKECatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND TotalSMOKEClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZSMOKECatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND TotalSMOKEClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZSMOKECatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND TotalSMOKEClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZSMOKECatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND TotalSMOKEClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistSMOKECatClmWithin1Yr   := IF( NumSMOKECatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSMOKECatClmWithin2Yr   := IF( NumSMOKECatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSMOKECatClmWithin3Yr   := IF( NumSMOKECatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSMOKECatClmWithin4Yr   := IF( NumSMOKECatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSMOKECatClmWithin5Yr   := IF( NumSMOKECatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSMOKECatClmWithin1Yr := IF( NumNZSMOKECatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSMOKECatClmWithin2Yr := IF( NumNZSMOKECatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSMOKECatClmWithin3Yr := IF( NumNZSMOKECatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSMOKECatClmWithin4Yr := IF( NumNZSMOKECatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSMOKECatClmWithin5Yr := IF( NumNZSMOKECatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZSMOKECatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalSMOKEClmAmtTemp);    
ClaimsProperty: => TotalNZSMOKECatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalSMOKEClmAmtTemp);    
ClaimsProperty: => TotalNZSMOKECatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalSMOKEClmAmtTemp);    
ClaimsProperty: => TotalNZSMOKECatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalSMOKEClmAmtTemp);    
ClaimsProperty: => TotalNZSMOKECatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalSMOKEClmAmtTemp);    
ClaimsProperty: => TotalNZSMOKECatClmAmtWithin1Yr := IF(NumSMOKECatClmWithin1Yr > 0 , MIN(TotalNZSMOKECatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSMOKECatClmAmtWithin2Yr := IF(NumSMOKECatClmWithin2Yr > 0 , MIN(TotalNZSMOKECatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSMOKECatClmAmtWithin3Yr := IF(NumSMOKECatClmWithin3Yr > 0 , MIN(TotalNZSMOKECatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSMOKECatClmAmtWithin4Yr := IF(NumSMOKECatClmWithin4Yr > 0 , MIN(TotalNZSMOKECatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSMOKECatClmAmtWithin5Yr := IF(NumSMOKECatClmWithin5Yr > 0 , MIN(TotalNZSMOKECatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZSMOKECatClmAmtWithin1Yr   := IF(NumNZSMOKECatClmWithin1Yr > 0 , MIN(ROUND(TotalNZSMOKECatClmAmtWithin1YrTemp/NumNZSMOKECatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSMOKECatClmAmtWithin2Yr   := IF(NumNZSMOKECatClmWithin2Yr > 0 , MIN(ROUND(TotalNZSMOKECatClmAmtWithin2YrTemp/NumNZSMOKECatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSMOKECatClmAmtWithin3Yr   := IF(NumNZSMOKECatClmWithin3Yr > 0 , MIN(ROUND(TotalNZSMOKECatClmAmtWithin3YrTemp/NumNZSMOKECatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSMOKECatClmAmtWithin4Yr   := IF(NumNZSMOKECatClmWithin4Yr > 0 , MIN(ROUND(TotalNZSMOKECatClmAmtWithin4YrTemp/NumNZSMOKECatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSMOKECatClmAmtWithin5Yr   := IF(NumNZSMOKECatClmWithin5Yr > 0 , MIN(ROUND(TotalNZSMOKECatClmAmtWithin5YrTemp/NumNZSMOKECatClmWithin5Yr), 9999992), 9999999);


//THEFT claims
ClaimsPropertyClaim: THEFT_CODE_LIST := ['THEFT'];
ClaimsPropertyClaim: => IsTHEFTClaim := EXISTS (Payments(cClaimCatType IN THEFT_CODE_LIST));
ClaimsPropertyClaim.Payments: => THEFTClaimAmount := IF(cClaimCatType = 'THEFT', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalTHEFTClmAmtTemp := SUM(Payments, THEFTClaimAmount);

ClaimsProperty: => NumTHEFTCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumTHEFTCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumTHEFTCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumTHEFTCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumTHEFTCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZTHEFTCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND TotalTHEFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZTHEFTCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND TotalTHEFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZTHEFTCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND TotalTHEFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZTHEFTCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND TotalTHEFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZTHEFTCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND TotalTHEFTClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistTHEFTCatClmWithin1Yr   := IF( NumTHEFTCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHEFTCatClmWithin2Yr   := IF( NumTHEFTCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHEFTCatClmWithin3Yr   := IF( NumTHEFTCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHEFTCatClmWithin4Yr   := IF( NumTHEFTCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHEFTCatClmWithin5Yr   := IF( NumTHEFTCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHEFTCatClmWithin1Yr := IF( NumNZTHEFTCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHEFTCatClmWithin2Yr := IF( NumNZTHEFTCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHEFTCatClmWithin3Yr := IF( NumNZTHEFTCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHEFTCatClmWithin4Yr := IF( NumNZTHEFTCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHEFTCatClmWithin5Yr := IF( NumNZTHEFTCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZTHEFTCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalTHEFTClmAmtTemp);    
ClaimsProperty: => TotalNZTHEFTCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalTHEFTClmAmtTemp);    
ClaimsProperty: => TotalNZTHEFTCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalTHEFTClmAmtTemp);    
ClaimsProperty: => TotalNZTHEFTCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalTHEFTClmAmtTemp);    
ClaimsProperty: => TotalNZTHEFTCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalTHEFTClmAmtTemp);    
ClaimsProperty: => TotalNZTHEFTCatClmAmtWithin1Yr := IF(NumTHEFTCatClmWithin1Yr > 0 , MIN(TotalNZTHEFTCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHEFTCatClmAmtWithin2Yr := IF(NumTHEFTCatClmWithin2Yr > 0 , MIN(TotalNZTHEFTCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHEFTCatClmAmtWithin3Yr := IF(NumTHEFTCatClmWithin3Yr > 0 , MIN(TotalNZTHEFTCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHEFTCatClmAmtWithin4Yr := IF(NumTHEFTCatClmWithin4Yr > 0 , MIN(TotalNZTHEFTCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHEFTCatClmAmtWithin5Yr := IF(NumTHEFTCatClmWithin5Yr > 0 , MIN(TotalNZTHEFTCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZTHEFTCatClmAmtWithin1Yr   := IF(NumNZTHEFTCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZTHEFTCatClmAmtWithin1YrTemp/NumNZTHEFTCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHEFTCatClmAmtWithin2Yr   := IF(NumNZTHEFTCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZTHEFTCatClmAmtWithin2YrTemp/NumNZTHEFTCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHEFTCatClmAmtWithin3Yr   := IF(NumNZTHEFTCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZTHEFTCatClmAmtWithin3YrTemp/NumNZTHEFTCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHEFTCatClmAmtWithin4Yr   := IF(NumNZTHEFTCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZTHEFTCatClmAmtWithin4YrTemp/NumNZTHEFTCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHEFTCatClmAmtWithin5Yr   := IF(NumNZTHEFTCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZTHEFTCatClmAmtWithin5YrTemp/NumNZTHEFTCatClmWithin5Yr), 9999992), 9999999);

//THFSC claims
ClaimsPropertyClaim: THFSC_CODE_LIST := ['THFSC'];
ClaimsPropertyClaim: => IsTHFSCClaim := EXISTS (Payments(cClaimCatType IN THFSC_CODE_LIST));
ClaimsPropertyClaim.Payments: => THFSCClaimAmount := IF(cClaimCatType = 'THFSC', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalTHFSCClmAmtTemp := SUM(Payments, THFSCClaimAmount);

ClaimsProperty: => NumTHFSCCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumTHFSCCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumTHFSCCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumTHFSCCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumTHFSCCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZTHFSCCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND TotalTHFSCClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZTHFSCCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND TotalTHFSCClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZTHFSCCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND TotalTHFSCClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZTHFSCCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND TotalTHFSCClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZTHFSCCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND TotalTHFSCClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistTHFSCCatClmWithin1Yr   := IF( NumTHFSCCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHFSCCatClmWithin2Yr   := IF( NumTHFSCCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHFSCCatClmWithin3Yr   := IF( NumTHFSCCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHFSCCatClmWithin4Yr   := IF( NumTHFSCCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHFSCCatClmWithin5Yr   := IF( NumTHFSCCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHFSCCatClmWithin1Yr := IF( NumNZTHFSCCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHFSCCatClmWithin2Yr := IF( NumNZTHFSCCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHFSCCatClmWithin3Yr := IF( NumNZTHFSCCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHFSCCatClmWithin4Yr := IF( NumNZTHFSCCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHFSCCatClmWithin5Yr := IF( NumNZTHFSCCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZTHFSCCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalTHFSCClmAmtTemp);    
ClaimsProperty: => TotalNZTHFSCCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalTHFSCClmAmtTemp);    
ClaimsProperty: => TotalNZTHFSCCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalTHFSCClmAmtTemp);    
ClaimsProperty: => TotalNZTHFSCCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalTHFSCClmAmtTemp);    
ClaimsProperty: => TotalNZTHFSCCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalTHFSCClmAmtTemp);    
ClaimsProperty: => TotalNZTHFSCCatClmAmtWithin1Yr := IF(NumTHFSCCatClmWithin1Yr > 0 , MIN(TotalNZTHFSCCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHFSCCatClmAmtWithin2Yr := IF(NumTHFSCCatClmWithin2Yr > 0 , MIN(TotalNZTHFSCCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHFSCCatClmAmtWithin3Yr := IF(NumTHFSCCatClmWithin3Yr > 0 , MIN(TotalNZTHFSCCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHFSCCatClmAmtWithin4Yr := IF(NumTHFSCCatClmWithin4Yr > 0 , MIN(TotalNZTHFSCCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHFSCCatClmAmtWithin5Yr := IF(NumTHFSCCatClmWithin5Yr > 0 , MIN(TotalNZTHFSCCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZTHFSCCatClmAmtWithin1Yr   := IF(NumNZTHFSCCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZTHFSCCatClmAmtWithin1YrTemp/NumNZTHFSCCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHFSCCatClmAmtWithin2Yr   := IF(NumNZTHFSCCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZTHFSCCatClmAmtWithin2YrTemp/NumNZTHFSCCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHFSCCatClmAmtWithin3Yr   := IF(NumNZTHFSCCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZTHFSCCatClmAmtWithin3YrTemp/NumNZTHFSCCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHFSCCatClmAmtWithin4Yr   := IF(NumNZTHFSCCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZTHFSCCatClmAmtWithin4YrTemp/NumNZTHFSCCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHFSCCatClmAmtWithin5Yr   := IF(NumNZTHFSCCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZTHFSCCatClmAmtWithin5YrTemp/NumNZTHFSCCatClmWithin5Yr), 9999992), 9999999);


//VMM claims
ClaimsPropertyClaim: VMM_CODE_LIST := ['VMM'];
ClaimsPropertyClaim: => IsVMMClaim := EXISTS (Payments(cClaimCatType IN VMM_CODE_LIST));
ClaimsPropertyClaim.Payments: => VMMClaimAmount := IF(cClaimCatType = 'VMM', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalVMMClmAmtTemp := SUM(Payments, VMMClaimAmount);

ClaimsProperty: => NumVMMCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumVMMCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumVMMCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumVMMCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumVMMCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZVMMCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND TotalVMMClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZVMMCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND TotalVMMClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZVMMCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND TotalVMMClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZVMMCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND TotalVMMClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZVMMCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND TotalVMMClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistVMMCatClmWithin1Yr   := IF( NumVMMCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistVMMCatClmWithin2Yr   := IF( NumVMMCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistVMMCatClmWithin3Yr   := IF( NumVMMCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistVMMCatClmWithin4Yr   := IF( NumVMMCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistVMMCatClmWithin5Yr   := IF( NumVMMCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZVMMCatClmWithin1Yr := IF( NumNZVMMCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZVMMCatClmWithin2Yr := IF( NumNZVMMCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZVMMCatClmWithin3Yr := IF( NumNZVMMCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZVMMCatClmWithin4Yr := IF( NumNZVMMCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZVMMCatClmWithin5Yr := IF( NumNZVMMCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZVMMCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalVMMClmAmtTemp);    
ClaimsProperty: => TotalNZVMMCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalVMMClmAmtTemp);    
ClaimsProperty: => TotalNZVMMCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalVMMClmAmtTemp);    
ClaimsProperty: => TotalNZVMMCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalVMMClmAmtTemp);    
ClaimsProperty: => TotalNZVMMCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalVMMClmAmtTemp);    
ClaimsProperty: => TotalNZVMMCatClmAmtWithin1Yr := IF(NumVMMCatClmWithin1Yr > 0 , MIN(TotalNZVMMCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZVMMCatClmAmtWithin2Yr := IF(NumVMMCatClmWithin2Yr > 0 , MIN(TotalNZVMMCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZVMMCatClmAmtWithin3Yr := IF(NumVMMCatClmWithin3Yr > 0 , MIN(TotalNZVMMCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZVMMCatClmAmtWithin4Yr := IF(NumVMMCatClmWithin4Yr > 0 , MIN(TotalNZVMMCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZVMMCatClmAmtWithin5Yr := IF(NumVMMCatClmWithin5Yr > 0 , MIN(TotalNZVMMCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZVMMCatClmAmtWithin1Yr   := IF(NumNZVMMCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZVMMCatClmAmtWithin1YrTemp/NumNZVMMCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZVMMCatClmAmtWithin2Yr   := IF(NumNZVMMCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZVMMCatClmAmtWithin2YrTemp/NumNZVMMCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZVMMCatClmAmtWithin3Yr   := IF(NumNZVMMCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZVMMCatClmAmtWithin3YrTemp/NumNZVMMCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZVMMCatClmAmtWithin4Yr   := IF(NumNZVMMCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZVMMCatClmAmtWithin4YrTemp/NumNZVMMCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZVMMCatClmAmtWithin5Yr   := IF(NumNZVMMCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZVMMCatClmAmtWithin5YrTemp/NumNZVMMCatClmWithin5Yr), 9999992), 9999999);

//WATER claims
ClaimsPropertyClaim: WATER_CODE_LIST := ['WATER'];
ClaimsPropertyClaim: => IsWATERClaim := EXISTS (Payments(cClaimCatType IN WATER_CODE_LIST));
ClaimsPropertyClaim.Payments: => WATERClaimAmount := IF(cClaimCatType = 'WATER', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalWATERClmAmtTemp := SUM(Payments, WATERClaimAmount);

ClaimsProperty: => NumWATERCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumWATERCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumWATERCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumWATERCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumWATERCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZWATERCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND TotalWATERClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZWATERCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND TotalWATERClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZWATERCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND TotalWATERClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZWATERCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND TotalWATERClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZWATERCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND TotalWATERClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistWATERCatClmWithin1Yr   := IF( NumWATERCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWATERCatClmWithin2Yr   := IF( NumWATERCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWATERCatClmWithin3Yr   := IF( NumWATERCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWATERCatClmWithin4Yr   := IF( NumWATERCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWATERCatClmWithin5Yr   := IF( NumWATERCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWATERCatClmWithin1Yr := IF( NumNZWATERCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWATERCatClmWithin2Yr := IF( NumNZWATERCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWATERCatClmWithin3Yr := IF( NumNZWATERCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWATERCatClmWithin4Yr := IF( NumNZWATERCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWATERCatClmWithin5Yr := IF( NumNZWATERCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZWATERCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalWATERClmAmtTemp);    
ClaimsProperty: => TotalNZWATERCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalWATERClmAmtTemp);    
ClaimsProperty: => TotalNZWATERCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalWATERClmAmtTemp);    
ClaimsProperty: => TotalNZWATERCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalWATERClmAmtTemp);    
ClaimsProperty: => TotalNZWATERCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalWATERClmAmtTemp);    
ClaimsProperty: => TotalNZWATERCatClmAmtWithin1Yr := IF(NumWATERCatClmWithin1Yr > 0 , MIN(TotalNZWATERCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWATERCatClmAmtWithin2Yr := IF(NumWATERCatClmWithin2Yr > 0 , MIN(TotalNZWATERCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWATERCatClmAmtWithin3Yr := IF(NumWATERCatClmWithin3Yr > 0 , MIN(TotalNZWATERCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWATERCatClmAmtWithin4Yr := IF(NumWATERCatClmWithin4Yr > 0 , MIN(TotalNZWATERCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWATERCatClmAmtWithin5Yr := IF(NumWATERCatClmWithin5Yr > 0 , MIN(TotalNZWATERCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZWATERCatClmAmtWithin1Yr   := IF(NumNZWATERCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZWATERCatClmAmtWithin1YrTemp/NumNZWATERCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWATERCatClmAmtWithin2Yr   := IF(NumNZWATERCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZWATERCatClmAmtWithin2YrTemp/NumNZWATERCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWATERCatClmAmtWithin3Yr   := IF(NumNZWATERCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZWATERCatClmAmtWithin3YrTemp/NumNZWATERCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWATERCatClmAmtWithin4Yr   := IF(NumNZWATERCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZWATERCatClmAmtWithin4YrTemp/NumNZWATERCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWATERCatClmAmtWithin5Yr   := IF(NumNZWATERCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZWATERCatClmAmtWithin5YrTemp/NumNZWATERCatClmWithin5Yr), 9999992), 9999999);


//WIND claims
ClaimsPropertyClaim: WIND_CODE_LIST := ['WIND'];
ClaimsPropertyClaim: => IsWINDClaim := EXISTS (Payments(cClaimCatType IN WIND_CODE_LIST));
ClaimsPropertyClaim.Payments: => WINDClaimAmount := IF(cClaimCatType = 'WIND', cClaimCatAmount, 0);
ClaimsPropertyClaim: => TotalWINDClmAmtTemp := SUM(Payments, WINDClaimAmount);

ClaimsProperty: => NumWINDCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumWINDCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumWINDCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumWINDCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumWINDCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZWINDCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND TotalWINDClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZWINDCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND TotalWINDClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZWINDCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND TotalWINDClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZWINDCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND TotalWINDClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZWINDCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND TotalWINDClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistWINDCatClmWithin1Yr   := IF( NumWINDCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWINDCatClmWithin2Yr   := IF( NumWINDCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWINDCatClmWithin3Yr   := IF( NumWINDCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWINDCatClmWithin4Yr   := IF( NumWINDCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWINDCatClmWithin5Yr   := IF( NumWINDCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWINDCatClmWithin1Yr := IF( NumNZWINDCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWINDCatClmWithin2Yr := IF( NumNZWINDCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWINDCatClmWithin3Yr := IF( NumNZWINDCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWINDCatClmWithin4Yr := IF( NumNZWINDCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWINDCatClmWithin5Yr := IF( NumNZWINDCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZWINDCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalWINDClmAmtTemp);    
ClaimsProperty: => TotalNZWINDCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalWINDClmAmtTemp);    
ClaimsProperty: => TotalNZWINDCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalWINDClmAmtTemp);    
ClaimsProperty: => TotalNZWINDCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalWINDClmAmtTemp);    
ClaimsProperty: => TotalNZWINDCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalWINDClmAmtTemp);    
ClaimsProperty: => TotalNZWINDCatClmAmtWithin1Yr := IF(NumWINDCatClmWithin1Yr > 0 , MIN(TotalNZWINDCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWINDCatClmAmtWithin2Yr := IF(NumWINDCatClmWithin2Yr > 0 , MIN(TotalNZWINDCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWINDCatClmAmtWithin3Yr := IF(NumWINDCatClmWithin3Yr > 0 , MIN(TotalNZWINDCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWINDCatClmAmtWithin4Yr := IF(NumWINDCatClmWithin4Yr > 0 , MIN(TotalNZWINDCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWINDCatClmAmtWithin5Yr := IF(NumWINDCatClmWithin5Yr > 0 , MIN(TotalNZWINDCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZWINDCatClmAmtWithin1Yr   := IF(NumNZWINDCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZWINDCatClmAmtWithin1YrTemp/NumNZWINDCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWINDCatClmAmtWithin2Yr   := IF(NumNZWINDCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZWINDCatClmAmtWithin2YrTemp/NumNZWINDCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWINDCatClmAmtWithin3Yr   := IF(NumNZWINDCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZWINDCatClmAmtWithin3YrTemp/NumNZWINDCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWINDCatClmAmtWithin4Yr   := IF(NumNZWINDCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZWINDCatClmAmtWithin4YrTemp/NumNZWINDCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWINDCatClmAmtWithin5Yr   := IF(NumNZWINDCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZWINDCatClmAmtWithin5YrTemp/NumNZWINDCatClmWithin5Yr), 9999992), 9999999);


//CRAFT claims
// ClaimsPropertyClaim: CRAFT_CODE_LIST := ['CRAFT'];
// ClaimsPropertyClaim: => IsCRAFTClaim := EXISTS (Payments(cClaimCatType IN CRAFT_CODE_LIST));
// ClaimsPropertyClaim.Payments: => CRAFTClaimAmount := IF(cClaimCatType = 'CRAFT', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalCRAFTClmAmtTemp := SUM(Payments, CRAFTClaimAmount);

ClaimsProperty: => NumCRAFTNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumCRAFTNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumCRAFTNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumCRAFTNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumCRAFTNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZCRAFTNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZCRAFTNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZCRAFTNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZCRAFTNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZCRAFTNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCRAFTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistCRAFTNonCatClmWithin1Yr   := IF( NumCRAFTNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCRAFTNonCatClmWithin2Yr   := IF( NumCRAFTNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCRAFTNonCatClmWithin3Yr   := IF( NumCRAFTNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCRAFTNonCatClmWithin4Yr   := IF( NumCRAFTNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCRAFTNonCatClmWithin5Yr   := IF( NumCRAFTNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCRAFTNonCatClmWithin1Yr := IF( NumNZCRAFTNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCRAFTNonCatClmWithin2Yr := IF( NumNZCRAFTNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCRAFTNonCatClmWithin3Yr := IF( NumNZCRAFTNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCRAFTNonCatClmWithin4Yr := IF( NumNZCRAFTNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCRAFTNonCatClmWithin5Yr := IF( NumNZCRAFTNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZCRAFTNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalCRAFTClmAmtTemp);    
ClaimsProperty: => TotalNZCRAFTNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalCRAFTClmAmtTemp);    
ClaimsProperty: => TotalNZCRAFTNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalCRAFTClmAmtTemp);    
ClaimsProperty: => TotalNZCRAFTNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalCRAFTClmAmtTemp);    
ClaimsProperty: => TotalNZCRAFTNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalCRAFTClmAmtTemp);    
ClaimsProperty: => TotalNZCRAFTNonCatClmAmtWithin1Yr := IF(NumCRAFTNonCatClmWithin1Yr > 0 , MIN(TotalNZCRAFTNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCRAFTNonCatClmAmtWithin2Yr := IF(NumCRAFTNonCatClmWithin2Yr > 0 , MIN(TotalNZCRAFTNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCRAFTNonCatClmAmtWithin3Yr := IF(NumCRAFTNonCatClmWithin3Yr > 0 , MIN(TotalNZCRAFTNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCRAFTNonCatClmAmtWithin4Yr := IF(NumCRAFTNonCatClmWithin4Yr > 0 , MIN(TotalNZCRAFTNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCRAFTNonCatClmAmtWithin5Yr := IF(NumCRAFTNonCatClmWithin5Yr > 0 , MIN(TotalNZCRAFTNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZCRAFTNonCatClmAmtWithin1Yr   := IF(NumNZCRAFTNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZCRAFTNonCatClmAmtWithin1YrTemp/NumNZCRAFTNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCRAFTNonCatClmAmtWithin2Yr   := IF(NumNZCRAFTNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZCRAFTNonCatClmAmtWithin2YrTemp/NumNZCRAFTNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCRAFTNonCatClmAmtWithin3Yr   := IF(NumNZCRAFTNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZCRAFTNonCatClmAmtWithin3YrTemp/NumNZCRAFTNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCRAFTNonCatClmAmtWithin4Yr   := IF(NumNZCRAFTNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZCRAFTNonCatClmAmtWithin4YrTemp/NumNZCRAFTNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCRAFTNonCatClmAmtWithin5Yr   := IF(NumNZCRAFTNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZCRAFTNonCatClmAmtWithin5YrTemp/NumNZCRAFTNonCatClmWithin5Yr), 9999992), 9999999);


//CREDT claims
// ClaimsPropertyClaim: CREDT_CODE_LIST := ['CREDT'];
// ClaimsPropertyClaim: => IsCREDTClaim := EXISTS (Payments(cClaimCatType IN CREDT_CODE_LIST));
// ClaimsPropertyClaim.Payments: => CREDTClaimAmount := IF(cClaimCatType = 'CREDT', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalCREDTClmAmtTemp := SUM(Payments, CREDTClaimAmount);

ClaimsProperty: => NumCREDTNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumCREDTNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumCREDTNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumCREDTNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumCREDTNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZCREDTNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND TotalCREDTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZCREDTNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND TotalCREDTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZCREDTNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND TotalCREDTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZCREDTNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND TotalCREDTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZCREDTNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsCREDTClaim = TRUE AND TotalCREDTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistCREDTNonCatClmWithin1Yr   := IF( NumCREDTNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCREDTNonCatClmWithin2Yr   := IF( NumCREDTNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCREDTNonCatClmWithin3Yr   := IF( NumCREDTNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCREDTNonCatClmWithin4Yr   := IF( NumCREDTNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistCREDTNonCatClmWithin5Yr   := IF( NumCREDTNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCREDTNonCatClmWithin1Yr := IF( NumNZCREDTNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCREDTNonCatClmWithin2Yr := IF( NumNZCREDTNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCREDTNonCatClmWithin3Yr := IF( NumNZCREDTNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCREDTNonCatClmWithin4Yr := IF( NumNZCREDTNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZCREDTNonCatClmWithin5Yr := IF( NumNZCREDTNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZCREDTNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalCREDTClmAmtTemp);    
ClaimsProperty: => TotalNZCREDTNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalCREDTClmAmtTemp);    
ClaimsProperty: => TotalNZCREDTNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalCREDTClmAmtTemp);    
ClaimsProperty: => TotalNZCREDTNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalCREDTClmAmtTemp);    
ClaimsProperty: => TotalNZCREDTNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalCREDTClmAmtTemp);    
ClaimsProperty: => TotalNZCREDTNonCatClmAmtWithin1Yr := IF(NumCREDTNonCatClmWithin1Yr > 0 , MIN(TotalNZCREDTNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCREDTNonCatClmAmtWithin2Yr := IF(NumCREDTNonCatClmWithin2Yr > 0 , MIN(TotalNZCREDTNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCREDTNonCatClmAmtWithin3Yr := IF(NumCREDTNonCatClmWithin3Yr > 0 , MIN(TotalNZCREDTNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCREDTNonCatClmAmtWithin4Yr := IF(NumCREDTNonCatClmWithin4Yr > 0 , MIN(TotalNZCREDTNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZCREDTNonCatClmAmtWithin5Yr := IF(NumCREDTNonCatClmWithin5Yr > 0 , MIN(TotalNZCREDTNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZCREDTNonCatClmAmtWithin1Yr   := IF(NumNZCREDTNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZCREDTNonCatClmAmtWithin1YrTemp/NumNZCREDTNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCREDTNonCatClmAmtWithin2Yr   := IF(NumNZCREDTNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZCREDTNonCatClmAmtWithin2YrTemp/NumNZCREDTNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCREDTNonCatClmAmtWithin3Yr   := IF(NumNZCREDTNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZCREDTNonCatClmAmtWithin3YrTemp/NumNZCREDTNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCREDTNonCatClmAmtWithin4Yr   := IF(NumNZCREDTNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZCREDTNonCatClmAmtWithin4YrTemp/NumNZCREDTNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZCREDTNonCatClmAmtWithin5Yr   := IF(NumNZCREDTNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZCREDTNonCatClmAmtWithin5YrTemp/NumNZCREDTNonCatClmWithin5Yr), 9999992), 9999999);


//DOG claims
// ClaimsPropertyClaim: DOG_CODE_LIST := ['DOG'];
// ClaimsPropertyClaim: => IsDOGClaim := EXISTS (Payments(cClaimCatType IN DOG_CODE_LIST));
// ClaimsPropertyClaim.Payments: => DOGClaimAmount := IF(cClaimCatType = 'DOG', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalDOGClmAmtTemp := SUM(Payments, DOGClaimAmount);

ClaimsProperty: => NumDOGNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumDOGNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumDOGNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumDOGNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumDOGNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZDOGNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND TotalDOGClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZDOGNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND TotalDOGClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZDOGNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND TotalDOGClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZDOGNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND TotalDOGClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZDOGNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsDOGClaim = TRUE AND TotalDOGClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistDOGNonCatClmWithin1Yr   := IF( NumDOGNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDOGNonCatClmWithin2Yr   := IF( NumDOGNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDOGNonCatClmWithin3Yr   := IF( NumDOGNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDOGNonCatClmWithin4Yr   := IF( NumDOGNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDOGNonCatClmWithin5Yr   := IF( NumDOGNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDOGNonCatClmWithin1Yr := IF( NumNZDOGNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDOGNonCatClmWithin2Yr := IF( NumNZDOGNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDOGNonCatClmWithin3Yr := IF( NumNZDOGNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDOGNonCatClmWithin4Yr := IF( NumNZDOGNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDOGNonCatClmWithin5Yr := IF( NumNZDOGNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZDOGNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalDOGClmAmtTemp);    
ClaimsProperty: => TotalNZDOGNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalDOGClmAmtTemp);    
ClaimsProperty: => TotalNZDOGNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalDOGClmAmtTemp);    
ClaimsProperty: => TotalNZDOGNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalDOGClmAmtTemp);    
ClaimsProperty: => TotalNZDOGNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalDOGClmAmtTemp);    
ClaimsProperty: => TotalNZDOGNonCatClmAmtWithin1Yr := IF(NumDOGNonCatClmWithin1Yr > 0 , MIN(TotalNZDOGNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDOGNonCatClmAmtWithin2Yr := IF(NumDOGNonCatClmWithin2Yr > 0 , MIN(TotalNZDOGNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDOGNonCatClmAmtWithin3Yr := IF(NumDOGNonCatClmWithin3Yr > 0 , MIN(TotalNZDOGNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDOGNonCatClmAmtWithin4Yr := IF(NumDOGNonCatClmWithin4Yr > 0 , MIN(TotalNZDOGNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDOGNonCatClmAmtWithin5Yr := IF(NumDOGNonCatClmWithin5Yr > 0 , MIN(TotalNZDOGNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZDOGNonCatClmAmtWithin1Yr   := IF(NumNZDOGNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZDOGNonCatClmAmtWithin1YrTemp/NumNZDOGNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDOGNonCatClmAmtWithin2Yr   := IF(NumNZDOGNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZDOGNonCatClmAmtWithin2YrTemp/NumNZDOGNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDOGNonCatClmAmtWithin3Yr   := IF(NumNZDOGNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZDOGNonCatClmAmtWithin3YrTemp/NumNZDOGNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDOGNonCatClmAmtWithin4Yr   := IF(NumNZDOGNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZDOGNonCatClmAmtWithin4YrTemp/NumNZDOGNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDOGNonCatClmAmtWithin5Yr   := IF(NumNZDOGNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZDOGNonCatClmAmtWithin5YrTemp/NumNZDOGNonCatClmWithin5Yr), 9999992), 9999999);


//DISAP claims
// ClaimsPropertyClaim: DISAP_CODE_LIST := ['DISAP'];
// ClaimsPropertyClaim: => IsDISAPClaim := EXISTS (Payments(cClaimCatType IN DISAP_CODE_LIST));
// ClaimsPropertyClaim.Payments: => DISAPClaimAmount := IF(cClaimCatType = 'DISAP', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalDISAPClmAmtTemp := SUM(Payments, DISAPClaimAmount);

ClaimsProperty: => NumDISAPNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumDISAPNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumDISAPNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumDISAPNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumDISAPNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZDISAPNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND TotalDISAPClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZDISAPNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND TotalDISAPClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZDISAPNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND TotalDISAPClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZDISAPNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND TotalDISAPClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZDISAPNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsDISAPClaim = TRUE AND TotalDISAPClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistDISAPNonCatClmWithin1Yr   := IF( NumDISAPNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISAPNonCatClmWithin2Yr   := IF( NumDISAPNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISAPNonCatClmWithin3Yr   := IF( NumDISAPNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISAPNonCatClmWithin4Yr   := IF( NumDISAPNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISAPNonCatClmWithin5Yr   := IF( NumDISAPNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISAPNonCatClmWithin1Yr := IF( NumNZDISAPNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISAPNonCatClmWithin2Yr := IF( NumNZDISAPNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISAPNonCatClmWithin3Yr := IF( NumNZDISAPNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISAPNonCatClmWithin4Yr := IF( NumNZDISAPNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISAPNonCatClmWithin5Yr := IF( NumNZDISAPNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZDISAPNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalDISAPClmAmtTemp);    
ClaimsProperty: => TotalNZDISAPNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalDISAPClmAmtTemp);    
ClaimsProperty: => TotalNZDISAPNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalDISAPClmAmtTemp);    
ClaimsProperty: => TotalNZDISAPNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalDISAPClmAmtTemp);    
ClaimsProperty: => TotalNZDISAPNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalDISAPClmAmtTemp);    
ClaimsProperty: => TotalNZDISAPNonCatClmAmtWithin1Yr := IF(NumDISAPNonCatClmWithin1Yr > 0 , MIN(TotalNZDISAPNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISAPNonCatClmAmtWithin2Yr := IF(NumDISAPNonCatClmWithin2Yr > 0 , MIN(TotalNZDISAPNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISAPNonCatClmAmtWithin3Yr := IF(NumDISAPNonCatClmWithin3Yr > 0 , MIN(TotalNZDISAPNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISAPNonCatClmAmtWithin4Yr := IF(NumDISAPNonCatClmWithin4Yr > 0 , MIN(TotalNZDISAPNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISAPNonCatClmAmtWithin5Yr := IF(NumDISAPNonCatClmWithin5Yr > 0 , MIN(TotalNZDISAPNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZDISAPNonCatClmAmtWithin1Yr   := IF(NumNZDISAPNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZDISAPNonCatClmAmtWithin1YrTemp/NumNZDISAPNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISAPNonCatClmAmtWithin2Yr   := IF(NumNZDISAPNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZDISAPNonCatClmAmtWithin2YrTemp/NumNZDISAPNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISAPNonCatClmAmtWithin3Yr   := IF(NumNZDISAPNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZDISAPNonCatClmAmtWithin3YrTemp/NumNZDISAPNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISAPNonCatClmAmtWithin4Yr   := IF(NumNZDISAPNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZDISAPNonCatClmAmtWithin4YrTemp/NumNZDISAPNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISAPNonCatClmAmtWithin5Yr   := IF(NumNZDISAPNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZDISAPNonCatClmAmtWithin5YrTemp/NumNZDISAPNonCatClmWithin5Yr), 9999992), 9999999);


//DAMAG claims
// ClaimsPropertyClaim: DAMAG_CODE_LIST := ['DAMAG'];
// ClaimsPropertyClaim: => IsDAMAGClaim := EXISTS (Payments(cClaimCatType IN DAMAG_CODE_LIST));
// ClaimsPropertyClaim.Payments: => DAMAGClaimAmount := IF(cClaimCatType = 'DAMAG', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalDAMAGClmAmtTemp := SUM(Payments, DAMAGClaimAmount);

ClaimsProperty: => NumDAMAGNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumDAMAGNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumDAMAGNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumDAMAGNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumDAMAGNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZDAMAGNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND TotalDAMAGClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZDAMAGNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND TotalDAMAGClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZDAMAGNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND TotalDAMAGClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZDAMAGNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND TotalDAMAGClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZDAMAGNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsDAMAGClaim = TRUE AND TotalDAMAGClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistDAMAGNonCatClmWithin1Yr   := IF( NumDAMAGNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDAMAGNonCatClmWithin2Yr   := IF( NumDAMAGNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDAMAGNonCatClmWithin3Yr   := IF( NumDAMAGNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDAMAGNonCatClmWithin4Yr   := IF( NumDAMAGNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDAMAGNonCatClmWithin5Yr   := IF( NumDAMAGNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDAMAGNonCatClmWithin1Yr := IF( NumNZDAMAGNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDAMAGNonCatClmWithin2Yr := IF( NumNZDAMAGNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDAMAGNonCatClmWithin3Yr := IF( NumNZDAMAGNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDAMAGNonCatClmWithin4Yr := IF( NumNZDAMAGNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDAMAGNonCatClmWithin5Yr := IF( NumNZDAMAGNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZDAMAGNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalDAMAGClmAmtTemp);    
ClaimsProperty: => TotalNZDAMAGNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalDAMAGClmAmtTemp);    
ClaimsProperty: => TotalNZDAMAGNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalDAMAGClmAmtTemp);    
ClaimsProperty: => TotalNZDAMAGNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalDAMAGClmAmtTemp);    
ClaimsProperty: => TotalNZDAMAGNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalDAMAGClmAmtTemp);    
ClaimsProperty: => TotalNZDAMAGNonCatClmAmtWithin1Yr := IF(NumDAMAGNonCatClmWithin1Yr > 0 , MIN(TotalNZDAMAGNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDAMAGNonCatClmAmtWithin2Yr := IF(NumDAMAGNonCatClmWithin2Yr > 0 , MIN(TotalNZDAMAGNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDAMAGNonCatClmAmtWithin3Yr := IF(NumDAMAGNonCatClmWithin3Yr > 0 , MIN(TotalNZDAMAGNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDAMAGNonCatClmAmtWithin4Yr := IF(NumDAMAGNonCatClmWithin4Yr > 0 , MIN(TotalNZDAMAGNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDAMAGNonCatClmAmtWithin5Yr := IF(NumDAMAGNonCatClmWithin5Yr > 0 , MIN(TotalNZDAMAGNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZDAMAGNonCatClmAmtWithin1Yr   := IF(NumNZDAMAGNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZDAMAGNonCatClmAmtWithin1YrTemp/NumNZDAMAGNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDAMAGNonCatClmAmtWithin2Yr   := IF(NumNZDAMAGNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZDAMAGNonCatClmAmtWithin2YrTemp/NumNZDAMAGNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDAMAGNonCatClmAmtWithin3Yr   := IF(NumNZDAMAGNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZDAMAGNonCatClmAmtWithin3YrTemp/NumNZDAMAGNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDAMAGNonCatClmAmtWithin4Yr   := IF(NumNZDAMAGNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZDAMAGNonCatClmAmtWithin4YrTemp/NumNZDAMAGNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDAMAGNonCatClmAmtWithin5Yr   := IF(NumNZDAMAGNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZDAMAGNonCatClmAmtWithin5YrTemp/NumNZDAMAGNonCatClmWithin5Yr), 9999992), 9999999);


//DISSC claims
// ClaimsPropertyClaim: DISSC_CODE_LIST := ['DISSC'];
// ClaimsPropertyClaim: => IsDISSCClaim := EXISTS (Payments(cClaimCatType IN DISSC_CODE_LIST));
// ClaimsPropertyClaim.Payments: => DISSCClaimAmount := IF(cClaimCatType = 'DISSC', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalDISSCClmAmtTemp := SUM(Payments, DISSCClaimAmount);

ClaimsProperty: => NumDISSCNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumDISSCNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumDISSCNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumDISSCNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumDISSCNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZDISSCNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND TotalDISSCClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZDISSCNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND TotalDISSCClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZDISSCNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND TotalDISSCClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZDISSCNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND TotalDISSCClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZDISSCNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsDISSCClaim = TRUE AND TotalDISSCClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistDISSCNonCatClmWithin1Yr   := IF( NumDISSCNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISSCNonCatClmWithin2Yr   := IF( NumDISSCNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISSCNonCatClmWithin3Yr   := IF( NumDISSCNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISSCNonCatClmWithin4Yr   := IF( NumDISSCNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistDISSCNonCatClmWithin5Yr   := IF( NumDISSCNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISSCNonCatClmWithin1Yr := IF( NumNZDISSCNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISSCNonCatClmWithin2Yr := IF( NumNZDISSCNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISSCNonCatClmWithin3Yr := IF( NumNZDISSCNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISSCNonCatClmWithin4Yr := IF( NumNZDISSCNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZDISSCNonCatClmWithin5Yr := IF( NumNZDISSCNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZDISSCNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalDISSCClmAmtTemp);    
ClaimsProperty: => TotalNZDISSCNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalDISSCClmAmtTemp);    
ClaimsProperty: => TotalNZDISSCNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalDISSCClmAmtTemp);    
ClaimsProperty: => TotalNZDISSCNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalDISSCClmAmtTemp);    
ClaimsProperty: => TotalNZDISSCNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalDISSCClmAmtTemp);    
ClaimsProperty: => TotalNZDISSCNonCatClmAmtWithin1Yr := IF(NumDISSCNonCatClmWithin1Yr > 0 , MIN(TotalNZDISSCNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISSCNonCatClmAmtWithin2Yr := IF(NumDISSCNonCatClmWithin2Yr > 0 , MIN(TotalNZDISSCNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISSCNonCatClmAmtWithin3Yr := IF(NumDISSCNonCatClmWithin3Yr > 0 , MIN(TotalNZDISSCNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISSCNonCatClmAmtWithin4Yr := IF(NumDISSCNonCatClmWithin4Yr > 0 , MIN(TotalNZDISSCNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZDISSCNonCatClmAmtWithin5Yr := IF(NumDISSCNonCatClmWithin5Yr > 0 , MIN(TotalNZDISSCNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZDISSCNonCatClmAmtWithin1Yr   := IF(NumNZDISSCNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZDISSCNonCatClmAmtWithin1YrTemp/NumNZDISSCNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISSCNonCatClmAmtWithin2Yr   := IF(NumNZDISSCNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZDISSCNonCatClmAmtWithin2YrTemp/NumNZDISSCNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISSCNonCatClmAmtWithin3Yr   := IF(NumNZDISSCNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZDISSCNonCatClmAmtWithin3YrTemp/NumNZDISSCNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISSCNonCatClmAmtWithin4Yr   := IF(NumNZDISSCNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZDISSCNonCatClmAmtWithin4YrTemp/NumNZDISSCNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZDISSCNonCatClmAmtWithin5Yr   := IF(NumNZDISSCNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZDISSCNonCatClmAmtWithin5YrTemp/NumNZDISSCNonCatClmWithin5Yr), 9999992), 9999999);


//EXTEN claims
// ClaimsPropertyClaim: EXTEN_CODE_LIST := ['EXTEN'];
// ClaimsPropertyClaim: => IsEXTENClaim := EXISTS (Payments(cClaimCatType IN EXTEN_CODE_LIST));
// ClaimsPropertyClaim.Payments: => EXTENClaimAmount := IF(cClaimCatType = 'EXTEN', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalEXTENClmAmtTemp := SUM(Payments, EXTENClaimAmount);

ClaimsProperty: => NumEXTENNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumEXTENNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumEXTENNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumEXTENNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumEXTENNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZEXTENNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND TotalEXTENClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZEXTENNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND TotalEXTENClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZEXTENNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND TotalEXTENClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZEXTENNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND TotalEXTENClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZEXTENNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsEXTENClaim = TRUE AND TotalEXTENClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistEXTENNonCatClmWithin1Yr   := IF( NumEXTENNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistEXTENNonCatClmWithin2Yr   := IF( NumEXTENNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistEXTENNonCatClmWithin3Yr   := IF( NumEXTENNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistEXTENNonCatClmWithin4Yr   := IF( NumEXTENNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistEXTENNonCatClmWithin5Yr   := IF( NumEXTENNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZEXTENNonCatClmWithin1Yr := IF( NumNZEXTENNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZEXTENNonCatClmWithin2Yr := IF( NumNZEXTENNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZEXTENNonCatClmWithin3Yr := IF( NumNZEXTENNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZEXTENNonCatClmWithin4Yr := IF( NumNZEXTENNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZEXTENNonCatClmWithin5Yr := IF( NumNZEXTENNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZEXTENNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalEXTENClmAmtTemp);    
ClaimsProperty: => TotalNZEXTENNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalEXTENClmAmtTemp);    
ClaimsProperty: => TotalNZEXTENNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalEXTENClmAmtTemp);    
ClaimsProperty: => TotalNZEXTENNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalEXTENClmAmtTemp);    
ClaimsProperty: => TotalNZEXTENNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalEXTENClmAmtTemp);    
ClaimsProperty: => TotalNZEXTENNonCatClmAmtWithin1Yr := IF(NumEXTENNonCatClmWithin1Yr > 0 , MIN(TotalNZEXTENNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZEXTENNonCatClmAmtWithin2Yr := IF(NumEXTENNonCatClmWithin2Yr > 0 , MIN(TotalNZEXTENNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZEXTENNonCatClmAmtWithin3Yr := IF(NumEXTENNonCatClmWithin3Yr > 0 , MIN(TotalNZEXTENNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZEXTENNonCatClmAmtWithin4Yr := IF(NumEXTENNonCatClmWithin4Yr > 0 , MIN(TotalNZEXTENNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZEXTENNonCatClmAmtWithin5Yr := IF(NumEXTENNonCatClmWithin5Yr > 0 , MIN(TotalNZEXTENNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZEXTENNonCatClmAmtWithin1Yr   := IF(NumNZEXTENNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZEXTENNonCatClmAmtWithin1YrTemp/NumNZEXTENNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZEXTENNonCatClmAmtWithin2Yr   := IF(NumNZEXTENNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZEXTENNonCatClmAmtWithin2YrTemp/NumNZEXTENNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZEXTENNonCatClmAmtWithin3Yr   := IF(NumNZEXTENNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZEXTENNonCatClmAmtWithin3YrTemp/NumNZEXTENNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZEXTENNonCatClmAmtWithin4Yr   := IF(NumNZEXTENNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZEXTENNonCatClmAmtWithin4YrTemp/NumNZEXTENNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZEXTENNonCatClmAmtWithin5Yr   := IF(NumNZEXTENNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZEXTENNonCatClmAmtWithin5YrTemp/NumNZEXTENNonCatClmWithin5Yr), 9999992), 9999999);


//FIRE claims
// ClaimsPropertyClaim: FIRE_CODE_LIST := ['FIRE'];
// ClaimsPropertyClaim: => IsFIREClaim := EXISTS (Payments(cClaimCatType IN FIRE_CODE_LIST));
// ClaimsPropertyClaim.Payments: => FIREClaimAmount := IF(cClaimCatType = 'FIRE', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalFIREClmAmtTemp := SUM(Payments, FIREClaimAmount);

ClaimsProperty: => NumFIRENonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumFIRENonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumFIRENonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumFIRENonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumFIRENonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZFIRENonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND TotalFIREClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZFIRENonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND TotalFIREClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZFIRENonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND TotalFIREClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZFIRENonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND TotalFIREClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZFIRENonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsFIREClaim = TRUE AND TotalFIREClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistFIRENonCatClmWithin1Yr   := IF( NumFIRENonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFIRENonCatClmWithin2Yr   := IF( NumFIRENonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFIRENonCatClmWithin3Yr   := IF( NumFIRENonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFIRENonCatClmWithin4Yr   := IF( NumFIRENonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFIRENonCatClmWithin5Yr   := IF( NumFIRENonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFIRENonCatClmWithin1Yr := IF( NumNZFIRENonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFIRENonCatClmWithin2Yr := IF( NumNZFIRENonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFIRENonCatClmWithin3Yr := IF( NumNZFIRENonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFIRENonCatClmWithin4Yr := IF( NumNZFIRENonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFIRENonCatClmWithin5Yr := IF( NumNZFIRENonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZFIRENonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalFIREClmAmtTemp);    
ClaimsProperty: => TotalNZFIRENonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalFIREClmAmtTemp);    
ClaimsProperty: => TotalNZFIRENonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalFIREClmAmtTemp);    
ClaimsProperty: => TotalNZFIRENonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalFIREClmAmtTemp);    
ClaimsProperty: => TotalNZFIRENonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalFIREClmAmtTemp);    
ClaimsProperty: => TotalNZFIRENonCatClmAmtWithin1Yr := IF(NumFIRENonCatClmWithin1Yr > 0 , MIN(TotalNZFIRENonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFIRENonCatClmAmtWithin2Yr := IF(NumFIRENonCatClmWithin2Yr > 0 , MIN(TotalNZFIRENonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFIRENonCatClmAmtWithin3Yr := IF(NumFIRENonCatClmWithin3Yr > 0 , MIN(TotalNZFIRENonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFIRENonCatClmAmtWithin4Yr := IF(NumFIRENonCatClmWithin4Yr > 0 , MIN(TotalNZFIRENonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFIRENonCatClmAmtWithin5Yr := IF(NumFIRENonCatClmWithin5Yr > 0 , MIN(TotalNZFIRENonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZFIRENonCatClmAmtWithin1Yr   := IF(NumNZFIRENonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZFIRENonCatClmAmtWithin1YrTemp/NumNZFIRENonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFIRENonCatClmAmtWithin2Yr   := IF(NumNZFIRENonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZFIRENonCatClmAmtWithin2YrTemp/NumNZFIRENonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFIRENonCatClmAmtWithin3Yr   := IF(NumNZFIRENonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZFIRENonCatClmAmtWithin3YrTemp/NumNZFIRENonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFIRENonCatClmAmtWithin4Yr   := IF(NumNZFIRENonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZFIRENonCatClmAmtWithin4YrTemp/NumNZFIRENonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFIRENonCatClmAmtWithin5Yr   := IF(NumNZFIRENonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZFIRENonCatClmAmtWithin5YrTemp/NumNZFIRENonCatClmWithin5Yr), 9999992), 9999999);


//FREEZ claims
// ClaimsPropertyClaim: FREEZ_CODE_LIST := ['FREEZ'];
// ClaimsPropertyClaim: => IsFREEZClaim := EXISTS (Payments(cClaimCatType IN FREEZ_CODE_LIST));
// ClaimsPropertyClaim.Payments: => FREEZClaimAmount := IF(cClaimCatType = 'FREEZ', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalFREEZClmAmtTemp := SUM(Payments, FREEZClaimAmount);

ClaimsProperty: => NumFREEZNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumFREEZNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumFREEZNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumFREEZNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumFREEZNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZFREEZNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND TotalFREEZClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZFREEZNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND TotalFREEZClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZFREEZNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND TotalFREEZClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZFREEZNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND TotalFREEZClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZFREEZNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsFREEZClaim = TRUE AND TotalFREEZClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistFREEZNonCatClmWithin1Yr   := IF( NumFREEZNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFREEZNonCatClmWithin2Yr   := IF( NumFREEZNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFREEZNonCatClmWithin3Yr   := IF( NumFREEZNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFREEZNonCatClmWithin4Yr   := IF( NumFREEZNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistFREEZNonCatClmWithin5Yr   := IF( NumFREEZNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFREEZNonCatClmWithin1Yr := IF( NumNZFREEZNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFREEZNonCatClmWithin2Yr := IF( NumNZFREEZNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFREEZNonCatClmWithin3Yr := IF( NumNZFREEZNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFREEZNonCatClmWithin4Yr := IF( NumNZFREEZNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZFREEZNonCatClmWithin5Yr := IF( NumNZFREEZNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZFREEZNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalFREEZClmAmtTemp);    
ClaimsProperty: => TotalNZFREEZNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalFREEZClmAmtTemp);    
ClaimsProperty: => TotalNZFREEZNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalFREEZClmAmtTemp);    
ClaimsProperty: => TotalNZFREEZNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalFREEZClmAmtTemp);    
ClaimsProperty: => TotalNZFREEZNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalFREEZClmAmtTemp);    
ClaimsProperty: => TotalNZFREEZNonCatClmAmtWithin1Yr := IF(NumFREEZNonCatClmWithin1Yr > 0 , MIN(TotalNZFREEZNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFREEZNonCatClmAmtWithin2Yr := IF(NumFREEZNonCatClmWithin2Yr > 0 , MIN(TotalNZFREEZNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFREEZNonCatClmAmtWithin3Yr := IF(NumFREEZNonCatClmWithin3Yr > 0 , MIN(TotalNZFREEZNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFREEZNonCatClmAmtWithin4Yr := IF(NumFREEZNonCatClmWithin4Yr > 0 , MIN(TotalNZFREEZNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZFREEZNonCatClmAmtWithin5Yr := IF(NumFREEZNonCatClmWithin5Yr > 0 , MIN(TotalNZFREEZNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZFREEZNonCatClmAmtWithin1Yr   := IF(NumNZFREEZNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZFREEZNonCatClmAmtWithin1YrTemp/NumNZFREEZNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFREEZNonCatClmAmtWithin2Yr   := IF(NumNZFREEZNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZFREEZNonCatClmAmtWithin2YrTemp/NumNZFREEZNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFREEZNonCatClmAmtWithin3Yr   := IF(NumNZFREEZNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZFREEZNonCatClmAmtWithin3YrTemp/NumNZFREEZNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFREEZNonCatClmAmtWithin4Yr   := IF(NumNZFREEZNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZFREEZNonCatClmAmtWithin4YrTemp/NumNZFREEZNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZFREEZNonCatClmAmtWithin5Yr   := IF(NumNZFREEZNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZFREEZNonCatClmAmtWithin5YrTemp/NumNZFREEZNonCatClmWithin5Yr), 9999992), 9999999);


//HAIL claims
// ClaimsPropertyClaim: HAIL_CODE_LIST := ['HAIL'];
// ClaimsPropertyClaim: => IsHAILClaim := EXISTS (Payments(cClaimCatType IN HAIL_CODE_LIST));
// ClaimsPropertyClaim.Payments: => HAILClaimAmount := IF(cClaimCatType = 'HAIL', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalHAILClmAmtTemp := SUM(Payments, HAILClaimAmount);

ClaimsProperty: => NumHAILNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumHAILNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumHAILNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumHAILNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumHAILNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZHAILNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND TotalHAILClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZHAILNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND TotalHAILClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZHAILNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND TotalHAILClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZHAILNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND TotalHAILClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZHAILNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsHAILClaim = TRUE AND TotalHAILClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistHAILNonCatClmWithin1Yr   := IF( NumHAILNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistHAILNonCatClmWithin2Yr   := IF( NumHAILNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistHAILNonCatClmWithin3Yr   := IF( NumHAILNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistHAILNonCatClmWithin4Yr   := IF( NumHAILNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistHAILNonCatClmWithin5Yr   := IF( NumHAILNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZHAILNonCatClmWithin1Yr := IF( NumNZHAILNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZHAILNonCatClmWithin2Yr := IF( NumNZHAILNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZHAILNonCatClmWithin3Yr := IF( NumNZHAILNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZHAILNonCatClmWithin4Yr := IF( NumNZHAILNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZHAILNonCatClmWithin5Yr := IF( NumNZHAILNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZHAILNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalHAILClmAmtTemp);    
ClaimsProperty: => TotalNZHAILNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalHAILClmAmtTemp);    
ClaimsProperty: => TotalNZHAILNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalHAILClmAmtTemp);    
ClaimsProperty: => TotalNZHAILNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalHAILClmAmtTemp);    
ClaimsProperty: => TotalNZHAILNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalHAILClmAmtTemp);    
ClaimsProperty: => TotalNZHAILNonCatClmAmtWithin1Yr := IF(NumHAILNonCatClmWithin1Yr > 0 , MIN(TotalNZHAILNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZHAILNonCatClmAmtWithin2Yr := IF(NumHAILNonCatClmWithin2Yr > 0 , MIN(TotalNZHAILNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZHAILNonCatClmAmtWithin3Yr := IF(NumHAILNonCatClmWithin3Yr > 0 , MIN(TotalNZHAILNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZHAILNonCatClmAmtWithin4Yr := IF(NumHAILNonCatClmWithin4Yr > 0 , MIN(TotalNZHAILNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZHAILNonCatClmAmtWithin5Yr := IF(NumHAILNonCatClmWithin5Yr > 0 , MIN(TotalNZHAILNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZHAILNonCatClmAmtWithin1Yr   := IF(NumNZHAILNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZHAILNonCatClmAmtWithin1YrTemp/NumNZHAILNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZHAILNonCatClmAmtWithin2Yr   := IF(NumNZHAILNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZHAILNonCatClmAmtWithin2YrTemp/NumNZHAILNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZHAILNonCatClmAmtWithin3Yr   := IF(NumNZHAILNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZHAILNonCatClmAmtWithin3YrTemp/NumNZHAILNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZHAILNonCatClmAmtWithin4Yr   := IF(NumNZHAILNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZHAILNonCatClmAmtWithin4YrTemp/NumNZHAILNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZHAILNonCatClmAmtWithin5Yr   := IF(NumNZHAILNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZHAILNonCatClmAmtWithin5YrTemp/NumNZHAILNonCatClmWithin5Yr), 9999992), 9999999);


//LIAB claims
// ClaimsPropertyClaim: LIAB_CODE_LIST := ['LIAB'];
// ClaimsPropertyClaim: => IsLIABClaim := EXISTS (Payments(cClaimCatType IN LIAB_CODE_LIST));
// ClaimsPropertyClaim.Payments: => LIABClaimAmount := IF(cClaimCatType = 'LIAB', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalLIABClmAmtTemp := SUM(Payments, LIABClaimAmount);

ClaimsProperty: => NumLIABNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumLIABNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumLIABNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumLIABNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumLIABNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZLIABNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND TotalLIABClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZLIABNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND TotalLIABClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZLIABNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND TotalLIABClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZLIABNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND TotalLIABClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZLIABNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsLIABClaim = TRUE AND TotalLIABClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistLIABNonCatClmWithin1Yr   := IF( NumLIABNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIABNonCatClmWithin2Yr   := IF( NumLIABNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIABNonCatClmWithin3Yr   := IF( NumLIABNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIABNonCatClmWithin4Yr   := IF( NumLIABNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIABNonCatClmWithin5Yr   := IF( NumLIABNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIABNonCatClmWithin1Yr := IF( NumNZLIABNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIABNonCatClmWithin2Yr := IF( NumNZLIABNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIABNonCatClmWithin3Yr := IF( NumNZLIABNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIABNonCatClmWithin4Yr := IF( NumNZLIABNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIABNonCatClmWithin5Yr := IF( NumNZLIABNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZLIABNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalLIABClmAmtTemp);    
ClaimsProperty: => TotalNZLIABNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalLIABClmAmtTemp);    
ClaimsProperty: => TotalNZLIABNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalLIABClmAmtTemp);    
ClaimsProperty: => TotalNZLIABNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalLIABClmAmtTemp);    
ClaimsProperty: => TotalNZLIABNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalLIABClmAmtTemp);    
ClaimsProperty: => TotalNZLIABNonCatClmAmtWithin1Yr := IF(NumLIABNonCatClmWithin1Yr > 0 , MIN(TotalNZLIABNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIABNonCatClmAmtWithin2Yr := IF(NumLIABNonCatClmWithin2Yr > 0 , MIN(TotalNZLIABNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIABNonCatClmAmtWithin3Yr := IF(NumLIABNonCatClmWithin3Yr > 0 , MIN(TotalNZLIABNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIABNonCatClmAmtWithin4Yr := IF(NumLIABNonCatClmWithin4Yr > 0 , MIN(TotalNZLIABNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIABNonCatClmAmtWithin5Yr := IF(NumLIABNonCatClmWithin5Yr > 0 , MIN(TotalNZLIABNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZLIABNonCatClmAmtWithin1Yr   := IF(NumNZLIABNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZLIABNonCatClmAmtWithin1YrTemp/NumNZLIABNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIABNonCatClmAmtWithin2Yr   := IF(NumNZLIABNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZLIABNonCatClmAmtWithin2YrTemp/NumNZLIABNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIABNonCatClmAmtWithin3Yr   := IF(NumNZLIABNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZLIABNonCatClmAmtWithin3YrTemp/NumNZLIABNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIABNonCatClmAmtWithin4Yr   := IF(NumNZLIABNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZLIABNonCatClmAmtWithin4YrTemp/NumNZLIABNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIABNonCatClmAmtWithin5Yr   := IF(NumNZLIABNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZLIABNonCatClmAmtWithin5YrTemp/NumNZLIABNonCatClmWithin5Yr), 9999992), 9999999);


//LIGHT claims
// ClaimsPropertyClaim: LIGHT_CODE_LIST := ['LIGHT'];
// ClaimsPropertyClaim: => IsLIGHTClaim := EXISTS (Payments(cClaimCatType IN LIGHT_CODE_LIST));
// ClaimsPropertyClaim.Payments: => LIGHTClaimAmount := IF(cClaimCatType = 'LIGHT', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalLIGHTClmAmtTemp := SUM(Payments, LIGHTClaimAmount);

ClaimsProperty: => NumLIGHTNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumLIGHTNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumLIGHTNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumLIGHTNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumLIGHTNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZLIGHTNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND TotalLIGHTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZLIGHTNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND TotalLIGHTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZLIGHTNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND TotalLIGHTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZLIGHTNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND TotalLIGHTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZLIGHTNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsLIGHTClaim = TRUE AND TotalLIGHTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistLIGHTNonCatClmWithin1Yr   := IF( NumLIGHTNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIGHTNonCatClmWithin2Yr   := IF( NumLIGHTNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIGHTNonCatClmWithin3Yr   := IF( NumLIGHTNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIGHTNonCatClmWithin4Yr   := IF( NumLIGHTNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistLIGHTNonCatClmWithin5Yr   := IF( NumLIGHTNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIGHTNonCatClmWithin1Yr := IF( NumNZLIGHTNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIGHTNonCatClmWithin2Yr := IF( NumNZLIGHTNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIGHTNonCatClmWithin3Yr := IF( NumNZLIGHTNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIGHTNonCatClmWithin4Yr := IF( NumNZLIGHTNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZLIGHTNonCatClmWithin5Yr := IF( NumNZLIGHTNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZLIGHTNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalLIGHTClmAmtTemp);    
ClaimsProperty: => TotalNZLIGHTNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalLIGHTClmAmtTemp);    
ClaimsProperty: => TotalNZLIGHTNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalLIGHTClmAmtTemp);    
ClaimsProperty: => TotalNZLIGHTNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalLIGHTClmAmtTemp);    
ClaimsProperty: => TotalNZLIGHTNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalLIGHTClmAmtTemp);    
ClaimsProperty: => TotalNZLIGHTNonCatClmAmtWithin1Yr := IF(NumLIGHTNonCatClmWithin1Yr > 0 , MIN(TotalNZLIGHTNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIGHTNonCatClmAmtWithin2Yr := IF(NumLIGHTNonCatClmWithin2Yr > 0 , MIN(TotalNZLIGHTNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIGHTNonCatClmAmtWithin3Yr := IF(NumLIGHTNonCatClmWithin3Yr > 0 , MIN(TotalNZLIGHTNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIGHTNonCatClmAmtWithin4Yr := IF(NumLIGHTNonCatClmWithin4Yr > 0 , MIN(TotalNZLIGHTNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZLIGHTNonCatClmAmtWithin5Yr := IF(NumLIGHTNonCatClmWithin5Yr > 0 , MIN(TotalNZLIGHTNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZLIGHTNonCatClmAmtWithin1Yr   := IF(NumNZLIGHTNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZLIGHTNonCatClmAmtWithin1YrTemp/NumNZLIGHTNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIGHTNonCatClmAmtWithin2Yr   := IF(NumNZLIGHTNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZLIGHTNonCatClmAmtWithin2YrTemp/NumNZLIGHTNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIGHTNonCatClmAmtWithin3Yr   := IF(NumNZLIGHTNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZLIGHTNonCatClmAmtWithin3YrTemp/NumNZLIGHTNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIGHTNonCatClmAmtWithin4Yr   := IF(NumNZLIGHTNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZLIGHTNonCatClmAmtWithin4YrTemp/NumNZLIGHTNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZLIGHTNonCatClmAmtWithin5Yr   := IF(NumNZLIGHTNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZLIGHTNonCatClmAmtWithin5YrTemp/NumNZLIGHTNonCatClmWithin5Yr), 9999992), 9999999);


//MEDIC claims
// ClaimsPropertyClaim: MEDIC_CODE_LIST := ['MEDIC'];
// ClaimsPropertyClaim: => IsMEDICClaim := EXISTS (Payments(cClaimCatType IN MEDIC_CODE_LIST));
// ClaimsPropertyClaim.Payments: => MEDICClaimAmount := IF(cClaimCatType = 'MEDIC', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalMEDICClmAmtTemp := SUM(Payments, MEDICClaimAmount);

ClaimsProperty: => NumMEDICNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumMEDICNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumMEDICNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumMEDICNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumMEDICNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZMEDICNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND TotalMEDICClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZMEDICNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND TotalMEDICClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZMEDICNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND TotalMEDICClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZMEDICNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND TotalMEDICClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZMEDICNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsMEDICClaim = TRUE AND TotalMEDICClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistMEDICNonCatClmWithin1Yr   := IF( NumMEDICNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMEDICNonCatClmWithin2Yr   := IF( NumMEDICNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMEDICNonCatClmWithin3Yr   := IF( NumMEDICNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMEDICNonCatClmWithin4Yr   := IF( NumMEDICNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMEDICNonCatClmWithin5Yr   := IF( NumMEDICNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMEDICNonCatClmWithin1Yr := IF( NumNZMEDICNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMEDICNonCatClmWithin2Yr := IF( NumNZMEDICNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMEDICNonCatClmWithin3Yr := IF( NumNZMEDICNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMEDICNonCatClmWithin4Yr := IF( NumNZMEDICNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMEDICNonCatClmWithin5Yr := IF( NumNZMEDICNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZMEDICNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalMEDICClmAmtTemp);    
ClaimsProperty: => TotalNZMEDICNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalMEDICClmAmtTemp);    
ClaimsProperty: => TotalNZMEDICNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalMEDICClmAmtTemp);    
ClaimsProperty: => TotalNZMEDICNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalMEDICClmAmtTemp);    
ClaimsProperty: => TotalNZMEDICNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalMEDICClmAmtTemp);    
ClaimsProperty: => TotalNZMEDICNonCatClmAmtWithin1Yr := IF(NumMEDICNonCatClmWithin1Yr > 0 , MIN(TotalNZMEDICNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMEDICNonCatClmAmtWithin2Yr := IF(NumMEDICNonCatClmWithin2Yr > 0 , MIN(TotalNZMEDICNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMEDICNonCatClmAmtWithin3Yr := IF(NumMEDICNonCatClmWithin3Yr > 0 , MIN(TotalNZMEDICNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMEDICNonCatClmAmtWithin4Yr := IF(NumMEDICNonCatClmWithin4Yr > 0 , MIN(TotalNZMEDICNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMEDICNonCatClmAmtWithin5Yr := IF(NumMEDICNonCatClmWithin5Yr > 0 , MIN(TotalNZMEDICNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZMEDICNonCatClmAmtWithin1Yr   := IF(NumNZMEDICNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZMEDICNonCatClmAmtWithin1YrTemp/NumNZMEDICNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMEDICNonCatClmAmtWithin2Yr   := IF(NumNZMEDICNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZMEDICNonCatClmAmtWithin2YrTemp/NumNZMEDICNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMEDICNonCatClmAmtWithin3Yr   := IF(NumNZMEDICNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZMEDICNonCatClmAmtWithin3YrTemp/NumNZMEDICNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMEDICNonCatClmAmtWithin4Yr   := IF(NumNZMEDICNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZMEDICNonCatClmAmtWithin4YrTemp/NumNZMEDICNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMEDICNonCatClmAmtWithin5Yr   := IF(NumNZMEDICNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZMEDICNonCatClmAmtWithin5YrTemp/NumNZMEDICNonCatClmWithin5Yr), 9999992), 9999999);


//MOVE claims
// ClaimsPropertyClaim: MOVE_CODE_LIST := ['MOVE'];
// ClaimsPropertyClaim: => IsMOVEClaim := EXISTS (Payments(cClaimCatType IN MOVE_CODE_LIST));
// ClaimsPropertyClaim.Payments: => MOVEClaimAmount := IF(cClaimCatType = 'MOVE', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalMOVEClmAmtTemp := SUM(Payments, MOVEClaimAmount);

ClaimsProperty: => NumMOVENonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumMOVENonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumMOVENonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumMOVENonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumMOVENonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZMOVENonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND TotalMOVEClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZMOVENonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND TotalMOVEClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZMOVENonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND TotalMOVEClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZMOVENonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND TotalMOVEClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZMOVENonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsMOVEClaim = TRUE AND TotalMOVEClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistMOVENonCatClmWithin1Yr   := IF( NumMOVENonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMOVENonCatClmWithin2Yr   := IF( NumMOVENonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMOVENonCatClmWithin3Yr   := IF( NumMOVENonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMOVENonCatClmWithin4Yr   := IF( NumMOVENonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistMOVENonCatClmWithin5Yr   := IF( NumMOVENonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMOVENonCatClmWithin1Yr := IF( NumNZMOVENonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMOVENonCatClmWithin2Yr := IF( NumNZMOVENonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMOVENonCatClmWithin3Yr := IF( NumNZMOVENonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMOVENonCatClmWithin4Yr := IF( NumNZMOVENonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZMOVENonCatClmWithin5Yr := IF( NumNZMOVENonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZMOVENonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalMOVEClmAmtTemp);    
ClaimsProperty: => TotalNZMOVENonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalMOVEClmAmtTemp);    
ClaimsProperty: => TotalNZMOVENonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalMOVEClmAmtTemp);    
ClaimsProperty: => TotalNZMOVENonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalMOVEClmAmtTemp);    
ClaimsProperty: => TotalNZMOVENonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalMOVEClmAmtTemp);    
ClaimsProperty: => TotalNZMOVENonCatClmAmtWithin1Yr := IF(NumMOVENonCatClmWithin1Yr > 0 , MIN(TotalNZMOVENonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMOVENonCatClmAmtWithin2Yr := IF(NumMOVENonCatClmWithin2Yr > 0 , MIN(TotalNZMOVENonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMOVENonCatClmAmtWithin3Yr := IF(NumMOVENonCatClmWithin3Yr > 0 , MIN(TotalNZMOVENonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMOVENonCatClmAmtWithin4Yr := IF(NumMOVENonCatClmWithin4Yr > 0 , MIN(TotalNZMOVENonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZMOVENonCatClmAmtWithin5Yr := IF(NumMOVENonCatClmWithin5Yr > 0 , MIN(TotalNZMOVENonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZMOVENonCatClmAmtWithin1Yr   := IF(NumNZMOVENonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZMOVENonCatClmAmtWithin1YrTemp/NumNZMOVENonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMOVENonCatClmAmtWithin2Yr   := IF(NumNZMOVENonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZMOVENonCatClmAmtWithin2YrTemp/NumNZMOVENonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMOVENonCatClmAmtWithin3Yr   := IF(NumNZMOVENonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZMOVENonCatClmAmtWithin3YrTemp/NumNZMOVENonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMOVENonCatClmAmtWithin4Yr   := IF(NumNZMOVENonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZMOVENonCatClmAmtWithin4YrTemp/NumNZMOVENonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZMOVENonCatClmAmtWithin5Yr   := IF(NumNZMOVENonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZMOVENonCatClmAmtWithin5YrTemp/NumNZMOVENonCatClmWithin5Yr), 9999992), 9999999);


//OTHER claims
// ClaimsPropertyClaim: OTHER_CODE_LIST := ['OTHER'];
// ClaimsPropertyClaim: => IsOTHERClaim := EXISTS (Payments(cClaimCatType IN OTHER_CODE_LIST));
// ClaimsPropertyClaim.Payments: => OTHERClaimAmount := IF(cClaimCatType = 'OTHER', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalOTHERClmAmtTemp := SUM(Payments, OTHERClaimAmount);

ClaimsProperty: => NumOTHERNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumOTHERNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumOTHERNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumOTHERNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumOTHERNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZOTHERNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND TotalOTHERClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZOTHERNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND TotalOTHERClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZOTHERNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND TotalOTHERClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZOTHERNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND TotalOTHERClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZOTHERNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsOTHERClaim = TRUE AND TotalOTHERClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistOTHERNonCatClmWithin1Yr   := IF( NumOTHERNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistOTHERNonCatClmWithin2Yr   := IF( NumOTHERNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistOTHERNonCatClmWithin3Yr   := IF( NumOTHERNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistOTHERNonCatClmWithin4Yr   := IF( NumOTHERNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistOTHERNonCatClmWithin5Yr   := IF( NumOTHERNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZOTHERNonCatClmWithin1Yr := IF( NumNZOTHERNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZOTHERNonCatClmWithin2Yr := IF( NumNZOTHERNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZOTHERNonCatClmWithin3Yr := IF( NumNZOTHERNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZOTHERNonCatClmWithin4Yr := IF( NumNZOTHERNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZOTHERNonCatClmWithin5Yr := IF( NumNZOTHERNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZOTHERNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalOTHERClmAmtTemp);    
ClaimsProperty: => TotalNZOTHERNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalOTHERClmAmtTemp);    
ClaimsProperty: => TotalNZOTHERNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalOTHERClmAmtTemp);    
ClaimsProperty: => TotalNZOTHERNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalOTHERClmAmtTemp);    
ClaimsProperty: => TotalNZOTHERNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalOTHERClmAmtTemp);    
ClaimsProperty: => TotalNZOTHERNonCatClmAmtWithin1Yr := IF(NumOTHERNonCatClmWithin1Yr > 0 , MIN(TotalNZOTHERNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZOTHERNonCatClmAmtWithin2Yr := IF(NumOTHERNonCatClmWithin2Yr > 0 , MIN(TotalNZOTHERNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZOTHERNonCatClmAmtWithin3Yr := IF(NumOTHERNonCatClmWithin3Yr > 0 , MIN(TotalNZOTHERNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZOTHERNonCatClmAmtWithin4Yr := IF(NumOTHERNonCatClmWithin4Yr > 0 , MIN(TotalNZOTHERNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZOTHERNonCatClmAmtWithin5Yr := IF(NumOTHERNonCatClmWithin5Yr > 0 , MIN(TotalNZOTHERNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZOTHERNonCatClmAmtWithin1Yr   := IF(NumNZOTHERNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZOTHERNonCatClmAmtWithin1YrTemp/NumNZOTHERNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZOTHERNonCatClmAmtWithin2Yr   := IF(NumNZOTHERNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZOTHERNonCatClmAmtWithin2YrTemp/NumNZOTHERNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZOTHERNonCatClmAmtWithin3Yr   := IF(NumNZOTHERNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZOTHERNonCatClmAmtWithin3YrTemp/NumNZOTHERNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZOTHERNonCatClmAmtWithin4Yr   := IF(NumNZOTHERNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZOTHERNonCatClmAmtWithin4YrTemp/NumNZOTHERNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZOTHERNonCatClmAmtWithin5Yr   := IF(NumNZOTHERNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZOTHERNonCatClmAmtWithin5YrTemp/NumNZOTHERNonCatClmWithin5Yr), 9999992), 9999999);


//PHYDA claims
// ClaimsPropertyClaim: PHYDA_CODE_LIST := ['PHYDA'];
// ClaimsPropertyClaim: => IsPHYDAClaim := EXISTS (Payments(cClaimCatType IN PHYDA_CODE_LIST));
// ClaimsPropertyClaim.Payments: => PHYDAClaimAmount := IF(cClaimCatType = 'PHYDA', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalPHYDAClmAmtTemp := SUM(Payments, PHYDAClaimAmount);

ClaimsProperty: => NumPHYDANonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumPHYDANonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumPHYDANonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumPHYDANonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumPHYDANonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZPHYDANonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND TotalPHYDAClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZPHYDANonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND TotalPHYDAClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZPHYDANonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND TotalPHYDAClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZPHYDANonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND TotalPHYDAClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZPHYDANonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsPHYDAClaim = TRUE AND TotalPHYDAClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistPHYDANonCatClmWithin1Yr   := IF( NumPHYDANonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistPHYDANonCatClmWithin2Yr   := IF( NumPHYDANonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistPHYDANonCatClmWithin3Yr   := IF( NumPHYDANonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistPHYDANonCatClmWithin4Yr   := IF( NumPHYDANonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistPHYDANonCatClmWithin5Yr   := IF( NumPHYDANonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZPHYDANonCatClmWithin1Yr := IF( NumNZPHYDANonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZPHYDANonCatClmWithin2Yr := IF( NumNZPHYDANonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZPHYDANonCatClmWithin3Yr := IF( NumNZPHYDANonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZPHYDANonCatClmWithin4Yr := IF( NumNZPHYDANonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZPHYDANonCatClmWithin5Yr := IF( NumNZPHYDANonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZPHYDANonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalPHYDAClmAmtTemp);    
ClaimsProperty: => TotalNZPHYDANonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalPHYDAClmAmtTemp);    
ClaimsProperty: => TotalNZPHYDANonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalPHYDAClmAmtTemp);    
ClaimsProperty: => TotalNZPHYDANonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalPHYDAClmAmtTemp);    
ClaimsProperty: => TotalNZPHYDANonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalPHYDAClmAmtTemp);    
ClaimsProperty: => TotalNZPHYDANonCatClmAmtWithin1Yr := IF(NumPHYDANonCatClmWithin1Yr > 0 , MIN(TotalNZPHYDANonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZPHYDANonCatClmAmtWithin2Yr := IF(NumPHYDANonCatClmWithin2Yr > 0 , MIN(TotalNZPHYDANonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZPHYDANonCatClmAmtWithin3Yr := IF(NumPHYDANonCatClmWithin3Yr > 0 , MIN(TotalNZPHYDANonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZPHYDANonCatClmAmtWithin4Yr := IF(NumPHYDANonCatClmWithin4Yr > 0 , MIN(TotalNZPHYDANonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZPHYDANonCatClmAmtWithin5Yr := IF(NumPHYDANonCatClmWithin5Yr > 0 , MIN(TotalNZPHYDANonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZPHYDANonCatClmAmtWithin1Yr   := IF(NumNZPHYDANonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZPHYDANonCatClmAmtWithin1YrTemp/NumNZPHYDANonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZPHYDANonCatClmAmtWithin2Yr   := IF(NumNZPHYDANonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZPHYDANonCatClmAmtWithin2YrTemp/NumNZPHYDANonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZPHYDANonCatClmAmtWithin3Yr   := IF(NumNZPHYDANonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZPHYDANonCatClmAmtWithin3YrTemp/NumNZPHYDANonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZPHYDANonCatClmAmtWithin4Yr   := IF(NumNZPHYDANonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZPHYDANonCatClmAmtWithin4YrTemp/NumNZPHYDANonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZPHYDANonCatClmAmtWithin5Yr   := IF(NumNZPHYDANonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZPHYDANonCatClmAmtWithin5YrTemp/NumNZPHYDANonCatClmWithin5Yr), 9999992), 9999999);


//SLIP claims
// ClaimsPropertyClaim: SLIP_CODE_LIST := ['SLIP'];
// ClaimsPropertyClaim: => IsSLIPClaim := EXISTS (Payments(cClaimCatType IN SLIP_CODE_LIST));
// ClaimsPropertyClaim.Payments: => SLIPClaimAmount := IF(cClaimCatType = 'SLIP', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalSLIPClmAmtTemp := SUM(Payments, SLIPClaimAmount);

ClaimsProperty: => NumSLIPNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumSLIPNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumSLIPNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumSLIPNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumSLIPNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZSLIPNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND TotalSLIPClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZSLIPNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND TotalSLIPClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZSLIPNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND TotalSLIPClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZSLIPNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND TotalSLIPClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZSLIPNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsSLIPClaim = TRUE AND TotalSLIPClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistSLIPNonCatClmWithin1Yr   := IF( NumSLIPNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSLIPNonCatClmWithin2Yr   := IF( NumSLIPNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSLIPNonCatClmWithin3Yr   := IF( NumSLIPNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSLIPNonCatClmWithin4Yr   := IF( NumSLIPNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSLIPNonCatClmWithin5Yr   := IF( NumSLIPNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSLIPNonCatClmWithin1Yr := IF( NumNZSLIPNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSLIPNonCatClmWithin2Yr := IF( NumNZSLIPNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSLIPNonCatClmWithin3Yr := IF( NumNZSLIPNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSLIPNonCatClmWithin4Yr := IF( NumNZSLIPNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSLIPNonCatClmWithin5Yr := IF( NumNZSLIPNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZSLIPNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalSLIPClmAmtTemp);    
ClaimsProperty: => TotalNZSLIPNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalSLIPClmAmtTemp);    
ClaimsProperty: => TotalNZSLIPNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalSLIPClmAmtTemp);    
ClaimsProperty: => TotalNZSLIPNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalSLIPClmAmtTemp);    
ClaimsProperty: => TotalNZSLIPNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalSLIPClmAmtTemp);    
ClaimsProperty: => TotalNZSLIPNonCatClmAmtWithin1Yr := IF(NumSLIPNonCatClmWithin1Yr > 0 , MIN(TotalNZSLIPNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSLIPNonCatClmAmtWithin2Yr := IF(NumSLIPNonCatClmWithin2Yr > 0 , MIN(TotalNZSLIPNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSLIPNonCatClmAmtWithin3Yr := IF(NumSLIPNonCatClmWithin3Yr > 0 , MIN(TotalNZSLIPNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSLIPNonCatClmAmtWithin4Yr := IF(NumSLIPNonCatClmWithin4Yr > 0 , MIN(TotalNZSLIPNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSLIPNonCatClmAmtWithin5Yr := IF(NumSLIPNonCatClmWithin5Yr > 0 , MIN(TotalNZSLIPNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZSLIPNonCatClmAmtWithin1Yr   := IF(NumNZSLIPNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZSLIPNonCatClmAmtWithin1YrTemp/NumNZSLIPNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSLIPNonCatClmAmtWithin2Yr   := IF(NumNZSLIPNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZSLIPNonCatClmAmtWithin2YrTemp/NumNZSLIPNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSLIPNonCatClmAmtWithin3Yr   := IF(NumNZSLIPNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZSLIPNonCatClmAmtWithin3YrTemp/NumNZSLIPNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSLIPNonCatClmAmtWithin4Yr   := IF(NumNZSLIPNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZSLIPNonCatClmAmtWithin4YrTemp/NumNZSLIPNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSLIPNonCatClmAmtWithin5Yr   := IF(NumNZSLIPNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZSLIPNonCatClmAmtWithin5YrTemp/NumNZSLIPNonCatClmWithin5Yr), 9999992), 9999999);


//SMOKE claims
// ClaimsPropertyClaim: SMOKE_CODE_LIST := ['SMOKE'];
// ClaimsPropertyClaim: => IsSMOKEClaim := EXISTS (Payments(cClaimCatType IN SMOKE_CODE_LIST));
// ClaimsPropertyClaim.Payments: => SMOKEClaimAmount := IF(cClaimCatType = 'SMOKE', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalSMOKEClmAmtTemp := SUM(Payments, SMOKEClaimAmount);

ClaimsProperty: => NumSMOKENonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumSMOKENonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumSMOKENonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumSMOKENonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumSMOKENonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZSMOKENonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND TotalSMOKEClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZSMOKENonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND TotalSMOKEClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZSMOKENonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND TotalSMOKEClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZSMOKENonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND TotalSMOKEClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZSMOKENonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsSMOKEClaim = TRUE AND TotalSMOKEClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistSMOKENonCatClmWithin1Yr   := IF( NumSMOKENonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSMOKENonCatClmWithin2Yr   := IF( NumSMOKENonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSMOKENonCatClmWithin3Yr   := IF( NumSMOKENonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSMOKENonCatClmWithin4Yr   := IF( NumSMOKENonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistSMOKENonCatClmWithin5Yr   := IF( NumSMOKENonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSMOKENonCatClmWithin1Yr := IF( NumNZSMOKENonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSMOKENonCatClmWithin2Yr := IF( NumNZSMOKENonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSMOKENonCatClmWithin3Yr := IF( NumNZSMOKENonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSMOKENonCatClmWithin4Yr := IF( NumNZSMOKENonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZSMOKENonCatClmWithin5Yr := IF( NumNZSMOKENonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZSMOKENonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalSMOKEClmAmtTemp);    
ClaimsProperty: => TotalNZSMOKENonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalSMOKEClmAmtTemp);    
ClaimsProperty: => TotalNZSMOKENonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalSMOKEClmAmtTemp);    
ClaimsProperty: => TotalNZSMOKENonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalSMOKEClmAmtTemp);    
ClaimsProperty: => TotalNZSMOKENonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalSMOKEClmAmtTemp);    
ClaimsProperty: => TotalNZSMOKENonCatClmAmtWithin1Yr := IF(NumSMOKENonCatClmWithin1Yr > 0 , MIN(TotalNZSMOKENonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSMOKENonCatClmAmtWithin2Yr := IF(NumSMOKENonCatClmWithin2Yr > 0 , MIN(TotalNZSMOKENonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSMOKENonCatClmAmtWithin3Yr := IF(NumSMOKENonCatClmWithin3Yr > 0 , MIN(TotalNZSMOKENonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSMOKENonCatClmAmtWithin4Yr := IF(NumSMOKENonCatClmWithin4Yr > 0 , MIN(TotalNZSMOKENonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZSMOKENonCatClmAmtWithin5Yr := IF(NumSMOKENonCatClmWithin5Yr > 0 , MIN(TotalNZSMOKENonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZSMOKENonCatClmAmtWithin1Yr   := IF(NumNZSMOKENonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZSMOKENonCatClmAmtWithin1YrTemp/NumNZSMOKENonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSMOKENonCatClmAmtWithin2Yr   := IF(NumNZSMOKENonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZSMOKENonCatClmAmtWithin2YrTemp/NumNZSMOKENonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSMOKENonCatClmAmtWithin3Yr   := IF(NumNZSMOKENonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZSMOKENonCatClmAmtWithin3YrTemp/NumNZSMOKENonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSMOKENonCatClmAmtWithin4Yr   := IF(NumNZSMOKENonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZSMOKENonCatClmAmtWithin4YrTemp/NumNZSMOKENonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZSMOKENonCatClmAmtWithin5Yr   := IF(NumNZSMOKENonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZSMOKENonCatClmAmtWithin5YrTemp/NumNZSMOKENonCatClmWithin5Yr), 9999992), 9999999);


//THEFT claims
// ClaimsPropertyClaim: THEFT_CODE_LIST := ['THEFT'];
// ClaimsPropertyClaim: => IsTHEFTClaim := EXISTS (Payments(cClaimCatType IN THEFT_CODE_LIST));
// ClaimsPropertyClaim.Payments: => THEFTClaimAmount := IF(cClaimCatType = 'THEFT', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalTHEFTClmAmtTemp := SUM(Payments, THEFTClaimAmount);

ClaimsProperty: => NumTHEFTNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumTHEFTNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumTHEFTNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumTHEFTNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumTHEFTNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZTHEFTNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND TotalTHEFTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZTHEFTNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND TotalTHEFTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZTHEFTNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND TotalTHEFTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZTHEFTNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND TotalTHEFTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZTHEFTNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsTHEFTClaim = TRUE AND TotalTHEFTClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistTHEFTNonCatClmWithin1Yr   := IF( NumTHEFTNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHEFTNonCatClmWithin2Yr   := IF( NumTHEFTNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHEFTNonCatClmWithin3Yr   := IF( NumTHEFTNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHEFTNonCatClmWithin4Yr   := IF( NumTHEFTNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHEFTNonCatClmWithin5Yr   := IF( NumTHEFTNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHEFTNonCatClmWithin1Yr := IF( NumNZTHEFTNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHEFTNonCatClmWithin2Yr := IF( NumNZTHEFTNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHEFTNonCatClmWithin3Yr := IF( NumNZTHEFTNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHEFTNonCatClmWithin4Yr := IF( NumNZTHEFTNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHEFTNonCatClmWithin5Yr := IF( NumNZTHEFTNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZTHEFTNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalTHEFTClmAmtTemp);    
ClaimsProperty: => TotalNZTHEFTNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalTHEFTClmAmtTemp);    
ClaimsProperty: => TotalNZTHEFTNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalTHEFTClmAmtTemp);    
ClaimsProperty: => TotalNZTHEFTNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalTHEFTClmAmtTemp);    
ClaimsProperty: => TotalNZTHEFTNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalTHEFTClmAmtTemp);    
ClaimsProperty: => TotalNZTHEFTNonCatClmAmtWithin1Yr := IF(NumTHEFTNonCatClmWithin1Yr > 0 , MIN(TotalNZTHEFTNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHEFTNonCatClmAmtWithin2Yr := IF(NumTHEFTNonCatClmWithin2Yr > 0 , MIN(TotalNZTHEFTNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHEFTNonCatClmAmtWithin3Yr := IF(NumTHEFTNonCatClmWithin3Yr > 0 , MIN(TotalNZTHEFTNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHEFTNonCatClmAmtWithin4Yr := IF(NumTHEFTNonCatClmWithin4Yr > 0 , MIN(TotalNZTHEFTNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHEFTNonCatClmAmtWithin5Yr := IF(NumTHEFTNonCatClmWithin5Yr > 0 , MIN(TotalNZTHEFTNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZTHEFTNonCatClmAmtWithin1Yr   := IF(NumNZTHEFTNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZTHEFTNonCatClmAmtWithin1YrTemp/NumNZTHEFTNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHEFTNonCatClmAmtWithin2Yr   := IF(NumNZTHEFTNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZTHEFTNonCatClmAmtWithin2YrTemp/NumNZTHEFTNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHEFTNonCatClmAmtWithin3Yr   := IF(NumNZTHEFTNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZTHEFTNonCatClmAmtWithin3YrTemp/NumNZTHEFTNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHEFTNonCatClmAmtWithin4Yr   := IF(NumNZTHEFTNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZTHEFTNonCatClmAmtWithin4YrTemp/NumNZTHEFTNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHEFTNonCatClmAmtWithin5Yr   := IF(NumNZTHEFTNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZTHEFTNonCatClmAmtWithin5YrTemp/NumNZTHEFTNonCatClmWithin5Yr), 9999992), 9999999);

//THFSC claims
// ClaimsPropertyClaim: THFSC_CODE_LIST := ['THFSC'];
// ClaimsPropertyClaim: => IsTHFSCClaim := EXISTS (Payments(cClaimCatType IN THFSC_CODE_LIST));
// ClaimsPropertyClaim.Payments: => THFSCClaimAmount := IF(cClaimCatType = 'THFSC', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalTHFSCClmAmtTemp := SUM(Payments, THFSCClaimAmount);

ClaimsProperty: => NumTHFSCNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumTHFSCNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumTHFSCNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumTHFSCNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumTHFSCNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZTHFSCNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND TotalTHFSCClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZTHFSCNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND TotalTHFSCClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZTHFSCNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND TotalTHFSCClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZTHFSCNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND TotalTHFSCClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZTHFSCNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsTHFSCClaim = TRUE AND TotalTHFSCClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistTHFSCNonCatClmWithin1Yr   := IF( NumTHFSCNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHFSCNonCatClmWithin2Yr   := IF( NumTHFSCNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHFSCNonCatClmWithin3Yr   := IF( NumTHFSCNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHFSCNonCatClmWithin4Yr   := IF( NumTHFSCNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistTHFSCNonCatClmWithin5Yr   := IF( NumTHFSCNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHFSCNonCatClmWithin1Yr := IF( NumNZTHFSCNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHFSCNonCatClmWithin2Yr := IF( NumNZTHFSCNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHFSCNonCatClmWithin3Yr := IF( NumNZTHFSCNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHFSCNonCatClmWithin4Yr := IF( NumNZTHFSCNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZTHFSCNonCatClmWithin5Yr := IF( NumNZTHFSCNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZTHFSCNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalTHFSCClmAmtTemp);    
ClaimsProperty: => TotalNZTHFSCNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalTHFSCClmAmtTemp);    
ClaimsProperty: => TotalNZTHFSCNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalTHFSCClmAmtTemp);    
ClaimsProperty: => TotalNZTHFSCNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalTHFSCClmAmtTemp);    
ClaimsProperty: => TotalNZTHFSCNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalTHFSCClmAmtTemp);    
ClaimsProperty: => TotalNZTHFSCNonCatClmAmtWithin1Yr := IF(NumTHFSCNonCatClmWithin1Yr > 0 , MIN(TotalNZTHFSCNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHFSCNonCatClmAmtWithin2Yr := IF(NumTHFSCNonCatClmWithin2Yr > 0 , MIN(TotalNZTHFSCNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHFSCNonCatClmAmtWithin3Yr := IF(NumTHFSCNonCatClmWithin3Yr > 0 , MIN(TotalNZTHFSCNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHFSCNonCatClmAmtWithin4Yr := IF(NumTHFSCNonCatClmWithin4Yr > 0 , MIN(TotalNZTHFSCNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZTHFSCNonCatClmAmtWithin5Yr := IF(NumTHFSCNonCatClmWithin5Yr > 0 , MIN(TotalNZTHFSCNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZTHFSCNonCatClmAmtWithin1Yr   := IF(NumNZTHFSCNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZTHFSCNonCatClmAmtWithin1YrTemp/NumNZTHFSCNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHFSCNonCatClmAmtWithin2Yr   := IF(NumNZTHFSCNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZTHFSCNonCatClmAmtWithin2YrTemp/NumNZTHFSCNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHFSCNonCatClmAmtWithin3Yr   := IF(NumNZTHFSCNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZTHFSCNonCatClmAmtWithin3YrTemp/NumNZTHFSCNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHFSCNonCatClmAmtWithin4Yr   := IF(NumNZTHFSCNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZTHFSCNonCatClmAmtWithin4YrTemp/NumNZTHFSCNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZTHFSCNonCatClmAmtWithin5Yr   := IF(NumNZTHFSCNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZTHFSCNonCatClmAmtWithin5YrTemp/NumNZTHFSCNonCatClmWithin5Yr), 9999992), 9999999);


//VMM claims
// ClaimsPropertyClaim: VMM_CODE_LIST := ['VMM'];
// ClaimsPropertyClaim: => IsVMMClaim := EXISTS (Payments(cClaimCatType IN VMM_CODE_LIST));
// ClaimsPropertyClaim.Payments: => VMMClaimAmount := IF(cClaimCatType = 'VMM', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalVMMClmAmtTemp := SUM(Payments, VMMClaimAmount);

ClaimsProperty: => NumVMMNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumVMMNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumVMMNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumVMMNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumVMMNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZVMMNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND TotalVMMClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZVMMNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND TotalVMMClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZVMMNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND TotalVMMClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZVMMNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND TotalVMMClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZVMMNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsVMMClaim = TRUE AND TotalVMMClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistVMMNonCatClmWithin1Yr   := IF( NumVMMNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistVMMNonCatClmWithin2Yr   := IF( NumVMMNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistVMMNonCatClmWithin3Yr   := IF( NumVMMNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistVMMNonCatClmWithin4Yr   := IF( NumVMMNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistVMMNonCatClmWithin5Yr   := IF( NumVMMNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZVMMNonCatClmWithin1Yr := IF( NumNZVMMNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZVMMNonCatClmWithin2Yr := IF( NumNZVMMNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZVMMNonCatClmWithin3Yr := IF( NumNZVMMNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZVMMNonCatClmWithin4Yr := IF( NumNZVMMNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZVMMNonCatClmWithin5Yr := IF( NumNZVMMNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZVMMNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalVMMClmAmtTemp);    
ClaimsProperty: => TotalNZVMMNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalVMMClmAmtTemp);    
ClaimsProperty: => TotalNZVMMNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalVMMClmAmtTemp);    
ClaimsProperty: => TotalNZVMMNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalVMMClmAmtTemp);    
ClaimsProperty: => TotalNZVMMNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalVMMClmAmtTemp);    
ClaimsProperty: => TotalNZVMMNonCatClmAmtWithin1Yr := IF(NumVMMNonCatClmWithin1Yr > 0 , MIN(TotalNZVMMNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZVMMNonCatClmAmtWithin2Yr := IF(NumVMMNonCatClmWithin2Yr > 0 , MIN(TotalNZVMMNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZVMMNonCatClmAmtWithin3Yr := IF(NumVMMNonCatClmWithin3Yr > 0 , MIN(TotalNZVMMNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZVMMNonCatClmAmtWithin4Yr := IF(NumVMMNonCatClmWithin4Yr > 0 , MIN(TotalNZVMMNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZVMMNonCatClmAmtWithin5Yr := IF(NumVMMNonCatClmWithin5Yr > 0 , MIN(TotalNZVMMNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZVMMNonCatClmAmtWithin1Yr   := IF(NumNZVMMNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZVMMNonCatClmAmtWithin1YrTemp/NumNZVMMNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZVMMNonCatClmAmtWithin2Yr   := IF(NumNZVMMNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZVMMNonCatClmAmtWithin2YrTemp/NumNZVMMNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZVMMNonCatClmAmtWithin3Yr   := IF(NumNZVMMNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZVMMNonCatClmAmtWithin3YrTemp/NumNZVMMNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZVMMNonCatClmAmtWithin4Yr   := IF(NumNZVMMNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZVMMNonCatClmAmtWithin4YrTemp/NumNZVMMNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZVMMNonCatClmAmtWithin5Yr   := IF(NumNZVMMNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZVMMNonCatClmAmtWithin5YrTemp/NumNZVMMNonCatClmWithin5Yr), 9999992), 9999999);

//WATER claims
// ClaimsPropertyClaim: WATER_CODE_LIST := ['WATER'];
// ClaimsPropertyClaim: => IsWATERClaim := EXISTS (Payments(cClaimCatType IN WATER_CODE_LIST));
// ClaimsPropertyClaim.Payments: => WATERClaimAmount := IF(cClaimCatType = 'WATER', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalWATERClmAmtTemp := SUM(Payments, WATERClaimAmount);

ClaimsProperty: => NumWATERNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumWATERNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumWATERNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumWATERNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumWATERNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZWATERNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND TotalWATERClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZWATERNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND TotalWATERClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZWATERNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND TotalWATERClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZWATERNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND TotalWATERClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZWATERNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsWATERClaim = TRUE AND TotalWATERClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistWATERNonCatClmWithin1Yr   := IF( NumWATERNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWATERNonCatClmWithin2Yr   := IF( NumWATERNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWATERNonCatClmWithin3Yr   := IF( NumWATERNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWATERNonCatClmWithin4Yr   := IF( NumWATERNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWATERNonCatClmWithin5Yr   := IF( NumWATERNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWATERNonCatClmWithin1Yr := IF( NumNZWATERNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWATERNonCatClmWithin2Yr := IF( NumNZWATERNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWATERNonCatClmWithin3Yr := IF( NumNZWATERNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWATERNonCatClmWithin4Yr := IF( NumNZWATERNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWATERNonCatClmWithin5Yr := IF( NumNZWATERNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZWATERNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalWATERClmAmtTemp);    
ClaimsProperty: => TotalNZWATERNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalWATERClmAmtTemp);    
ClaimsProperty: => TotalNZWATERNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalWATERClmAmtTemp);    
ClaimsProperty: => TotalNZWATERNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalWATERClmAmtTemp);    
ClaimsProperty: => TotalNZWATERNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalWATERClmAmtTemp);    
ClaimsProperty: => TotalNZWATERNonCatClmAmtWithin1Yr := IF(NumWATERNonCatClmWithin1Yr > 0 , MIN(TotalNZWATERNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWATERNonCatClmAmtWithin2Yr := IF(NumWATERNonCatClmWithin2Yr > 0 , MIN(TotalNZWATERNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWATERNonCatClmAmtWithin3Yr := IF(NumWATERNonCatClmWithin3Yr > 0 , MIN(TotalNZWATERNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWATERNonCatClmAmtWithin4Yr := IF(NumWATERNonCatClmWithin4Yr > 0 , MIN(TotalNZWATERNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWATERNonCatClmAmtWithin5Yr := IF(NumWATERNonCatClmWithin5Yr > 0 , MIN(TotalNZWATERNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZWATERNonCatClmAmtWithin1Yr   := IF(NumNZWATERNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZWATERNonCatClmAmtWithin1YrTemp/NumNZWATERNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWATERNonCatClmAmtWithin2Yr   := IF(NumNZWATERNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZWATERNonCatClmAmtWithin2YrTemp/NumNZWATERNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWATERNonCatClmAmtWithin3Yr   := IF(NumNZWATERNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZWATERNonCatClmAmtWithin3YrTemp/NumNZWATERNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWATERNonCatClmAmtWithin4Yr   := IF(NumNZWATERNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZWATERNonCatClmAmtWithin4YrTemp/NumNZWATERNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWATERNonCatClmAmtWithin5Yr   := IF(NumNZWATERNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZWATERNonCatClmAmtWithin5YrTemp/NumNZWATERNonCatClmWithin5Yr), 9999992), 9999999);


//WIND claims
// ClaimsPropertyClaim: WIND_CODE_LIST := ['WIND'];
// ClaimsPropertyClaim: => IsWINDClaim := EXISTS (Payments(cClaimCatType IN WIND_CODE_LIST));
// ClaimsPropertyClaim.Payments: => WINDClaimAmount := IF(cClaimCatType = 'WIND', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalWINDClmAmtTemp := SUM(Payments, WINDClaimAmount);

ClaimsProperty: => NumWINDNonCatClmWithin1Yr     := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumWINDNonCatClmWithin2Yr     := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumWINDNonCatClmWithin3Yr     := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumWINDNonCatClmWithin4Yr     := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumWINDNonCatClmWithin5Yr     := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND TotalClaimAmtComp > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => NumNZWINDNonCatClmWithin1Yr   := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND TotalWINDClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
ClaimsProperty: => NumNZWINDNonCatClmWithin2Yr   := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND TotalWINDClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
ClaimsProperty: => NumNZWINDNonCatClmWithin3Yr   := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND TotalWINDClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
ClaimsProperty: => NumNZWINDNonCatClmWithin4Yr   := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND TotalWINDClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
ClaimsProperty: => NumNZWINDNonCatClmWithin5Yr   := COUNT(ClaimsPropertyClaim(IsWINDClaim = TRUE AND TotalWINDClmAmtTemp > 0 AND cAtFaultIndicator != 'Y' AND TotalClaimAmtComp > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));
ClaimsProperty: => ExistWINDNonCatClmWithin1Yr   := IF( NumWINDNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWINDNonCatClmWithin2Yr   := IF( NumWINDNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWINDNonCatClmWithin3Yr   := IF( NumWINDNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWINDNonCatClmWithin4Yr   := IF( NumWINDNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistWINDNonCatClmWithin5Yr   := IF( NumWINDNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWINDNonCatClmWithin1Yr := IF( NumNZWINDNonCatClmWithin1Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWINDNonCatClmWithin2Yr := IF( NumNZWINDNonCatClmWithin2Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWINDNonCatClmWithin3Yr := IF( NumNZWINDNonCatClmWithin3Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWINDNonCatClmWithin4Yr := IF( NumNZWINDNonCatClmWithin4Yr >= 1 , 1, 0);
ClaimsProperty: => ExistNZWINDNonCatClmWithin5Yr := IF( NumNZWINDNonCatClmWithin5Yr >= 1 , 1, 0);
ClaimsProperty: => TotalNZWINDNonCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalWINDClmAmtTemp);    
ClaimsProperty: => TotalNZWINDNonCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalWINDClmAmtTemp);    
ClaimsProperty: => TotalNZWINDNonCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalWINDClmAmtTemp);    
ClaimsProperty: => TotalNZWINDNonCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalWINDClmAmtTemp);    
ClaimsProperty: => TotalNZWINDNonCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator != 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalWINDClmAmtTemp);    
ClaimsProperty: => TotalNZWINDNonCatClmAmtWithin1Yr := IF(NumWINDNonCatClmWithin1Yr > 0 , MIN(TotalNZWINDNonCatClmAmtWithin1YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWINDNonCatClmAmtWithin2Yr := IF(NumWINDNonCatClmWithin2Yr > 0 , MIN(TotalNZWINDNonCatClmAmtWithin2YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWINDNonCatClmAmtWithin3Yr := IF(NumWINDNonCatClmWithin3Yr > 0 , MIN(TotalNZWINDNonCatClmAmtWithin3YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWINDNonCatClmAmtWithin4Yr := IF(NumWINDNonCatClmWithin4Yr > 0 , MIN(TotalNZWINDNonCatClmAmtWithin4YrTemp, 9999992), 9999999);
ClaimsProperty: => TotalNZWINDNonCatClmAmtWithin5Yr := IF(NumWINDNonCatClmWithin5Yr > 0 , MIN(TotalNZWINDNonCatClmAmtWithin5YrTemp, 9999992), 9999999);

ClaimsProperty: => AvgNZWINDNonCatClmAmtWithin1Yr := IF(NumNZWINDNonCatClmWithin1Yr > 0 , MIN(ROUND(TotalNZWINDNonCatClmAmtWithin1YrTemp/NumNZWINDNonCatClmWithin1Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWINDNonCatClmAmtWithin2Yr := IF(NumNZWINDNonCatClmWithin2Yr > 0 , MIN(ROUND(TotalNZWINDNonCatClmAmtWithin2YrTemp/NumNZWINDNonCatClmWithin2Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWINDNonCatClmAmtWithin3Yr := IF(NumNZWINDNonCatClmWithin3Yr > 0 , MIN(ROUND(TotalNZWINDNonCatClmAmtWithin3YrTemp/NumNZWINDNonCatClmWithin3Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWINDNonCatClmAmtWithin4Yr := IF(NumNZWINDNonCatClmWithin4Yr > 0 , MIN(ROUND(TotalNZWINDNonCatClmAmtWithin4YrTemp/NumNZWINDNonCatClmWithin4Yr), 9999992), 9999999);
ClaimsProperty: => AvgNZWINDNonCatClmAmtWithin5Yr := IF(NumNZWINDNonCatClmWithin5Yr > 0 , MIN(ROUND(TotalNZWINDNonCatClmAmtWithin5YrTemp/NumNZWINDNonCatClmWithin5Yr), 9999992), 9999999);




//CRAFT claims
// ClaimsPropertyClaim: CRAFT_CODE_LIST := ['CRAFT'];
// ClaimsPropertyClaim: => IsCRAFTClaim := EXISTS (Payments(cClaimCatType IN CRAFT_CODE_LIST));
// ClaimsPropertyClaim.Payments: => CFClaimAmount := IF(cClaimCatType = 'CRAFT', cClaimCatAmount, 0);
// ClaimsPropertyClaim: => TotalCFClmAmtTemp := SUM(Payments, CFClaimAmount);

// ClaimsPropertyClaim: => IsCRAFTNZClaim := EXISTS (IsCRAFTClaim = TRUE AND TotalCFClmAmtTemp > 0);


// ClaimsProperty: => NumCFCatClmWithin1Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
// ClaimsProperty: => NumCFCatClmWithin2Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
// ClaimsProperty: => NumCFCatClmWithin3Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
// ClaimsProperty: => NumCFCatClmWithin4Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
// ClaimsProperty: => NumCFCatClmWithin5Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND TotalClaimAmt > 0 AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));


// ClaimsProperty: => NumNZCFCatClmWithin1Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCFClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmt > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ));
// ClaimsProperty: => NumNZCFCatClmWithin2Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCFClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmt > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ));
// ClaimsProperty: => NumNZCFCatClmWithin3Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCFClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmt > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ));
// ClaimsProperty: => NumNZCFCatClmWithin4Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCFClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmt > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ));
// ClaimsProperty: => NumNZCFCatClmWithin5Yr := COUNT(ClaimsPropertyClaim(IsCRAFTClaim = TRUE AND TotalCFClmAmtTemp > 0 AND cAtFaultIndicator = 'Y' AND TotalClaimAmt > 0 AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ));


// ClaimsProperty: =>  ExistCFCatClmWithin1Yr := IF( NumCFCatClmWithin1Yr >= 1 , 1, 0);
// ClaimsProperty: =>  ExistCFCatClmWithin2Yr := IF( NumCFCatClmWithin2Yr >= 1 , 1, 0);
// ClaimsProperty: =>  ExistCFCatClmWithin3Yr := IF( NumCFCatClmWithin3Yr >= 1 , 1, 0);
// ClaimsProperty: =>  ExistCFCatClmWithin4Yr := IF( NumCFCatClmWithin4Yr >= 1 , 1, 0);
// ClaimsProperty: =>  ExistCFCatClmWithin5Yr := IF( NumCFCatClmWithin5Yr >= 1 , 1, 0);
// ClaimsProperty: =>  ExistNZCFCatClmWithin1Yr := IF( NumNZCFCatClmWithin1Yr >= 1 , 1, 0);
// ClaimsProperty: =>  ExistNZCFCatClmWithin2Yr := IF( NumNZCFCatClmWithin2Yr >= 1 , 1, 0);
// ClaimsProperty: =>  ExistNZCFCatClmWithin3Yr := IF( NumNZCFCatClmWithin3Yr >= 1 , 1, 0);
// ClaimsProperty: =>  ExistNZCFCatClmWithin4Yr := IF( NumNZCFCatClmWithin4Yr >= 1 , 1, 0);
// ClaimsProperty: =>  ExistNZCFCatClmWithin5Yr := IF( NumNZCFCatClmWithin5Yr >= 1 , 1, 0);

// ClaimsProperty: => TotalNZCFCatClmAmtWithin1YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 1 ), TotalCFClmAmtTemp);    
// ClaimsProperty: => TotalNZCFCatClmAmtWithin2YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 2 ), TotalCFClmAmtTemp);    
// ClaimsProperty: => TotalNZCFCatClmAmtWithin3YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 3 ), TotalCFClmAmtTemp);    
// ClaimsProperty: => TotalNZCFCatClmAmtWithin4YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 4 ), TotalCFClmAmtTemp);    
// ClaimsProperty: => TotalNZCFCatClmAmtWithin5YrTemp := SUM(ClaimsPropertyClaim(cAtFaultIndicator = 'Y' AND IsValidClaim = TRUE AND YEARSBETWEEN(AdjustedClaimDate, ClaimsProperty.DateOfOrder) < 5 ), TotalCFClmAmtTemp);    
// ClaimsProperty: => AvgNZCFCatClmAmtWithin1Yr := TotalNZCFCatClmAmtWithin1YrTemp / NumNZCFCatClmWithin1Yr;
// ClaimsProperty: => AvgNZCFCatClmAmtWithin2Yr := TotalNZCFCatClmAmtWithin2YrTemp / NumNZCFCatClmWithin2Yr;
// ClaimsProperty: => AvgNZCFCatClmAmtWithin3Yr := TotalNZCFCatClmAmtWithin3YrTemp / NumNZCFCatClmWithin3Yr;
// ClaimsProperty: => AvgNZCFCatClmAmtWithin4Yr := TotalNZCFCatClmAmtWithin4YrTemp / NumNZCFCatClmWithin4Yr;
// ClaimsProperty: => AvgNZCFCatClmAmtWithin5Yr := TotalNZCFCatClmAmtWithin5YrTemp / NumNZCFCatClmWithin5Yr;


// Non-FCRA: Claims Discovery
// Debugging QUERY's
QUERY: ClaimsDiscoveryPropertySearchInformation(SearchForID) <= ClaimsPropertySearchInformation(rClaimsProperty = SearchForID) USING [NonFCRA];
QUERY: ClaimsDiscoveryPropertyRiskClaims(SearchForID) <= ClaimsPropertyClaim(rClaimsProperty = SearchForID) USING [NonFCRA];

// Final SHELL
SHELL: ClaimsDiscoveryProperty <= ClaimsProperty{UID, ReportRequestIdRecordCode, Quoteback, ReportCode, ReportType, AccountNumber, AccountSuffix, SpecialBillID, DateOfOrder, DateOfReceipt, DateOfCompletion, ProcessingCompletionStatus, ReportUsage, ReferenceNumber, TimeOfReport, Attach1ProcessStatus, RecordVersion, ReportIdSupplementA} USING [NonFCRA];

// FCRA: CLUE
// Debugging QUERY's
QUERY: CLUEPropertySearchInformation(SearchForID) <= ClaimsPropertySearchInformation(rClaimsProperty = SearchForID) USING [FCRA];
QUERY: CLUEPropertyRiskClaims(SearchForID) <= ClaimsPropertyClaim(rClaimsProperty = SearchForID) USING [FCRA];

// Final SHELL
SHELL: CLUEProperty <= ClaimsProperty{UID, ReportRequestIdRecordCode, Quoteback, ReportCode, ReportType, AccountNumber, AccountSuffix, SpecialBillID, DateOfOrder, DateOfReceipt, DateOfCompletion, ProcessingCompletionStatus, ReportUsage, ReferenceNumber, TimeOfReport, Attach1ProcessStatus, RecordVersion, ReportIdSupplementA} USING [FCRA];
SHELL: CLUEPropertyStateFarm <= ClaimsProperty{UID, NumWeatherClmWithin1Yr,NumWeatherClmWithin2Yr,NumWeatherClmWithin3Yr,NumWeatherClmWithin4Yr,NumWeatherClmWithin5Yr,NumNZWeatherClmWithin1Yr,NumNZWeatherClmWithin2Yr,NumNZWeatherClmWithin3Yr,NumNZWeatherClmWithin4Yr,NumNZWeatherClmWithin5Yr,NumWeatherCatClmWithin1Yr,NumWeatherCatClmWithin2Yr,NumWeatherCatClmWithin3Yr,NumWeatherCatClmWithin4Yr,NumWeatherCatClmWithin5Yr,NumNZWeatherCatClmWithin1Yr,NumNZWeatherCatClmWithin4Yr,NumNZWeatherCatClmWithin5Yr,NumWeatherNonCatClmWithin1Yr,NumWeatherNonCatClmWithin2Yr,NumWeatherNonCatClmWithin3Yr,NumWeatherNonCatClmWithin4Yr,NumWeatherNonCatClmWithin5Yr,NumNZWeatherNonCatClmWithin1Yr,NumNZWeatherNonCatClmWithin2Yr,NumNZWeatherNonCatClmWithin4Yr,NumNZWeatherNonCatClmWithin5Yr,NumNonWeatherClmWithin1Yr,NumNonWeatherClmWithin2Yr,NumNonWeatherClmWithin3Yr,NumNonWeatherClmWithin4Yr,NumNonWeatherClmWithin5Yr,NumNZNonWeatherClmWithin2Yr,NumNZNonWeatherClmWithin4Yr,NumNonWeatherCatClmWithin1Yr,NumNonWeatherCatClmWithin2Yr,NumNonWeatherCatClmWithin3Yr,NumNonWeatherCatClmWithin4Yr,NumNonWeatherCatClmWithin5Yr,NumNZNonWeatherCatClmWithin1Yr,NumNZNonWeatherCatClmWithin2Yr,NumNZNonWeatherCatClmWithin3Yr,NumNZNonWeatherCatClmWithin4Yr,NumNZNonWeatherCatClmWithin5Yr,NumNZNonWeatherNonCatClmWithin1Yr,NumNZNonWeatherNonCatClmWithin2Yr,NumNZNonWeatherNonCatClmWithin3Yr,NumNZNonWeatherNonCatClmWithin4Yr,NumNZColBClmWithin1Yr,NumNZColBClmWithin2Yr,NumNZColBClmWithin3Yr,NumNZColBClmWithin4Yr,NumNZColBClmWithin5Yr,NumNZColBCatClmWithin1Yr,NumNZColBCatClmWithin2Yr,NumNZColBCatClmWithin3Yr,NumNZColBCatClmWithin4Yr,NumNZColBCatClmWithin5Yr,NumNZColBNonCatClmWithin1Yr,NumNZColBNonCatClmWithin3Yr,NumNZColBNonCatClmWithin1YrTN,NumNZColBNonCatClmWithin2YrTN,NumNZColBNonCatClmWithin3YrTN,NumNZColBNonCatClmWithin4YrTN,NumNZFireSmokeClmWithin1Yr,NumNZFireSmokeClmWithin2Yr,NumNZFireSmokeClmWithin3Yr,NumNZFireSmokeClmWithin4Yr,NumNZFireSmokeClmWithin5Yr,NumNZFireSmokeNonCatClmWithin1Yr,NumNZFireSmokeNonCatClmWithin2Yr,NumNZFireSmokeNonCatClmWithin3Yr,NumNZFireSmokeNonCatClmWithin4Yr,NumNZFireSmokeNonCatClmWithin5Yr,NumNZCrimeClmWithin1Yr,NumNZCrimeClmWithin2Yr,NumNZCrimeClmWithin3Yr,NumNZCrimeClmWithin4Yr,NumNZCrimeNonCatClmWithin1Yr,NumNZCrimeNonCatClmWithin2Yr,NumNZCrimeNonCatClmWithin3Yr,NumNZCrimeNonCatClmWithin4Yr,NumNZLiabilityClmWithin1Yr,NumNZLiabilityClmWithin2Yr,NumNZLiabilityClmWithin3Yr,NumNZLiabilityClmWithin4Yr,NumNZLiabilityClmWithin5Yr,NumNZLiabilityNonCatClmWithin1Yr,NumNZLiabilityNonCatClmWithin2Yr,NumNZLiabilityNonCatClmWithin3Yr,NumNZLiabilityNonCatClmWithin4Yr,NumNZLiabilityNonCatClmWithin5Yr,NumColAGE5000ClmWithin1Yr,NumColAGE5000ClmWithin2Yr,NumColAGE5000ClmWithin3Yr,NumColAGE5000ClmWithin4Yr,NumColAGE5000ClmWithin5Yr,NumColAGE5000CatClmWithin1Yr,NumColAGE5000CatClmWithin2Yr,NumColAGE5000CatClmWithin3Yr,NumColAGE5000CatClmWithin4Yr,NumColAGE5000CatClmWithin5Yr,NumColAGE5000NonCatClmWithin1Yr,NumColAGE5000NonCatClmWithin2Yr,NumColAGE5000NonCatClmWithin3Yr,NumColBGE5000ClmWithin1Yr,NumColBGE5000ClmWithin2Yr,NumColBGE5000ClmWithin3Yr,NumColBGE5000ClmWithin4Yr,NumColBGE5000ClmWithin5Yr,NumColBGE5000CatClmWithin1Yr,NumColBGE5000CatClmWithin2Yr,NumColBGE5000CatClmWithin3Yr,NumColBGE5000CatClmWithin4Yr,NumColBGE5000CatClmWithin5Yr,NumColBGE5000NonCatClmWithin1Yr,NumColBGE5000NonCatClmWithin2Yr,NumColBGE5000NonCatClmWithin3Yr,NumColBGE5000NonCatClmWithin4Yr,NumColAGE3000ClmWithin1Yr,NumColAGE3000ClmWithin2Yr,NumColAGE3000ClmWithin3Yr,NumColAGE3000ClmWithin4Yr,NumColAGE3000CatClmWithin1Yr,NumColAGE3000CatClmWithin2Yr,NumColAGE3000CatClmWithin3Yr,NumColAGE3000CatClmWithin4Yr,NumColAGE3000CatClmWithin5Yr,NumColAGE3000NonCatClmWithin1Yr,NumColAGE3000NonCatClmWithin4Yr,NumColBGE3000ClmWithin1Yr,NumColBGE3000ClmWithin2Yr,NumColBGE3000ClmWithin3Yr,NumColBGE3000ClmWithin4Yr,NumColBGE3000ClmWithin5Yr,NumColBGE3000CatClmWithin1Yr,NumColBGE3000CatClmWithin2Yr,NumColBGE3000CatClmWithin3Yr,NumColBGE3000CatClmWithin4Yr,NumColBGE3000CatClmWithin5Yr,NumColBGE3000NonCatClmWithin1Yr,NumColBGE3000NonCatClmWithin2Yr,NumColBGE3000NonCatClmWithin3Yr,NumColBGE3000NonCatClmWithin4Yr,NumNZColAClmWithin1Yr,NumNZColAClmWithin2Yr,NumNZColAClmWithin3Yr,NumNZColAClmWithin4Yr,NumNZColACatClmWithin1Yr,NumNZColACatClmWithin2Yr,NumNZColACatClmWithin3Yr,NumNZColACatClmWithin4Yr,NumNZColANonCatClmWithin1Yr,NumNZColANonCatClmWithin2Yr,NumNZColANonCatClmWithin3Yr} USING [FCRA];